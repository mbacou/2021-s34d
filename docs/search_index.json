[["index.html", "Supporting Seed Systems for Development Objectives", " Supporting Seed Systems for Development BACOU, Melanie Last updated on 2021-07-03 – CODES AND NOTES Objectives This notebook summarizes results from the 2020 S34D field surveys. The objective of this activity is to understand the operational efficiency and profitability of seed producer groups across different environments (multiple geographies, policy and regulatory systems). The farmers in the surveyed groups produce certified seeds as well as high-quality informal seeds that go through internal seed quality assurance mechanisms. We have chosen several countries that are at different stages of agricultural transformation and with varying degrees of seed systems maturity. Comparing and contrasting these seed producer clubs within and across their respective contexts can help guide development partners in designing interventions and inform policy making and seed system regulations. The analysis is split by country, with a cross-country evaluation once all survey results have been compiled. R code chunks are shown for reproducibility. library(lubridate) library(kableExtra) library(viridisLite) library(scales) library(ggplot2) library(terra) library(data.table) library(ttt) library(thematic) knitr::opts_chunk$set(fig.height=3, fig.width=5, dpi=220, fig.path=&quot;fig/&quot;, include=TRUE, error=FALSE, warning=FALSE, message=FALSE) options(ttt.theme=&quot;booktabs&quot;) # Default theme for plots pal &lt;- c(&quot;#4799b5&quot;, &quot;#94a545&quot;, &quot;#d37d28&quot;, &quot;#8B1E3F&quot;, &quot;#403b33&quot;) thematic_on(&quot;transparent&quot;, &quot;#2f2f29&quot;, c(&quot;#4799b5&quot;, &quot;#e6e7e8&quot;), font_spec(c(&quot;Roboto Condensed&quot;, &quot;Roboto&quot;)), qualitative = alpha(pal, .9)) theme_def &lt;- function( base_font = &quot;Roboto Condensed&quot;, base_size = 8, base_fill = &quot;transparent&quot;, ...) theme_minimal(base_size) + theme( panel.background = element_rect(fill=base_fill, color=NA), plot.background = element_rect(fill=base_fill, color=NA), legend.box.background = element_rect(fill=base_fill, color=NA), text = element_text(family=base_font, lineheight=.8), plot.subtitle = element_text(color=&quot;#4799b5&quot;, size=base_size*.9), strip.text = element_text(face=&quot;bold&quot;, hjust=0, size=base_size*.9), axis.text = element_text(size=base_size*.8), legend.key.width = unit(.8, &quot;line&quot;), legend.key.height = unit(.8, &quot;line&quot;) ) + theme(...) # Default theme for tables kable_def &lt;- function(...) kable_styling( bootstrap_options=c(&quot;condensed&quot;, &quot;responsive&quot;, &quot;striped&quot;, &quot;hover&quot;), font_size=14, ...) "],["01.html", "Vietnam Survey Codebook Data Enrichment Descriptive Statistics Clustering", " Vietnam Field work in Vietnam consisted of a qualitative assessment with focus group discussions and quantitative surveys. We first look at the consolidated survey results. Notes: 1 Int’l $ = 7,473.67 VND (Vietnamese Dong) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) Focus crop = rice Transportation costs are lumped into the cost of pesticides, fertilizers and harvesting. Labor costs are per hectare Inspection and certification fees are per farm (total fees for a single season). Only farmers who sell to seed centers or seed companies do incur these marketing costs. Survey Codebook xrate = 7473.67 # Load respondent data hh &lt;- fread(&quot;../data/vnm/hh.csv&quot;) # Load group data group &lt;- fread(&quot;../data/vnm/group.csv&quot;) # Load final codebook lbl &lt;- fread(&quot;../data/vnm/codebook.csv&quot;) There are 21 variables and 60 observations in this set. A detailed codebook is shown below. kable(align=&quot;llccc&quot;, caption=&quot;Survey Codebook&quot;, lbl) %&gt;% kable_def() Tab. 1: Survey Codebook code label type unit constructed hhid Code character uid FALSE age Age numeric years FALSE gender Sex character class FALSE group Group character class FALSE adm1_nm Province character class FALSE member_years How long have you been a member of this group? numeric years FALSE seed_ha_lcu Cost seed per ha (VND) numeric lcu/ha FALSE fert_ha_lcu Cost of fertilizer per ha (VND) numeric lcu/ha FALSE pest_ha_lcu Cost of pesticide per ha (VND) numeric lcu/ha FALSE tran_ha_lcu Cost of transport per ha (VND) logical lcu/ha FALSE labor_ha_lcu Labor cost (VND) numeric lcu/ha FALSE cert_lcu Inspection / certification Fees (VND) numeric lcu/farm/season FALSE labl_kg_lcu Labelling costs per kg (VND) numeric lcu/kg FALSE pckg_kg_lcu Packaging costs per kg (VND) numeric lcu/kg FALSE mark_kg_lcu Other marketing costs? (VND) numeric lcu/kg FALSE yield_ha_kg Estimated Yield (kg/ha) numeric kg/ha FALSE sales_kg_lcu Selling price of seed per kg (VND) numeric lcu/kg FALSE sales_ha_kg How many kg were sold in the season? numeric kg/ha FALSE margin_exp_ha_sh What was your expected gross margin? numeric lcu/ha FALSE costs_ha_lcu Total production cost numeric lcu/ha FALSE sales_ha_lcu Gross sales numeric lcu/ha FALSE margin_ha_lcu Gross margin numeric lcu/ha TRUE tfp Total factor productivity numeric kg/lcu TRUE ssd Farmer participates in formal seed system distribution logical true/false TRUE group_year Year the group was established integer year TRUE group_size Members in the group integer members TRUE soil_type Primary soil type character class TRUE seasons Number of seasons per year integer seasons/year TRUE irrigated Level of irrigation character class TRUE market_access Market access character class TRUE ttrade Presence of transboundary trade logical true/false TRUE costs_ha_lcu_imp Total costs (imputed) numeric lcu/ha TRUE sales_ha_sh Gross sales as share of tpc numeric share TRUE sales_ha_ppp Gross sales in PPP equivalent numeric ppp/ha TRUE margin_ha_sh Margin as share of tpc numeric share TRUE margin_ha_ppp Margin in PPP equivalent numeric ppp/ha TRUE Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. Note that we create a categorical variable ssd to indicate whether a farmer currently engages in formal seed system distribution. setorder(hh, adm1_nm, group, gender) hh[, `:=`( hhid = paste(&quot;VNM&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;VNM&quot;, adm1_nm = factor(adm1_nm), group = factor(group, levels=hh[, unique(group)]), gender = factor(gender, labels=c(Nam=&quot;Male&quot;, Nữ=&quot;Female&quot;)), ssd = factor(cert_lcu &gt; 0, labels=c(&quot;Informal&quot;, &quot;Formal&quot;)) )] Data Enrichment Below we append some of the information that was recorded at the group level. kbl(group, align=&quot;lccccccc&quot;) %&gt;% kable_def() Group Established Members Soil Seasons Irrigation Market access Transboundary trade Ta Ben 2001 30 loamy 2.0 good Vicinity to local market, good road to infrastructure No Trung Hiep 2003 8 sandy-silty 2.5 good Vicinity to local market, good road to infrastructure No Vinh Trach 2004 15 clay 3.0 good Vicinity to local market, good road to infrastructure Yes Binh My 2004 8 clay 3.0 good Vicinity to local market, good road to infrastructure Yes Vinh Qui 2002 40 clay 3.0 good Vicinity to local market, good road to infrastructure Yes # Merge hh[group, on=.(group=Group), `:=`( group_year = `Established`, group_size = `Members`, soil_type = `Soil`, seasons = `Seasons`, irrigated = `Irrigation`, market_access = `Market access`, ttrade = `Transboundary trade` )] Spatial Covariates Using community GPS coordinates we also suggest to enrich this dataset with additional biophysical and geospatial variables, e.g.: Agroecological zone Travel time to nearest market Distance to nearest seed center / company Size of nearest seed center / company Population density Last season total rainfall Last season heat stress days (if any) [pending GPS coordinates] Constructed Variables We check farmer-reported total costs costs_ha_lcu against the sum of individual cost line items. hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, costs_ha_lcu_imp := # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + # Per kg costs yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu + mark_kg_lcu)] hh[, summary(costs_ha_lcu_imp - costs_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0 0 0 0 0 0 There is no discrepancy between the 2 quantities, so we can assume that total costs are constructed per the formula above. No error was found. We also check that farmer-reported sales and profit margins are consistent. hh[, summary(sales_ha_lcu - (sales_kg_lcu * sales_ha_kg))] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0 0 0 0 0 0 Further we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as output per unit of input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( margin_ha_lcu = sales_ha_lcu - costs_ha_lcu )][, `:=`( sales_ha_sh = sales_ha_lcu / costs_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_ha_lcu, costs_ha_ppp = costs_ha_lcu / xrate, sales_ha_ppp = sales_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / costs_ha_ppp )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Transport = tran_ha_lcu, Labor = labor_ha_lcu, Certification = cert_lcu, Labeling = yield_ha_kg * labl_kg_lcu, Packaging = yield_ha_kg * pckg_kg_lcu, Marketing = yield_ha_kg * mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;category&quot;) hh_prod_cost[hh, on=.(hhid), `:=`( # Add categories group = i.group, gender = i.gender, ssd = i.ssd )][, `:=`( # Add shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid)] Note that in the current survey we are missing farm sizes (or planted acreage), so we can not directly study the effect of farm size on the per-unit costs of production and yields, or look at potential scale effects on a farmer’s efficiency and profitability. We can however study whether larger groups might have positive effects. Descriptive Statistics Respondent Characteristics First a breakdown by group. library(ggalluvial) ggplot( hh[, .N, by=.(adm1_nm, group, ssd, gender)], aes(axis1=adm1_nm, axis2=gender, axis3=ssd, y=N)) + geom_alluvium(aes(fill=group), width=1/4) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Province&quot;, &quot;Gender&quot;, &quot;Seed Distribution&quot;)) + labs(y=NULL, fill=&quot;Seed Group&quot;, title = &quot;Survey Respondents (Vietnam)&quot;, subtitle = &quot;Stratified by demographics and group membership (N = 60)&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency tables between each pair of categorical variables (seed group, gender, and a farmer’s use of formal seed system distribution). library(sjPlot) sjtab(hh[, .(group, gender)], fun=&quot;xtab&quot;, var.labels=c(&quot;Group&quot;, &quot;Gender&quot;), show.row.prc=T, show.col.prc=T, show.summary=T, show.exp=T, show.legend=T) Group Gender Total Male Female Binh My 76100 %14.6 % 010 %0 % 77100 %11.7 % Vinh Qui 108100 %20.8 % 020 %0 % 1010100 %16.7 % Vinh Trach 171494.4 %35.4 % 145.6 %8.3 % 1818100 %30 % Ta Ben 101076.9 %20.8 % 3323.1 %25 % 1313100 %21.7 % Trung Hiep 41033.3 %8.3 % 8266.7 %66.7 % 1212100 %20 % Total 484880 %100 % 121220 %100 % 6060100 %100 % χ2=23.007 · df=4 · Cramer’s V=0.619 · Fisher’s p=0.001 observed values expected values % within Group % within Gender sjtab(hh[, .(gender, ssd)], fun=&quot;xtab&quot;, var.labels=c(&quot;Gender&quot;, &quot;Seed System&quot;), show.row.prc=T, show.col.prc=T, show.summary=T, show.exp=T, show.legend=T) Gender Seed System Total Informal Formal Male 454593.8 %80.4 % 336.2 %75 % 4848100 %80 % Female 111191.7 %19.6 % 118.3 %25 % 1212100 %20 % Total 565693.3 %100 % 446.7 %100 % 6060100 %100 % χ2=0.000 · df=1 · φ=0.033 · Fisher’s p=1.000 observed values expected values % within Gender % within Seed System In the 1st table Chi-square test and p-value &lt; 0 shows that gender and group membership are not independent. In the 2nd table with a Chi-square at zero and a small Cramér’s V (0.033) the variables can be assumed dependent, but that relationship is not significant, as shown also on the mosaic plot below. mosaicplot(~gender+ssd, hh, shade=T, main = NA, xlab=&quot;Gender&quot;, ylab=&quot;Seed System&quot;) mosaicplot(~adm1_nm+ssd, hh, shade=T, main = NA, xlab=&quot;Province&quot;, ylab=&quot;Seed System&quot;) NB. blue means there are more observations in the cell than would be expected under the null model (independence). Red means there are fewer observations than would have been expected. Seed Production Costs We first look at the general breakdown and distribution of input costs across farmer groups and gender. ggplot(hh, aes(gender, costs_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha)&quot;, subtitle=&quot;Stratified by Male vs. Female&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, costs_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha)&quot;, subtitle=&quot;Stratified by Farmer Group&quot;) + theme_def(legend.position=&quot;none&quot;) Breakdown across categories of input. tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(gender, ssd, category)] ggplot(tbl, aes(gender, share, fill=category)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~ssd) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Gender&quot;, subtitle=&quot;&quot;) + theme_def() tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(group, ssd, category)] ggplot(tbl, aes(group, share, fill=category)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~ssd, scales=&quot;free_x&quot;) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Group&quot;, subtitle=&quot;&quot;) + theme_def() Are there significant differences across groups? ggplot(hh_prod_cost[!category %in% c(&quot;Transport&quot;, &quot;Marketing&quot;)], aes(category, ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare)&quot;, subtitle=&quot;Stratified by Male vs. Female&quot;) + theme_def(legend.position=&quot;top&quot;) ggplot(hh_prod_cost[!category %in% c(&quot;Transport&quot;, &quot;Marketing&quot;)], aes(category, ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare)&quot;, subtitle=&quot;Stratified by Farmer Group&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures across groups? rndr.meansd &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(yield_ha_kg ~ group | gender, data=hh, render=rndr.meansd, caption=&quot;Rice Seed Yield (kg / ha)&quot;, topclass=&quot;table-condensed table-striped table-hover&quot;) Rice Seed Yield (kg / ha) group Statistic Male Female Binh My Mean 8,272 NA SD 1,325 NA Vinh Qui Mean 9,850 NA SD 1,717 NA Vinh Trach Mean 8,709 9,000 SD 1,883 NA Ta Ben Mean 9,770 7,467 SD 1,113 404 Trung Hiep Mean 7,182 7,938 SD 623 904 ggplot(hh, aes(gender, yield_ha_kg, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Rice Seed Yield (kg / ha)&quot;, subtitle=&quot;Stratified by Male vs. Female&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, sales_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha)&quot;, subtitle=&quot;Stratified by Male vs. Female&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, yield_ha_kg, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Rice Seed Yield (Kg / ha)&quot;, subtitle=&quot;Stratified by Farmer Group&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, sales_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha)&quot;, subtitle=&quot;Stratified by Farmer Group&quot;) + theme_def(legend.position=&quot;none&quot;) Production frontiers across farmer groups and gender (units of output vs. cost units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. ggplot(hh, aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + coord_cartesian(ylim=c(4000,14000)) + labs(x=&quot;Costs (PPP$/ha)&quot;, y=&quot;Yield (kg/ha)&quot;, title=&quot;Production Frontiers (Crop Yield vs. Input Costs)&quot;, subtitle=&quot;Each point is a respondent&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~gender, scales=&quot;free_x&quot;) + coord_cartesian(ylim=c(4000,14000)) + labs(x=&quot;Costs (PPP$/ha)&quot;, y=&quot;Yield (kg/ha)&quot;, title=&quot;Production Frontiers (Crop Yield vs. Input Costs)&quot;, subtitle=&quot;Each point is a respondent&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[costs_ha_ppp&lt;4000], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=group, fill=group), size=.8) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~group) + coord_cartesian(ylim=c(4000,17000)) + labs(x=&quot;Costs (PPP$/ha)&quot;, y=&quot;Crop Yield (kg/ha)&quot;, title=&quot;Production Frontiers (Yield vs. Input Costs)&quot;, subtitle=&quot;Each point is a respondent&quot;) + theme_def(legend.position=&quot;none&quot;) NB. Removed 1 outlier. Profitability rndr.meansd &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(margin_ha_ppp ~ group | gender, data=hh, render=rndr.meansd, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha)&quot;, topclass=&quot;table-condensed table-striped table-hover&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) group Statistic Male Female Binh My Mean 3,839 NA SD 1,374 NA Vinh Qui Mean 5,759 NA SD 1,932 NA Vinh Trach Mean 4,334 6,391 SD 1,949 NA Ta Ben Mean 6,627 5,003 SD 925 596 Trung Hiep Mean 7,084 8,235 SD 2,657 1,947 rndr.meansd &lt;- function(x) c(Mean=percent(mean(x, na.rm=T)), SD=percent(sd(x, na.rm=T))) ttt(margin_ha_sh ~ group | gender, data=hh, render=rndr.meansd, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs)&quot;, topclass=&quot;table-condensed table-striped table-hover&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) group Statistic Male Female Binh My Mean 142% NA SD 68% NA Vinh Qui Mean 196% NA SD 63% NA Vinh Trach Mean 154% 254% SD 72% NA Ta Ben Mean 240% 245% SD 48% 56% Trung Hiep Mean 304% 285% SD 136% 91% ggplot(hh, aes(x=1:nrow(hh), color=group)) + geom_linerange(aes(ymin=costs_ha_ppp, ymax=sales_ha_ppp), size=.6) + geom_point(aes(y=costs_ha_ppp), shape=20, size=1.4) + geom_point(aes(y=sales_ha_ppp), shape=17, size=1.4) + scale_y_continuous(labels=comma) + labs(x=NULL, y=NULL, color=&quot;&quot;, title=&quot;Profit Margin (PPP$ per Hectare)&quot;, subtitle=&quot;Each bar is a respondent&quot;) + theme_def(legend.position=&quot;top&quot;) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms as percentage of total costs per hectare. ggplot(hh, aes(gender, margin_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~ssd) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms&quot;, subtitle=&quot;Stratified by Gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, margin_ha_sh, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + facet_wrap(~ssd) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms&quot;, subtitle=&quot;Stratified by Gender (% of variable input costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms&quot;, subtitle=&quot;Stratified by Farmer Group (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_sh, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms&quot;, subtitle=&quot;Stratified by Farmer Group (% of variable input costs)&quot;) + theme_def(legend.position=&quot;none&quot;) Clustering [TBD] rm(tmp, x, y, i) save.image(&quot;../tmp/data_vnm.RData&quot;) "],["02.html", "Niger", " Niger [pending] "],["03.html", "Guatemala", " Guatemala [pending] "],["04.html", "Uganda", " Uganda [pending] "],["05.html", "Zambia", " Zambia [pending] "]]
