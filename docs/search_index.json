[["index.html", "Supporting Seed Systems for Development Objectives", " Supporting Seed Systems for Development BACOU, Melanie Last updated on 2021-07-12 – CODES AND NOTES Objectives This notebook summarizes results from the 2020 S34D field surveys. The objective of this activity is to understand the operational efficiency and profitability of seed producer groups across different environments (multiple geographies, policy and regulatory systems). The farmers in the surveyed groups produce certified seeds as well as high-quality informal seeds that go through internal seed quality assurance mechanisms. We have chosen several countries that are at different stages of agricultural transformation and with varying degrees of seed systems maturity. Comparing and contrasting these seed producer clubs within and across their respective contexts can help guide development partners in designing interventions and inform policy making and seed system regulations. The analysis is split by country, with a cross-country evaluation once all survey results have been compiled. R code chunks are shown for reproducibility. library(lubridate) library(kableExtra) library(viridisLite) library(scales) library(ggplot2) library(terra) library(data.table) library(ttt) library(thematic) library(showtext) library(ggalluvial) library(GGally) knitr::opts_chunk$set(fig.height=3, fig.width=5, dpi=220, fig.path=&quot;fig/&quot;, fig.showtext=TRUE, include=TRUE, error=FALSE, warning=FALSE, message=FALSE) # Helper - Default FtF colors for plots pal &lt;- c(&quot;#4799b5&quot;, &quot;#94a545&quot;, &quot;#d37d28&quot;, &quot;#8B1E3F&quot;, &quot;#403b33&quot;) thematic_on(&quot;transparent&quot;, &quot;#2f2f29&quot;, c(&quot;#4799b5&quot;, &quot;#e6e7e8&quot;), font_spec(c(&quot;Roboto Condensed&quot;, &quot;Roboto&quot;)), qualitative = alpha(pal, .9)) theme_def &lt;- function( base_size = 7, base_family = &quot;Roboto Condensed&quot;, base_fill = &quot;transparent&quot;, ...) theme_minimal(base_size, base_family) + theme( panel.background = element_rect(fill=base_fill, color=NA), plot.background = element_rect(fill=base_fill, color=NA), legend.box.background = element_rect(fill=base_fill, color=NA), text = element_text(lineheight=.8), plot.title = element_text(size=base_size+2), plot.subtitle = element_text(color=&quot;#4799b5&quot;, size=base_size+1), strip.text = element_text(face=&quot;bold&quot;, hjust=0, size=base_size+1), axis.text = element_text(size=base_size), axis.title = element_text(hjust=0), legend.key.width = unit(.8, &quot;line&quot;), legend.key.height = unit(.8, &quot;line&quot;) ) + theme(...) # Helper - Default theme for tables kbl &lt;- function(...) kableExtra::kbl(...) %&gt;% kable_styling( bootstrap_options=c(&quot;condensed&quot;, &quot;responsive&quot;, &quot;striped&quot;, &quot;hover&quot;), font_size=14) # Helper - Print contingency table with chisq tests options(ttt.theme=&quot;booktabs&quot;) ttt_ftable &lt;- function(data, vars, ...) { stopifnot(length(vars)==3) dt = data[, .SD, .SDcols=vars] N = nrow(dt) dt = table(dt) test = mantelhaen.test(dt) dt = dt %&gt;% prop.table() %&gt;% addmargins(...) %&gt;% ftable() names(attr(dt, &quot;row.vars&quot;)) = vars[1:2] dt = round(100*dt, digits=1) ttt(dt, caption=&quot;Contingency Table (% of respondents)&quot;, footnote=paste( &quot;N =&quot;, N, &quot;| Mantel-Haenszel chi-squared =&quot;, comma(test[[1]], acc=.01), &quot;| p-value = &quot;, comma(test[[3]], acc=.0001)) ) } "],["01.html", "Vietnam Survey Codebook Data Enrichment Descriptive Statistics Correlation Clustering", " Vietnam Field work in Vietnam consisted of a qualitative assessment with focus group discussions and quantitative surveys. We first look at the consolidated survey results. Notes: 1 Int’l $ = 7,473.67 VND (Vietnamese Dong) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) Focus crop = rice Transportation costs are lumped into the cost of pesticides, fertilizers and harvesting. Labor costs are per hectare Inspection and certification fees are per farm (total fees for a single season). Only farmers who sell to seed centers or seed companies do incur these marketing costs. Survey Codebook xrate &lt;- 7473.67 # Load respondent data hh &lt;- fread(&quot;../data/vnm/hh.csv&quot;) # Load group data group &lt;- fread(&quot;../data/vnm/group.csv&quot;) # Load final codebook lbl &lt;- fread(&quot;../data/codebook.csv&quot;) There are 21 variables and 60 observations in this set. A detailed codebook is shown below. kbl(lbl[label %in% names(hh)], align=&quot;llccc&quot;, caption=&quot;Survey Codebook&quot;) Tab. 1: Survey Codebook code label type unit constructed hhid Code character uid FALSE age Age numeric years FALSE gender Sex character class FALSE group Group character class FALSE adm1_nm Province character class FALSE member_years How long have you been a member of this group? numeric years FALSE seed_ha_lcu Cost seed per ha (LCU) numeric lcu/ha FALSE fert_ha_lcu Cost of fertilizer per ha (LCU) numeric lcu/ha FALSE pest_ha_lcu Cost of pesticide per ha (LCU) numeric lcu/ha FALSE tran_ha_lcu Cost of transport per ha (LCU) logical lcu/ha FALSE labor_ha_lcu Labor cost (LCU) numeric lcu/ha FALSE cert_lcu Inspection / certification Fees (LCU) numeric lcu/farm/season FALSE labl_kg_lcu Labelling costs per kg (LCU) numeric lcu/kg FALSE pckg_kg_lcu Packaging costs per kg (LCU) numeric lcu/kg FALSE mark_kg_lcu Other marketing costs? (LCU) numeric lcu/kg FALSE yield_ha_kg Estimated Yield (kg/ha) numeric kg/ha FALSE sales_kg_lcu Selling price of seed per kg (LCU) numeric lcu/kg FALSE sales_ha_kg How many kg were sold in the season? numeric kg/ha FALSE margin_exp_ha_sh What was your expected gross margin? numeric lcu/ha FALSE costs_ha_lcu Total production cost numeric lcu/ha FALSE sales_ha_lcu Gross sales numeric lcu/ha FALSE Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. Note that we create a categorical variable ssd to indicate whether a farmer currently engages in formal seed system distribution. setorder(hh, adm1_nm, group, gender) hh[, `:=`( hhid = paste(&quot;VNM&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;VNM&quot;, crop = &quot;rice&quot;, adm1_nm = factor(adm1_nm), group = factor(group, levels=hh[, unique(group)]), gender = factor(gender, labels=c(Nam=&quot;Male&quot;, Nữ=&quot;Female&quot;)), ssd = factor(cert_lcu &gt; 0, labels=c(&quot;Informal&quot;, &quot;Formal&quot;)) )] Data Enrichment Below we append some of the information that was recorded at the group level. kbl(group, align=&quot;lccccccc&quot;) Group Established Members Soil Seasons Irrigation Market access Transboundary trade Ta Ben 2001 30 loamy 2.0 good Vicinity to local market, good road to infrastructure No Trung Hiep 2003 8 sandy-silty 2.5 good Vicinity to local market, good road to infrastructure No Vinh Trach 2004 15 clay 3.0 good Vicinity to local market, good road to infrastructure Yes Binh My 2004 8 clay 3.0 good Vicinity to local market, good road to infrastructure Yes Vinh Qui 2002 40 clay 3.0 good Vicinity to local market, good road to infrastructure Yes # Merge hh[group, on=.(group=Group), `:=`( group_year = `Established`, group_size = `Members`, soil_type = `Soil`, seasons = `Seasons`, irrigated = `Irrigation`, market_access = `Market access`, ttrade = `Transboundary trade` )] Spatial Covariates Using community GPS coordinates we also suggest to enrich this dataset with additional biophysical and geospatial variables, e.g.: Agroecological zone Travel time to nearest market Distance to nearest seed center / company Size of nearest seed center / company Population density Last season total rainfall Last season heat stress days (if any) [pending GPS coordinates] Constructed Variables We check farmer-reported total costs costs_ha_lcu against the sum of individual cost line items. hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, costs_ha_lcu_imp := # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + # Per kg costs yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu + mark_kg_lcu)] hh[, summary(costs_ha_lcu_imp - costs_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0 0 0 0 0 0 There is no discrepancy between the 2 quantities, so we can assume that total costs are constructed per the formula above. No error was found. We also check that farmer-reported sales and profit margins are consistent. hh[, summary(sales_ha_lcu - (sales_kg_lcu * sales_ha_kg))] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0 0 0 0 0 0 Further we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as output per unit of input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( margin_ha_lcu = sales_ha_lcu - costs_ha_lcu )][, `:=`( sales_ha_sh = sales_ha_lcu / costs_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_ha_lcu, costs_ha_ppp = costs_ha_lcu / xrate, sales_ha_ppp = sales_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / costs_ha_ppp )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Transport = tran_ha_lcu, Labor = labor_ha_lcu, Certification = cert_lcu, Labeling = yield_ha_kg * labl_kg_lcu, Packaging = yield_ha_kg * pckg_kg_lcu, Marketing = yield_ha_kg * mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) hh_prod_cost[hh, on=.(hhid), `:=`( # Add types group = i.group, gender = i.gender, ssd = i.ssd )][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid)] Note that in the current survey we are missing farm sizes (or planted acreage), so we can not directly study the effect of farm size on the per-unit costs of production and yields, or look at potential scale effects on a farmer’s efficiency and profitability. We can however study whether larger groups might have positive effects. Descriptive Statistics Respondent Characteristics First a breakdown by group. ggplot( hh[, .N, by=.(adm1_nm, group, ssd, gender)], aes(axis1=adm1_nm, axis2=gender, axis3=ssd, y=N)) + geom_alluvium(aes(fill=group), width=1/4) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Province&quot;, &quot;Gender&quot;, &quot;Seed Distribution&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Survey Respondents (Vietnam)&quot;, subtitle = &quot;Stratified by club and demographics (N = 60)&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, and use of formal seed system distribution ssd). Rice in Vietnam is a male-dominated production, hence the absence of female respondents in a few clubs. ttt_ftable(hh, vars=c(&quot;group&quot;, &quot;gender&quot;, &quot;ssd&quot;)) Contingency Table (% of respondents) group gender Informal Formal Sum N = 60 | Mantel-Haenszel chi-squared = 21.93 | p-value = 0.0002 Binh My Male 10 1.7 11.7 Sum 10 1.7 11.7 Vinh Qui Male 16.7 0 16.7 Sum 16.7 0 16.7 Vinh Trach Male 25 3.3 28.3 Female 1.7 0 1.7 Sum 26.7 3.3 30 Ta Ben Male 16.7 0 16.7 Female 5 0 5 Sum 21.7 0 21.7 Trung Hiep Male 6.7 0 6.7 Female 11.7 1.7 13.3 Sum 18.3 1.7 20 Sum Male 75 5 80 Female 18.3 1.7 20 Sum 93.3 6.7 100 Mantel-Haenszel test shows weak association between the 3 variables. This is further shown in the 2x2 mosaic plots below (standardized residuals between [-2,2]). mosaicplot(~gender+ssd, hh, shade=T, main=NA, xlab=&quot;Gender&quot;, ylab=&quot;Seed System&quot;) mosaicplot(~adm1_nm+ssd, hh, shade=T, main=NA, xlab=&quot;Province&quot;, ylab=&quot;Seed System&quot;) NB. blue means there are more observations in the cell than would be expected under the null model (independence). Red means there are fewer observations than would have been expected. Seed Production Costs We then look at the general breakdown and distribution of input costs across seed clubs, gender, and input type. ggplot(hh, aes(gender, costs_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, costs_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Breakdown across categories of farm input. tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(gender, ssd, type)] ggplot(tbl, aes(gender, share, fill=type)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~ssd) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Vietnam&quot;, subtitle=&quot;Stratified by gender and seed system&quot;) + theme_def() tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(group, ssd, type)] ggplot(tbl, aes(group, share, fill=type)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~ssd, scales=&quot;free_x&quot;) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def() Are there significant differences across groups? ggplot(hh_prod_cost[!type %in% c(&quot;Transport&quot;, &quot;Marketing&quot;)], aes(type, ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggplot(hh_prod_cost[!type %in% c(&quot;Transport&quot;, &quot;Marketing&quot;)], aes(type, ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures across groups? fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(yield_ha_kg ~ group | gender, data=hh, render=fmt, caption=&quot;Rice Seed Yield (kg / ha) - Vietnam&quot;) Rice Seed Yield (kg / ha) - Vietnam group Statistic Male Female Binh My Mean 8,272 NA SD 1,325 NA Vinh Qui Mean 9,850 NA SD 1,717 NA Vinh Trach Mean 8,709 9,000 SD 1,883 NA Ta Ben Mean 9,770 7,467 SD 1,113 404 Trung Hiep Mean 7,182 7,938 SD 623 904 ggplot(hh, aes(gender, yield_ha_kg, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Rice Seed Yield (kg / ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, sales_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, yield_ha_kg, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Rice Seed Yield (Kg / ha) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, sales_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. NB. Farmer VNM013 in Winh Qui has total costs over PPP$ 4,000/ha. He was excluded from the approximation (in red below). outlier &lt;- &quot;VNM013&quot; ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + geom_point(data=hh[hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg), alpha=.7, color=2, shape=18) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Vietnam&quot;, subtitle=&quot;Each point is a respondent (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~gender, scales=&quot;free_x&quot;) + coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Vietnam&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=group, fill=group), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~group) + coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Vietnam&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) Profitability fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(margin_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Vietnam&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Vietnam group Statistic Male Female Binh My Mean 3,839 NA SD 1,374 NA Vinh Qui Mean 5,759 NA SD 1,932 NA Vinh Trach Mean 4,334 6,391 SD 1,949 NA Ta Ben Mean 6,627 5,003 SD 925 596 Trung Hiep Mean 7,084 8,235 SD 2,657 1,947 fmt &lt;- function(x) c(Mean=percent(mean(x, na.rm=T)), SD=percent(sd(x, na.rm=T))) ttt(margin_ha_sh ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Vietnam&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Vietnam group Statistic Male Female Binh My Mean 142% NA SD 68% NA Vinh Qui Mean 196% NA SD 63% NA Vinh Trach Mean 154% 254% SD 72% NA Ta Ben Mean 240% 245% SD 48% 56% Trung Hiep Mean 304% 285% SD 136% 91% ggplot(hh, aes(x=1:nrow(hh), color=group)) + geom_linerange(aes(ymin=costs_ha_ppp, ymax=sales_ha_ppp, linetype=gender), size=.6) + geom_point(aes(y=costs_ha_ppp), shape=20, size=1.4) + geom_point(aes(y=sales_ha_ppp), shape=17, size=1.4) + scale_y_continuous(labels=comma) + labs(x=NULL, y=NULL, color=&quot;&quot;, linetype=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def(legend.position=&quot;right&quot;) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms as percentage of total costs per hectare. ggplot(hh, aes(gender, margin_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Vietnam&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, margin_ha_sh, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Vietnam&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Vietnam&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_sh, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Vietnam&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) Correlation Significant associations. ggpairs( hh[, .(`seed club`=group, age, `costs`=costs_ha_ppp, `seed yield`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal, size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA), combo=wrap(&quot;box_no_facet&quot;, fill=pal, alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal, alpha=.8)), title=&quot;Correlogram stratified by seed club - Vietnam&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) ggpairs( hh[, .(gender, age, `costs`=costs_ha_ppp, `seed yield`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by gender - Vietnam&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) Clustering [TBD] rm(tmp, x, y, i, fmt) save.image(&quot;../tmp/data_vnm.RData&quot;) "],["02.html", "Niger Survey Codebook Descriptive Statistics", " Niger Notes: 1 Int’l $ = 257.60 XOF (CFA) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) All costs are reported per hectare. Inspection, certification and other marketing costs are assumed for the entire farm. Labeling and packaging are per kg. Some farmers grow multiple crops Survey Codebook xrate &lt;- 257.60 # Load respondent data hh &lt;- fread(&quot;../data/nre/hh.csv&quot;) # Load complete codebook lbl &lt;- fread(&quot;../data/codebook.csv&quot;) There are 23 variables and 80 observations in this set. A detailed codebook is shown below. kbl(lbl[label %in% names(hh)], align=&quot;llccc&quot;, caption=&quot;Survey Codebook&quot;) Tab. 2: Survey Codebook code label type unit constructed hhid Code character uid FALSE age Age numeric years FALSE gender Sex character class FALSE group Group character class FALSE adm1_nm Province character class FALSE crop Crop character class FALSE member_years How long have you been a member of this group? numeric years FALSE seed_ha_lcu Cost seed per ha (LCU) numeric lcu/ha FALSE fert_ha_lcu Cost of fertilizer per ha (LCU) numeric lcu/ha FALSE pest_ha_lcu Cost of pesticide per ha (LCU) numeric lcu/ha FALSE tran_ha_lcu Cost of transport per ha (LCU) logical lcu/ha FALSE labor_ha_lcu Labor cost (LCU) numeric lcu/ha FALSE cert_lcu Inspection / certification Fees (LCU) numeric lcu/farm/season FALSE labl_kg_lcu Labelling costs per kg (LCU) numeric lcu/kg FALSE pckg_kg_lcu Packaging costs per kg (LCU) numeric lcu/kg FALSE mark_kg_lcu Other marketing costs? (LCU) numeric lcu/kg FALSE yield_ha_kg Estimated Yield (kg/ha) numeric kg/ha FALSE sales_kg_lcu Selling price of seed per kg (LCU) numeric lcu/kg FALSE sales_grain_sowing_kg_lcu Selling price of grain per kg (LCU) at sowing numeric lcu/kg FALSE sales_grain_harvest_kg_lcu Selling price of grain per kg (LCU) at harvest numeric lcu/kg FALSE sales_ha_kg How many kg were sold in the season? numeric kg/ha FALSE margin_exp_ha_sh What was your expected gross margin? numeric lcu/ha FALSE Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. setorder(hh, adm1_nm, group, gender, crop) hh[, `:=`( hhid = paste(&quot;NRE&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;NRE&quot;, adm1_nm = factor(adm1_nm), group = factor(group, levels=hh[, unique(group)]), gender = factor(gender, labels=c(male=&quot;Male&quot;, female=&quot;Female&quot;)), age = factor(age, labels=c(`15-29`=&quot;&lt; 30&quot;, `30+`=&quot;≥ 30&quot;)), crop = factor(crop) )] Spatial Covariates Using community GPS coordinates we also suggest to enrich this dataset with additional biophysical and geospatial variables, e.g.: Agroecological zone Travel time to nearest market Distance to nearest seed center / company Size of nearest seed center / company Population density Last season total rainfall Last season heat stress days (if any) [pending GPS coordinates] Constructed Variables We construct total costs per ha costs_ha_lcu as the sum of individual cost line items. hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, costs_ha_lcu := # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu)] hh[, summary(costs_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 21100 90719 172200 242594 299875 896000 We also construct total sales per ha sales_ha_lcu. hh[, sales_ha_lcu := sales_kg_lcu * sales_ha_kg] Further we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as output per unit of input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( margin_ha_lcu = sales_ha_lcu - costs_ha_lcu )][, `:=`( sales_ha_sh = sales_ha_lcu / costs_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_ha_lcu, costs_ha_ppp = costs_ha_lcu / xrate, sales_ha_ppp = sales_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / costs_ha_ppp )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table per ha hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Transport = tran_ha_lcu, Labor = labor_ha_lcu, Certification = cert_lcu, Labeling = yield_ha_kg * labl_kg_lcu, Packaging = yield_ha_kg * pckg_kg_lcu, Marketing = mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) hh_prod_cost[hh, on=.(hhid), `:=`( # Add categorical vars group = i.group, gender = i.gender, age = i.age, crop = i.crop )][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid)] Descriptive Statistics Respondent Characteristics First a breakdown by group. ggplot( hh[, .N, by=.(adm1_nm, group, age, gender, crop)], aes(axis1=crop, axis2=gender, axis3=age, y=N)) + geom_alluvium(aes(fill=group), width=1/4) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Province&quot;, &quot;Crop&quot;, &quot;Gender&quot;, &quot;Age&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Survey Respondents (Niger)&quot;, subtitle = &quot;Stratified by club and demographics (N = 39)&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, and age age). ttt_ftable(hh, vars=c(&quot;group&quot;, &quot;gender&quot;, &quot;age&quot;)) Contingency Table (% of respondents) group gender ≥ 30 Sum N = 80 | Mantel-Haenszel chi-squared = 2.81 | p-value = 0.4219 Boukassa_Noma Male 1.2 3.8 5 Female 0 7.5 7.5 Sum 1.2 11.2 12.5 Cigaban_Matta Male 0 2.5 2.5 Female 0 10 10 Sum 0 12.5 12.5 Yada_Iri Male 0 6.2 6.2 Female 0 18.8 18.8 Sum 0 25 25 HIMMA Male 8.8 17.5 26.2 Female 1.2 22.5 23.8 Sum 10 40 50 Sum Male 10 30 40 Female 1.2 58.8 60 Sum 11.2 88.8 100 Mantel-Haenszel test shows weak association between the 3 variables. This is further shown in the 2x2 mosaic plots below (standardized residuals between [-2,2]). mosaicplot(~gender+age, hh, shade=T, main=NA, xlab=&quot;Gender&quot;, ylab=&quot;Age&quot;) mosaicplot(~group+age, hh, shade=T, main=NA, xlab=&quot;Province&quot;, ylab=&quot;Age&quot;) NB. blue means there are more observations in the cell than would be expected under the null model (independence). Red means there are fewer observations than would have been expected. Seed Production Costs We then look at the general breakdown and distribution of input costs across seed clubs, crop, gender, and input type. Note that HIMA group grows both cowpea and millet. ggplot(hh, aes(gender, costs_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, costs_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Breakdown across categories of farm input. tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(crop, gender, type)] ggplot(tbl, aes(gender, share, fill=type)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Niger&quot;, subtitle=&quot;Stratified by gender and crop types&quot;) + theme_def() tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(group, crop, type)] ggplot(tbl, aes(group, share, fill=type)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Niger&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def() Are there significant differences across groups? ggplot(hh_prod_cost, aes(type, ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Niger&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggplot(hh_prod_cost, aes(type, ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Niger&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures across groups? fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(yield_ha_kg ~ group | gender, data=hh, render=fmt, caption=&quot;Seed Yield (kg / ha) - Niger&quot;) Seed Yield (kg / ha) - Niger group Statistic Male Female Boukassa_Noma Mean 838 850 SD 565 459 Cigaban_Matta Mean 340 688 SD 198 236 Yada_Iri Mean 620 562 SD 179 279 HIMMA Mean 665 771 SD 185 231 fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(yield_ha_kg ~ group | age, data=hh, render=fmt, caption=&quot;Seed Yield (kg / ha) - Niger&quot;) Seed Yield (kg / ha) - Niger group Statistic ≥ 30 Boukassa_Noma Mean 150 922 SD NA 429 Cigaban_Matta Mean NA 618 SD NA 263 Yada_Iri Mean NA 576 SD NA 254 HIMMA Mean 689 722 SD 158 225 ggplot(hh, aes(gender, yield_ha_kg, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Seed Yield (kg / ha) - Niger&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, sales_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, yield_ha_kg, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Seed Yield (Kg / ha) - Niger&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, sales_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. outlier &lt;- &quot;&quot; ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + geom_point(data=hh[hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg), alpha=.7, color=2, shape=18) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Niger&quot;, subtitle=&quot;Each point is a respondent (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Niger&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;right&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=group, fill=group), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Niger&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;right&quot;) Profitability By gender: fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(margin_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Niger&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Niger group Statistic Male Female Boukassa_Noma Mean -619 33 SD 277 919 Cigaban_Matta Mean 125 639 SD 113 572 Yada_Iri Mean 280 68 SD 668 1,342 HIMMA Mean 91 509 SD 1,362 1,279 fmt &lt;- function(x) c(Mean=percent(mean(x, na.rm=T)), SD=percent(sd(x, na.rm=T))) ttt(margin_ha_sh ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Niger&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Niger group Statistic Male Female Boukassa_Noma Mean -66% -27% SD 38% 69% Cigaban_Matta Mean 54% 219% SD 34% 156% Yada_Iri Mean 70% 68% SD 99% 203% HIMMA Mean 202% 77% SD 319% 147% By age group: fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(margin_ha_ppp ~ group | age, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Niger&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Niger group Statistic ≥ 30 Boukassa_Noma Mean -328 -217 SD NA 827 Cigaban_Matta Mean NA 536 SD NA 550 Yada_Iri Mean NA 121 SD NA 1,196 HIMMA Mean -820 567 SD 1,493 1,141 fmt &lt;- function(x) c(Mean=percent(mean(x, na.rm=T)), SD=percent(sd(x, na.rm=T))) ttt(margin_ha_sh ~ group | age, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Niger&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Niger group Statistic ≥ 30 Boukassa_Noma Mean -99% -36% SD NA 59% Cigaban_Matta Mean NA 186% SD NA 154% Yada_Iri Mean NA 69% SD NA 180% HIMMA Mean 87% 157% SD 372% 226% ggplot(hh, aes(x=1:nrow(hh), color=group)) + geom_linerange(aes(ymin=costs_ha_ppp, ymax=sales_ha_ppp, linetype=gender), size=.6) + geom_point(aes(y=costs_ha_ppp), shape=20, size=1.4) + geom_point(aes(y=sales_ha_ppp), shape=17, size=1.4) + scale_y_continuous(labels=comma) + labs(x=NULL, y=NULL, color=&quot;&quot;, linetype=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Niger&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def(legend.position=&quot;right&quot;) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms as percentage of total costs per hectare. ggplot(hh, aes(gender, margin_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Niger&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, margin_ha_sh, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Niger&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_sh, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Niger&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) rm(tmp, x, y, i, fmt) save.image(&quot;../tmp/data_nre.RData&quot;) "],["03.html", "Guatemala Survey Codebook Descriptive Statistics", " Guatemala Notes: 1 Int’l $ = 4.01 GTQ (Quetzal) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) All costs are reported per hectare, except for labeling and packaging costs (per bag of 3 pounds or 1.36 kg). Other marketing costs are assumed also per hectare Inspection and certification fees are per farm (total fees for a single season) Some farmers grow multiple crops Survey Codebook xrate &lt;- 4.01 # Load respondent data hh &lt;- fread(&quot;../data/gtm/hh.csv&quot;) # Load complete codebook lbl &lt;- fread(&quot;../data/codebook.csv&quot;) There are 21 variables and 39 observations in this set. A detailed codebook is shown below. kbl(lbl[label %in% names(hh)], align=&quot;llccc&quot;, caption=&quot;Survey Codebook&quot;) Tab. 3: Survey Codebook code label type unit constructed hhid Code character uid FALSE age Age numeric years FALSE gender Sex character class FALSE group Group character class FALSE adm1_nm Province character class FALSE crop Crop character class FALSE member_years How long have you been a member of this group? numeric years FALSE seed_ha_lcu Cost seed per ha (LCU) numeric lcu/ha FALSE fert_ha_lcu Cost of fertilizer per ha (LCU) numeric lcu/ha FALSE pest_ha_lcu Cost of pesticide per ha (LCU) numeric lcu/ha FALSE tran_ha_lcu Cost of transport per ha (LCU) logical lcu/ha FALSE labor_ha_lcu Labor cost (LCU) numeric lcu/ha FALSE cert_lcu Inspection / certification Fees (LCU) numeric lcu/farm/season FALSE labl_kg_lcu Labelling costs per kg (LCU) numeric lcu/kg FALSE pckg_kg_lcu Packaging costs per kg (LCU) numeric lcu/kg FALSE mark_kg_lcu Other marketing costs? (LCU) numeric lcu/kg FALSE yield_ha_kg Estimated Yield (kg/ha) numeric kg/ha FALSE sales_kg_lcu Selling price of seed per kg (LCU) numeric lcu/kg FALSE sales_ha_kg How many kg were sold in the season? numeric kg/ha FALSE margin_exp_ha_sh What was your expected gross margin? numeric lcu/ha FALSE Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. setorder(hh, adm1_nm, group, gender, crop) hh[, `:=`( hhid = paste(&quot;GTM&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;GTM&quot;, adm1_nm = factor(adm1_nm), group = factor(group, levels=hh[, unique(group)]), gender = factor(gender, labels=c(Male=&quot;Male&quot;, Female=&quot;Female&quot;)), age = factor(age, labels=c(`15-29`=&quot;&lt; 30&quot;, `30`=&quot;≥ 30&quot;)) )] Spatial Covariates Using community GPS coordinates we also suggest to enrich this dataset with additional biophysical and geospatial variables, e.g.: Agroecological zone Travel time to nearest market Distance to nearest seed center / company Size of nearest seed center / company Population density Last season total rainfall Last season heat stress days (if any) [pending GPS coordinates] Constructed Variables We construct total costs per ha costs_ha_lcu as the sum of individual cost line items. hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, costs_ha_lcu := # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs yield_ha_kg * (1/1.36) * (labl_kg_lcu + pckg_kg_lcu)] hh[, summary(costs_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 1.308e+05 1.416e+05 6.161e+07 4.164e+08 4.255e+08 3.940e+09 We also construct total sales per ha sales_ha_lcu. hh[, sales_ha_lcu := sales_kg_lcu * sales_ha_kg] Further we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as output per unit of input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( margin_ha_lcu = sales_ha_lcu - costs_ha_lcu )][, `:=`( sales_ha_sh = sales_ha_lcu / costs_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_ha_lcu, costs_ha_ppp = costs_ha_lcu / xrate, sales_ha_ppp = sales_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / costs_ha_ppp )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Transport = tran_ha_lcu, Labor = labor_ha_lcu, Certification = cert_lcu, Labeling = yield_ha_kg * (1/1.36) * labl_kg_lcu, Packaging = yield_ha_kg * (1/1.36) * pckg_kg_lcu, Marketing = mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) hh_prod_cost[hh, on=.(hhid), `:=`( # Add categorical vars group = i.group, gender = i.gender, age = i.age, crop = i.crop )][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid)] Descriptive Statistics Respondent Characteristics First a breakdown by group. ggplot( hh[, .N, by=.(adm1_nm, group, age, gender, crop)], aes(axis1=crop, axis2=gender, axis3=age, y=N)) + geom_alluvium(aes(fill=group), width=1/4) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Province&quot;, &quot;Crop&quot;, &quot;Gender&quot;, &quot;Age&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Survey Respondents (Guatemala)&quot;, subtitle = &quot;Stratified by club and demographics (N = 39)&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, and age age). ttt_ftable(hh, vars=c(&quot;group&quot;, &quot;gender&quot;, &quot;age&quot;)) Contingency Table (% of respondents) group gender ≥ 30 Sum N = 39 | Mantel-Haenszel chi-squared = 5.02 | p-value = 0.1705 ACORDI Male 2.6 5.1 7.7 Female 5.1 12.8 17.9 Sum 7.7 17.9 25.6 PAQUIX Female 0 25.6 25.6 Sum 0 25.6 25.6 SAN BARTOLO Male 0 5.1 5.1 Female 0 20.5 20.5 Sum 0 25.6 25.6 ADAT, AXOLA, ADIPY Female 2.6 20.5 23.1 Sum 2.6 20.5 23.1 Sum Male 2.6 10.3 12.8 Female 7.7 79.5 87.2 Sum 10.3 89.7 100 Mantel-Haenszel test shows weak association between the 3 variables. This is further shown in the 2x2 mosaic plots below (standardized residuals between [-2,2]). mosaicplot(~gender+age, hh, shade=T, main=NA, xlab=&quot;Gender&quot;, ylab=&quot;Age&quot;) mosaicplot(~group+age, hh, shade=T, main=NA, xlab=&quot;Province&quot;, ylab=&quot;Age&quot;) NB. blue means there are more observations in the cell than would be expected under the null model (independence). Red means there are fewer observations than would have been expected. Seed Production Costs We then look at the general breakdown and distribution of input costs across seed clubs, crop, gender, and input type. Note that Acordi and Paquix grow potato, while San Bartolo and Adapt grow bean. ggplot(hh, aes(gender, costs_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, costs_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Breakdown across categories of farm input. tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(crop, gender, type)] ggplot(tbl, aes(gender, share, fill=type)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Guatemala&quot;, subtitle=&quot;Stratified by gender and crop types&quot;) + theme_def() tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(group, crop, type)] ggplot(tbl, aes(group, share, fill=type)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Guatemala&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def() Are there significant differences across groups? ggplot(hh_prod_cost, aes(type, ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Guatemala&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggplot(hh_prod_cost, aes(type, ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Guatemala&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures across groups? fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(yield_ha_kg ~ group | gender, data=hh, render=fmt, caption=&quot;Seed Yield (kg / ha) - Guatemala&quot;) Seed Yield (kg / ha) - Guatemala group Statistic Male Female ACORDI Mean 84,235 186,521 SD 42,118 111,053 PAQUIX Mean NA 97,336 SD NA 40,148 SAN BARTOLO Mean 3,159 2,896 SD 1,489 1,090 ADAT, AXOLA, ADIPY Mean NA 2,106 SD NA 0 fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(yield_ha_kg ~ group | age, data=hh, render=fmt, caption=&quot;Seed Yield (kg / ha) - Guatemala&quot;) Seed Yield (kg / ha) - Guatemala group Statistic ≥ 30 ACORDI Mean 168,470 150,420 SD 151,857 93,728 PAQUIX Mean NA 97,336 SD NA 40,148 SAN BARTOLO Mean NA 2,948 SD NA 1,087 ADAT, AXOLA, ADIPY Mean 2,106 2,106 SD NA 0 ggplot(hh, aes(gender, yield_ha_kg, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Seed Yield (kg / ha) - Guatemala&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, sales_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, yield_ha_kg, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Seed Yield (Kg / ha) - Guatemala&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, sales_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. outlier &lt;- &quot;&quot; ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + geom_point(data=hh[hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg), alpha=.7, color=2, shape=18) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Guatemala&quot;, subtitle=&quot;Each point is a respondent (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Guatemala&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;right&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=group, fill=group), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Guatemala&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;right&quot;) Profitability By gender: fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(margin_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Guatemala&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Guatemala group Statistic Male Female ACORDI Mean -63,099,362 -348,585,991 SD 54,633,741 328,032,001 PAQUIX Mean NA -91,752,640 SD NA 70,238,786 SAN BARTOLO Mean 8,431 9,174 SD 14,046 15,052 ADAT, AXOLA, ADIPY Mean NA 31,703 SD NA 37,464 fmt &lt;- function(x) c(Mean=percent(mean(x, na.rm=T)), SD=percent(sd(x, na.rm=T))) ttt(margin_ha_sh ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Guatemala&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Guatemala group Statistic Male Female ACORDI Mean -88% -88% SD 0% 0% PAQUIX Mean NA -87% SD NA 1% SAN BARTOLO Mean 6% 8% SD 15% 12% ADAT, AXOLA, ADIPY Mean NA 53% SD NA 63% By age group: fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(margin_ha_ppp ~ group | age, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Guatemala&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Guatemala group Statistic ≥ 30 ACORDI Mean -333,466,264 -232,714,461 SD 463,648,364 248,830,127 PAQUIX Mean NA -91,752,640 SD NA 70,238,786 SAN BARTOLO Mean NA 9,025 SD NA 14,079 ADAT, AXOLA, ADIPY Mean -673 35,750 SD NA 37,889 fmt &lt;- function(x) c(Mean=percent(mean(x, na.rm=T)), SD=percent(sd(x, na.rm=T))) ttt(margin_ha_sh ~ group | age, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Guatemala&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Guatemala group Statistic ≥ 30 ACORDI Mean -88% -88% SD 0% 0% PAQUIX Mean NA -87% SD NA 1% SAN BARTOLO Mean NA 8% SD NA 12% ADAT, AXOLA, ADIPY Mean -2% 60% SD NA 63% ggplot(hh, aes(x=1:nrow(hh), color=group)) + geom_linerange(aes(ymin=costs_ha_ppp, ymax=sales_ha_ppp, linetype=gender), size=.6) + geom_point(aes(y=costs_ha_ppp), shape=20, size=1.4) + geom_point(aes(y=sales_ha_ppp), shape=17, size=1.4) + scale_y_continuous(labels=comma) + labs(x=NULL, y=NULL, color=&quot;&quot;, linetype=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def(legend.position=&quot;right&quot;) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms as percentage of total costs per hectare. ggplot(hh, aes(gender, margin_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Guatemala&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, margin_ha_sh, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Guatemala&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Guatemala&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_sh, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Guatemala&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) rm(tmp, x, y, i, fmt) save.image(&quot;../tmp/data_gtm.RData&quot;) "],["04.html", "Uganda", " Uganda [pending] "],["05.html", "Zambia Survey Codebook Descriptive Statistics", " Zambia Notes: 1 Int’l $ = 5.59 ZMW (Kwacha) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) All costs are reported per hectare. Inspection, certification and other marketing costs are assumed for the entire farm. Labeling and packaging are per kg. Some farmers grow multiple crops Survey Codebook xrate &lt;- 5.59 # Load respondent data hh &lt;- fread(&quot;../data/zmb/hh.csv&quot;) # Load complete codebook lbl &lt;- fread(&quot;../data/codebook.csv&quot;) There are 22 variables and 76 observations in this set. A detailed codebook is shown below. kbl(lbl[label %in% names(hh)], align=&quot;llccc&quot;, caption=&quot;Survey Codebook&quot;) Tab. 4: Survey Codebook code label type unit constructed hhid Code character uid FALSE age Age numeric years FALSE gender Sex character class FALSE group Group character class FALSE adm1_nm Province character class FALSE crop Crop character class FALSE member_years How long have you been a member of this group? numeric years FALSE seed_ha_lcu Cost seed per ha (LCU) numeric lcu/ha FALSE fert_ha_lcu Cost of fertilizer per ha (LCU) numeric lcu/ha FALSE pest_ha_lcu Cost of pesticide per ha (LCU) numeric lcu/ha FALSE tran_ha_lcu Cost of transport per ha (LCU) logical lcu/ha FALSE labor_ha_lcu Labor cost (LCU) numeric lcu/ha FALSE cert_lcu Inspection / certification Fees (LCU) numeric lcu/farm/season FALSE labl_kg_lcu Labelling costs per kg (LCU) numeric lcu/kg FALSE pckg_kg_lcu Packaging costs per kg (LCU) numeric lcu/kg FALSE mark_kg_lcu Other marketing costs? (LCU) numeric lcu/kg FALSE yield_ha_kg Estimated Yield (kg/ha) numeric kg/ha FALSE sales_kg_lcu Selling price of seed per kg (LCU) numeric lcu/kg FALSE sales_grain_sowing_kg_lcu Selling price of grain per kg (LCU) at sowing numeric lcu/kg FALSE sales_grain_harvest_kg_lcu Selling price of grain per kg (LCU) at harvest numeric lcu/kg FALSE sales_ha_kg How many kg were sold in the season? numeric kg/ha FALSE margin_exp_ha_sh What was your expected gross margin? numeric lcu/ha FALSE Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. setorder(hh, adm1_nm, group, gender, crop) hh[, `:=`( hhid = paste(&quot;ZMB&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;ZMB&quot;, adm1_nm = factor(adm1_nm), # Abbreviate seed club names group = factor(group, labels=c( `Mweete Seed Growers Association` = &quot;Mweete&quot;, `Tiwine Womens Seed growers Cooperative` = &quot;Tiwine&quot;, `Mumbwa Seed Growers Association` = &quot;Mumbwa&quot;, `Chiyota Seed Growers Association` = &quot;Chiyota&quot; )), gender = factor(gender, labels=c(male=&quot;Male&quot;, female=&quot;Female&quot;)), age = factor(age, labels=c(`25`=&quot;&lt; 30&quot;, `15-29`=&quot;&lt; 30&quot;, `30+`=&quot;≥ 30&quot;)), crop = factor(crop) )] Spatial Covariates Using community GPS coordinates we also suggest to enrich this dataset with additional biophysical and geospatial variables, e.g.: Agroecological zone Travel time to nearest market Distance to nearest seed center / company Size of nearest seed center / company Population density Last season total rainfall Last season heat stress days (if any) [pending GPS coordinates] Constructed Variables We construct total costs per ha costs_ha_lcu as the sum of individual cost line items. hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, costs_ha_lcu := # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu)] hh[, summary(costs_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 20.0 498.1 993.2 1524.9 1861.2 10240.0 We also construct total sales per ha sales_ha_lcu. hh[, sales_ha_lcu := sales_kg_lcu * sales_ha_kg] Further we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as output per unit of input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( margin_ha_lcu = sales_ha_lcu - costs_ha_lcu )][, `:=`( sales_ha_sh = sales_ha_lcu / costs_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_ha_lcu, costs_ha_ppp = costs_ha_lcu / xrate, sales_ha_ppp = sales_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / costs_ha_ppp )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table per ha hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Transport = tran_ha_lcu, Labor = labor_ha_lcu, Certification = cert_lcu, Labeling = yield_ha_kg * labl_kg_lcu, Packaging = yield_ha_kg * pckg_kg_lcu, Marketing = mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) hh_prod_cost[hh, on=.(hhid), `:=`( # Add categorical vars group = i.group, gender = i.gender, age = i.age, crop = i.crop )][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid)] Descriptive Statistics Respondent Characteristics First a breakdown by group. ggplot( hh[, .N, by=.(adm1_nm, group, age, gender, crop)], aes(axis1=crop, axis2=gender, axis3=age, y=N)) + geom_alluvium(aes(fill=group), width=1/4) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Province&quot;, &quot;Crop&quot;, &quot;Gender&quot;, &quot;Age&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Survey Respondents (Zambia)&quot;, subtitle = &quot;Stratified by club and demographics (N = 39)&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, and age age). ttt_ftable(hh, vars=c(&quot;group&quot;, &quot;gender&quot;, &quot;age&quot;)) Contingency Table (% of respondents) group gender ≥ 30 Sum N = 76 | Mantel-Haenszel chi-squared = 5.78 | p-value = 0.1231 Mweete Male 0 5.3 5.3 Female 3.9 10.5 14.5 Sum 3.9 15.8 19.7 Tiwine Male 7.9 9.2 17.1 Female 9.2 5.3 14.5 Sum 17.1 14.5 31.6 Mumbwa Male 0 5.3 5.3 Female 2.6 10.5 13.2 Sum 2.6 15.8 18.4 Chiyota Male 7.9 7.9 15.8 Female 6.6 7.9 14.5 Sum 14.5 15.8 30.3 Sum Male 15.8 27.6 43.4 Female 22.4 34.2 56.6 Sum 38.2 61.8 100 Mantel-Haenszel test shows weak association between the 3 variables. This is further shown in the 2x2 mosaic plots below (standardized residuals between [-2,2]). mosaicplot(~gender+age, hh, shade=T, main=NA, xlab=&quot;Gender&quot;, ylab=&quot;Age&quot;) mosaicplot(~group+age, hh, shade=T, main=NA, xlab=&quot;Province&quot;, ylab=&quot;Age&quot;) NB. blue means there are more observations in the cell than would be expected under the null model (independence). Red means there are fewer observations than would have been expected. Seed Production Costs We then look at the general breakdown and distribution of input costs across seed clubs, crop, gender, and input type. ggplot(hh, aes(gender, costs_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, costs_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Breakdown across categories of farm input. tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(crop, gender, type)] ggplot(tbl, aes(gender, share, fill=type)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Zambia&quot;, subtitle=&quot;Stratified by gender and crop types&quot;) + theme_def() tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(group, crop, type)] ggplot(tbl, aes(group, share, fill=type)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Zambia&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def() Are there significant differences across groups? ggplot(hh_prod_cost, aes(type, ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Zambia&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggplot(hh_prod_cost, aes(type, ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Zambia&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures across groups? fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(yield_ha_kg ~ group | gender, data=hh, render=fmt, caption=&quot;Seed Yield (kg / ha) - Zambia&quot;) Seed Yield (kg / ha) - Zambia group Statistic Male Female Mweete Mean 585 1,019 SD 692 879 Tiwine Mean 1,147 709 SD 896 822 Mumbwa Mean 330 610 SD 203 476 Chiyota Mean 1,535 893 SD 2,698 668 fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(yield_ha_kg ~ group | age, data=hh, render=fmt, caption=&quot;Seed Yield (kg / ha) - Zambia&quot;) Seed Yield (kg / ha) - Zambia group Statistic ≥ 30 Mweete Mean 1,467 762 SD 1,050 758 Tiwine Mean 651 1,295 SD 435 1,131 Mumbwa Mean 425 548 SD 106 463 Chiyota Mean 1,707 789 SD 2,719 861 ggplot(hh, aes(gender, yield_ha_kg, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Seed Yield (kg / ha) - Zambia&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, sales_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, yield_ha_kg, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Seed Yield (Kg / ha) - Zambia&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, sales_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. outlier &lt;- &quot;&quot; ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + geom_point(data=hh[hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg), alpha=.7, color=2, shape=18) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Zambia&quot;, subtitle=&quot;Each point is a respondent (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Zambia&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;right&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=group, fill=group), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Zambia&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;right&quot;) Profitability By gender: fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(margin_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Zambia&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Zambia group Statistic Male Female Mweete Mean 234 672 SD 267 1,105 Tiwine Mean 2,337 398 SD 3,508 437 Mumbwa Mean 421 276 SD 537 351 Chiyota Mean 375 404 SD 1,179 622 fmt &lt;- function(x) c(Mean=percent(mean(x, na.rm=T)), SD=percent(sd(x, na.rm=T))) ttt(margin_ha_sh ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Zambia&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Zambia group Statistic Male Female Mweete Mean 154% 312% SD 163% 403% Tiwine Mean 1 177% 667% SD 1 408% 786% Mumbwa Mean 300% 96% SD 408% 128% Chiyota Mean 1 805% 344% SD 3 289% 540% By age group: fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(margin_ha_ppp ~ group | age, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Zambia&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Zambia group Statistic ≥ 30 Mweete Mean 1,606 293 SD 1,957 330 Tiwine Mean 808 2,206 SD 1,018 3,846 Mumbwa Mean 295 321 SD 37 429 Chiyota Mean 441 346 SD 1,275 530 fmt &lt;- function(x) c(Mean=percent(mean(x, na.rm=T)), SD=percent(sd(x, na.rm=T))) ttt(margin_ha_sh ~ group | age, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Zambia&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Zambia group Statistic ≥ 30 Mweete Mean 630% 180% SD 588% 233% Tiwine Mean 876% 1 023% SD 879% 1 487% Mumbwa Mean 113% 161% SD 30% 263% Chiyota Mean 514% 1 541% SD 913% 3 156% ggplot(hh, aes(x=1:nrow(hh), color=group)) + geom_linerange(aes(ymin=costs_ha_ppp, ymax=sales_ha_ppp, linetype=gender), size=.6) + geom_point(aes(y=costs_ha_ppp), shape=20, size=1.4) + geom_point(aes(y=sales_ha_ppp), shape=17, size=1.4) + scale_y_continuous(labels=comma) + labs(x=NULL, y=NULL, color=&quot;&quot;, linetype=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def(legend.position=&quot;right&quot;) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms as percentage of total costs per hectare. ggplot(hh, aes(gender, margin_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Zambia&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, margin_ha_sh, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Zambia&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_sh, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Zambia&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) rm(tmp, x, y, i, fmt) save.image(&quot;../tmp/data_zmb.RData&quot;) "]]
