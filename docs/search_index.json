[["index.html", "Supporting Seed Systems for Development Objectives", " Supporting Seed Systems for Development BACOU, Melanie Last updated on 2021-07-28 – CODES AND NOTES Objectives This notebook summarizes results from the 2020 S34D field surveys. The objective of this activity is to understand the operational efficiency and profitability of seed producer groups across different environments (multiple geographies, policy and regulatory systems). The farmers in the surveyed groups produce certified seeds as well as high-quality informal seeds that go through internal seed quality assurance mechanisms. We have chosen several countries that are at different stages of agricultural transformation and with varying degrees of seed systems maturity. Comparing and contrasting these seed producer clubs within and across their respective contexts can help guide development partners in designing interventions and inform policy making and seed system regulations. The analysis is split by country, with a cross-country evaluation once all survey results have been compiled. R code chunks are shown for reproducibility. library(lubridate) library(kableExtra) library(viridisLite) library(scales) library(ggplot2) library(data.table) library(ttt) library(thematic) library(showtext) library(ggalluvial) library(GGally) knitr::opts_chunk$set(fig.height=3, fig.width=5, dpi=220, fig.path=&quot;fig/&quot;, fig.showtext=TRUE, include=TRUE, error=FALSE, warning=FALSE, message=FALSE) # Helper - Default FtF colors for plots pal &lt;- c(&quot;#4799b5&quot;, &quot;#94a545&quot;, &quot;#d37d28&quot;, &quot;#8B1E3F&quot;, &quot;#403b33&quot;) thematic_on(&quot;transparent&quot;, &quot;#2f2f29&quot;, c(&quot;#4799b5&quot;, &quot;#e6e7e8&quot;), font_spec(c(&quot;Roboto Condensed&quot;, &quot;Roboto&quot;)), qualitative = alpha(pal, .9)) theme_def &lt;- function( base_size = 7, base_family = &quot;Roboto Condensed&quot;, base_fill = &quot;transparent&quot;, ...) theme_minimal(base_size, base_family) + theme( panel.background = element_rect(fill=base_fill, color=NA), plot.background = element_rect(fill=base_fill, color=NA), legend.box.background = element_rect(fill=base_fill, color=NA), text = element_text(lineheight=.8), plot.title = element_text(size=base_size+1), plot.subtitle = element_text(color=&quot;#4799b5&quot;, size=base_size), strip.text = element_text(face=&quot;bold&quot;, hjust=0, size=base_size), axis.text = element_text(size=base_size), axis.title = element_text(hjust=0), legend.key.width = unit(.8, &quot;line&quot;), legend.key.height = unit(.8, &quot;line&quot;) ) + theme(...) # Helper - Default theme for tables kbl &lt;- function(...) kableExtra::kbl(...) %&gt;% kable_styling( bootstrap_options=c(&quot;condensed&quot;, &quot;responsive&quot;, &quot;striped&quot;, &quot;hover&quot;), font_size=14) # Helper - Print contingency table with chisq tests options(ttt.theme=&quot;booktabs&quot;) ttt_ftable &lt;- function(data, vars, ...) { stopifnot(length(vars)==3) dt = data[, .SD, .SDcols=vars] N = nrow(dt) dt = table(dt) test = mantelhaen.test(dt) dt = dt %&gt;% prop.table() %&gt;% addmargins(...) %&gt;% ftable() names(attr(dt, &quot;row.vars&quot;)) = vars[1:2] dt = round(100*dt, digits=1) ttt(dt, caption=&quot;Contingency Table (% of respondents)&quot;, footnote=paste( &quot;N =&quot;, N, &quot;| Mantel-Haenszel chi-squared =&quot;, comma(test[[1]], acc=.01), &quot;| p-value = &quot;, comma(test[[3]], acc=.0001)) ) } # Helper - Formatters fmt &lt;- function(x) c( Mean = comma(mean(x, na.rm=T)), Med = comma(median(x, na.rm=T)), SD = comma(sd(x, na.rm=T))) fmt_pct &lt;- function(x) c( Mean = percent(mean(x, na.rm=T)), Med = percent(median(x, na.rm=T)), SD = percent(sd(x, na.rm=T))) "],["01.html", "Vietnam Survey Codebook Data Enrichment Descriptive Statistics Correlation Clustering", " Vietnam Field work in Vietnam consisted of a qualitative assessment with focus group discussions and quantitative surveys. We first look at the consolidated survey results. Notes: 1 Int’l $ = 7,473.67 VND (Vietnamese Dong) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) Focus crop = rice Transportation costs are lumped into the cost of pesticides, fertilizers and harvesting. Labor costs are per hectare Inspection and certification fees are per farm (total fees for a single season). Only farmers who sell to seed centers or seed companies do incur these marketing costs. Survey Codebook xrate &lt;- 7473.67 # Load respondent data hh &lt;- fread(&quot;../data/vnm/hh.csv&quot;) # Load group data group &lt;- fread(&quot;../data/vnm/group.csv&quot;) # Load final codebook lbl &lt;- fread(&quot;../data/codebook.csv&quot;) There are 21 variables and 60 observations in this set. A detailed codebook is shown below. kbl(lbl[label %in% names(hh)], align=&quot;llccc&quot;, caption=&quot;Survey Codebook&quot;) Tab. 1: Survey Codebook code label type unit constructed adm1_nm Province character class FALSE group Group character class FALSE code Code character class FALSE age Age numeric years FALSE gender Sex character class FALSE member_years How long have you been a member of this group? numeric years FALSE seed_ha_lcu Cost seed per ha (LCU) numeric lcu/ha FALSE fert_ha_lcu Cost of fertilizer per ha (LCU) numeric lcu/ha FALSE pest_ha_lcu Cost of pesticide per ha (LCU) numeric lcu/ha FALSE tran_ha_lcu Cost of transport per ha (LCU) logical lcu/ha FALSE labor_ha_lcu Labor cost (LCU) numeric lcu/ha FALSE cert_lcu Inspection / certification Fees (LCU) numeric lcu/farm/season FALSE labl_kg_lcu Labelling costs per kg (LCU) numeric lcu/kg FALSE pckg_kg_lcu Packaging costs per kg (LCU) numeric lcu/kg FALSE mark_kg_lcu Other marketing costs? (LCU) numeric lcu/kg FALSE yield_ha_kg Estimated Yield (kg/ha) numeric kg/ha FALSE sales_kg_lcu Selling price of seed per kg (LCU) numeric lcu/kg FALSE sales_ha_kg How many kg were sold in the season? numeric kg/ha FALSE margin_exp_ha_sh What was your expected gross margin? numeric lcu/ha FALSE costs_ha_lcu Total production cost numeric lcu/ha FALSE sales_ha_lcu Gross sales numeric lcu/ha FALSE Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. Note that we create a categorical variable ssd to indicate whether a farmer currently engages in formal seed system distribution. setorder(hh, adm1_nm, group, gender) hh[, `:=`( hhid = paste(&quot;VNM&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;VNM&quot;, crop = &quot;rice&quot;, adm1_nm = factor(adm1_nm), group = factor(group, levels=hh[, unique(group)]), Gender = factor(gender, levels=c(&quot;Nam&quot;, &quot;Nữ&quot;), labels=c(&quot;Male&quot;, &quot;Female&quot;)), ssd = factor(cert_lcu &gt; 0, labels=c(&quot;Informal&quot;, &quot;Formal&quot;)) )] Data Enrichment Below we append some of the information that was recorded at the group level. kbl(group, align=&quot;lccccccc&quot;) Group Established Members Soil Seasons Irrigation Market access Transboundary trade Ta Ben 2001 30 loamy 2.0 good Vicinity to local market, good road to infrastructure No Trung Hiep 2003 8 sandy-silty 2.5 good Vicinity to local market, good road to infrastructure No Vinh Trach 2004 15 clay 3.0 good Vicinity to local market, good road to infrastructure Yes Binh My 2004 8 clay 3.0 good Vicinity to local market, good road to infrastructure Yes Vinh Qui 2002 40 clay 3.0 good Vicinity to local market, good road to infrastructure Yes # Merge hh[group, on=.(group=Group), `:=`( group_year = `Established`, group_size = `Members`, soil_type = `Soil`, seasons = `Seasons`, irrigated = `Irrigation`, market_access = `Market access`, ttrade = `Transboundary trade` )] Spatial Covariates Using community GPS coordinates we also suggest to enrich this dataset with additional biophysical and geospatial variables, e.g.: Agroecological zone Travel time to nearest market Distance to nearest seed center / company Size of nearest seed center / company Population density Last season total rainfall Last season heat stress days (if any) [pending GPS coordinates] Constructed Variables We check farmer-reported total costs costs_ha_lcu against the sum of individual cost line items. hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, costs_ha_lcu_imp := # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + # Per kg costs yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu + mark_kg_lcu)] hh[, summary(costs_ha_lcu_imp - costs_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0 0 0 0 0 0 There is no discrepancy between the 2 quantities, so we can assume that total costs are constructed per the formula above. No error was found. We also check that farmer-reported sales and profit margins are consistent. hh[, summary(sales_ha_lcu - (sales_kg_lcu * sales_ha_kg))] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0 0 0 0 0 0 Further we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as output per unit of input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( margin_ha_lcu = sales_ha_lcu - costs_ha_lcu )][, `:=`( sales_ha_sh = sales_ha_lcu / costs_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_ha_lcu, costs_ha_ppp = costs_ha_lcu / xrate, sales_ha_ppp = sales_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / costs_ha_ppp )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Transport = tran_ha_lcu, Labor = labor_ha_lcu, Certification = cert_lcu, Labeling = yield_ha_kg * labl_kg_lcu, Packaging = yield_ha_kg * pckg_kg_lcu, Marketing = yield_ha_kg * mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) And we lump all marketing costs into a single category. hh_prod_cost[, type_alt := factor(as.character(type), labels=c( Seeds = &quot;Seeds&quot;, Fertilizer = &quot;Fertilizer&quot;, Pesticides = &quot;Pesticides&quot;, Labor = &quot;Labor&quot;, Certification = &quot;Marketing&quot;, Transport = &quot;Marketing&quot;, Labeling = &quot;Marketing&quot;, Packaging = &quot;Marketing&quot;, Marketing = &quot;Marketing&quot; ))] hh_prod_cost &lt;- hh_prod_cost[, .( lcu = sum(lcu, na.rm=T) ), by=.(hhid, type=type_alt) ][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid) ][hh, on=.(hhid), `:=`( # Add classes group = i.group, gender = i.gender, age = i.age, crop = i.crop, ssd = i.ssd )] Note that in the current survey we are missing farm sizes (or planted acreage), so we can not directly study the effect of farm size on the per-unit costs of production and yields, or look at potential scale effects on a farmer’s efficiency and profitability. We can however study whether larger groups might have positive effects. Descriptive Statistics Respondent Characteristics First a breakdown by group. ggplot( hh[, .N, by=.(adm1_nm, group, ssd, gender)], aes(axis1=adm1_nm, axis2=gender, axis3=ssd, y=N)) + geom_alluvium(aes(fill=group), width=1/4) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Province&quot;, &quot;Gender&quot;, &quot;Seed Distribution&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Survey Respondents (Vietnam)&quot;, subtitle = &quot;Stratified by club and demographics (N = 60)&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, and use of formal seed system distribution ssd). Rice in Vietnam is a male-dominated production, hence the absence of female respondents in a few clubs. ttt_ftable(hh, vars=c(&quot;group&quot;, &quot;gender&quot;, &quot;ssd&quot;)) Contingency Table (% of respondents) group gender Informal Formal Sum N = 60 | Mantel-Haenszel chi-squared = 21.93 | p-value = 0.0002 Binh My Nam 10 1.7 11.7 Sum 10 1.7 11.7 Vinh Qui Nam 16.7 0 16.7 Sum 16.7 0 16.7 Vinh Trach Nam 25 3.3 28.3 Nữ 1.7 0 1.7 Sum 26.7 3.3 30 Ta Ben Nam 16.7 0 16.7 Nữ 5 0 5 Sum 21.7 0 21.7 Trung Hiep Nam 6.7 0 6.7 Nữ 11.7 1.7 13.3 Sum 18.3 1.7 20 Sum Nam 75 5 80 Nữ 18.3 1.7 20 Sum 93.3 6.7 100 Mantel-Haenszel test shows weak association between the 3 variables. This is further shown in the 2x2 mosaic plots below (standardized residuals between [-2,2]). mosaicplot(~gender+ssd, hh, shade=T, main=NA, xlab=&quot;Gender&quot;, ylab=&quot;Seed System&quot;) mosaicplot(~adm1_nm+ssd, hh, shade=T, main=NA, xlab=&quot;Province&quot;, ylab=&quot;Seed System&quot;) NB. blue means there are more observations in the cell than would be expected under the null model (independence). Red means there are fewer observations than would have been expected. Seed Production Costs General breakdown and distribution of input costs across seed clubs, gender, and input type. ttt(costs_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Total Input Costs in Absolute Terms (PPP$ / ha) - Vietnam&quot;) Total Input Costs in Absolute Terms (PPP$ / ha) - Vietnam group Statistic Nam Nữ Binh My Mean 2,913 NA Med 3,106 NA SD 642 NA Vinh Qui Mean 3,011 NA Med 2,950 NA SD 621 NA Vinh Trach Mean 2,882 2,520 Med 2,938 2,520 SD 442 NA Ta Ben Mean 2,817 2,076 Med 2,806 2,048 SD 447 235 Trung Hiep Mean 2,401 2,961 Med 2,437 2,973 SD 685 481 ggplot(hh, aes(gender, costs_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, costs_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Breakdown across categories of farm input. ttt(ppp ~ type | gender, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Gender (PPP$ / ha) - Vietnam&quot;) Input Costs in Absolute Terms by Gender (PPP$ / ha) - Vietnam type Statistic Nam Nữ Seeds Mean 10 3 Med 0 0 SD 45 12 Fertilizer Mean 613 517 Med 592 496 SD 179 161 Pesticides Mean 0 0 Med 0 0 SD 0 0 Labor Mean 1,203 1,128 Med 1,136 1,167 SD 391 205 Marketing Mean 1,033 1,055 Med 978 942 SD 382 393 ttt(ppp ~ type | ssd, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Seed System Type (PPP$ / ha) - Vietnam&quot;) Input Costs in Absolute Terms by Seed System Type (PPP$ / ha) - Vietnam type Statistic Informal Formal Seeds Mean 0 136 Med 0 141 SD 0 98 Fertilizer Mean 597 551 Med 563 507 SD 179 196 Pesticides Mean 0 0 Med 0 0 SD 0 0 Labor Mean 1,167 1,480 Med 1,123 1,452 SD 359 277 Marketing Mean 1,048 892 Med 971 961 SD 386 294 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(gender, ssd, type)] ggplot(tbl, aes(gender, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(5)) + facet_wrap(~ssd) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Vietnam&quot;, subtitle=&quot;Stratified by gender and seed system&quot;) + theme_def() tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(group, type)] ggplot(tbl, aes(group, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(5)) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def() Are there significant differences across groups? We first compare input cost shares across gender, then across seed clubs. ggplot(hh_prod_cost[!type %in% c(&quot;Pesticides&quot;, &quot;Seeds&quot;)], aes(type, share, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + coord_flip() + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (Percent of Total Costs by Ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggplot(hh_prod_cost[!type %in% c(&quot;Pesticides&quot;, &quot;Seeds&quot;)], aes(type, share, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + coord_flip() + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures across groups? ttt(yield_ha_kg ~ group | gender, data=hh, render=fmt, caption=&quot;Expected Rice Seed Yield (kg / ha) - Vietnam&quot;) Expected Rice Seed Yield (kg / ha) - Vietnam group Statistic Nam Nữ Binh My Mean 8,272 NA Med 8,400 NA SD 1,325 NA Vinh Qui Mean 9,850 NA Med 10,250 NA SD 1,717 NA Vinh Trach Mean 8,709 9,000 Med 8,460 9,000 SD 1,883 NA Ta Ben Mean 9,770 7,467 Med 10,000 7,700 SD 1,113 404 Trung Hiep Mean 7,182 7,938 Med 7,250 7,750 SD 623 904 ggplot(hh, aes(gender, yield_ha_kg, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Rice Seed Yield (kg / ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, sales_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, yield_ha_kg, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Rice Seed Yield (Kg / ha) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, sales_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. NB. Farmer VNM013 in Winh Qui has total costs over PPP$ 4,000/ha. He was excluded from the approximation (in red below). outlier &lt;- &quot;VNM013&quot; ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + geom_point(data=hh[hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg), alpha=.7, color=2, shape=18) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Vietnam&quot;, subtitle=&quot;Each point is a respondent (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~gender, scales=&quot;free_x&quot;) + coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Vietnam&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=group, fill=group), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~group) + coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Vietnam&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) Profitability ttt(margin_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Vietnam&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Vietnam group Statistic Nam Nữ Binh My Mean 3,839 NA Med 3,518 NA SD 1,374 NA Vinh Qui Mean 5,759 NA Med 6,333 NA SD 1,932 NA Vinh Trach Mean 4,334 6,391 Med 4,555 6,391 SD 1,949 NA Ta Ben Mean 6,627 5,003 Med 6,600 4,828 SD 925 596 Trung Hiep Mean 7,084 8,235 Med 7,648 8,665 SD 2,657 1,947 ttt(margin_ha_sh ~ group | gender, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of total input costs) - Vietnam&quot;) Mean Gross Profit Margin in Relative Terms (% of total input costs) - Vietnam group Statistic Nam Nữ Binh My Mean 142% NA Med 118% NA SD 68% NA Vinh Qui Mean 196% NA Med 206% NA SD 63% NA Vinh Trach Mean 154% 254% Med 155% 254% SD 72% NA Ta Ben Mean 240% 245% Med 222% 236% SD 48% 56% Trung Hiep Mean 304% 285% Med 256% 249% SD 136% 91% ggplot(hh, aes(x=1:nrow(hh), color=group)) + geom_linerange(aes(ymin=costs_ha_ppp, ymax=sales_ha_ppp), size=.6) + geom_point(aes(y=costs_ha_ppp), shape=20, size=1.4) + geom_point(aes(y=sales_ha_ppp, shape=margin_ha_ppp&gt;0, fill=group), size=1.4) + scale_y_continuous(labels=comma) + scale_shape_manual(values=c(25, 24)) + guides(shape=F, fill=F) + labs(x=NULL, y=NULL, color=&quot;&quot;, linetype=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def(legend.position=&quot;right&quot;) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms as percentage of total input costs per hectare. ggplot(hh, aes(gender, margin_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Vietnam&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, margin_ha_sh, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Vietnam&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Vietnam&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_sh, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Vietnam&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) Correlation Significant associations. ggpairs( hh[, .(`seed club`=group, age, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal, size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA), combo=wrap(&quot;box_no_facet&quot;, fill=pal, alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal, alpha=.8)), title=&quot;Correlogram stratified by seed club - Vietnam&quot; ) + theme_def( strip.text=element_text(hjust=.5), axis.text.x=element_text(angle=-45), panel.grid.major=element_blank() ) ggpairs( hh[, .(gender, age, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by gender - Vietnam&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) Clustering [TBD] rm(tmp, x, y, i) saveRDS(hh, &quot;../tmp/data_vnm.rds&quot;) "],["02.html", "Niger Survey Codebook Descriptive Statistics Correlation", " Niger Notes: 1 Int’l $ = 257.60 XOF (CFA) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) All costs are reported per hectare. Inspection, certification and other marketing costs are assumed for the entire farm. Labeling and packaging are per kg. Some farmers grow multiple crops Survey Codebook xrate &lt;- 257.60 # Load respondent data hh &lt;- fread(&quot;../data/nre/hh.csv&quot;) group &lt;- fread(&quot;../data/nre/group.csv&quot;) # Load complete codebook lbl &lt;- fread(&quot;../data/codebook.csv&quot;) There are 24 variables and 80 observations in this set. A detailed codebook is shown below. kbl(lbl[label %in% names(hh)], align=&quot;llccc&quot;, caption=&quot;Survey Codebook&quot;) Tab. 2: Survey Codebook code label type unit constructed adm2_nm District character class FALSE adm3_nm Location character class FALSE group Group character class FALSE code Code character class FALSE age Age numeric years FALSE gender Sex character class FALSE crop Crop character class FALSE member_years How long have you been a member of this group? numeric years FALSE seed_ha_lcu Cost seed per ha (LCU) numeric lcu/ha FALSE fert_ha_lcu Cost of fertilizer per ha (LCU) numeric lcu/ha FALSE pest_ha_lcu Cost of pesticide per ha (LCU) numeric lcu/ha FALSE tran_ha_lcu Cost of transport per ha (LCU) logical lcu/ha FALSE labor_ha_lcu Labor cost (LCU) numeric lcu/ha FALSE cert_lcu Inspection / certification Fees (LCU) numeric lcu/farm/season FALSE labl_kg_lcu Labelling costs per kg (LCU) numeric lcu/kg FALSE pckg_kg_lcu Packaging costs per kg (LCU) numeric lcu/kg FALSE mark_kg_lcu Other marketing costs? (LCU) numeric lcu/kg FALSE yield_ha_kg Estimated Yield (kg/ha) numeric kg/ha FALSE sales_kg_lcu Selling price of seed per kg (LCU) numeric lcu/kg FALSE sales_grain_sowing_kg_lcu Selling price of grain per kg (LCU) at sowing numeric lcu/kg FALSE sales_grain_harvest_kg_lcu Selling price of grain per kg (LCU) at harvest numeric lcu/kg FALSE sales_ha_kg How many kg were sold in the season? numeric kg/ha FALSE margin_exp_ha_sh What was your expected gross margin? numeric lcu/ha FALSE date Date date date FALSE Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. setorder(hh, adm2_nm, adm3_nm, group, gender, crop) hh[, `:=`( hhid = paste(&quot;NRE&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;NRE&quot;, adm2_nm = factor(adm2_nm), adm3_nm = factor(adm3_nm), group = factor(group, levels=c( &quot;Boukassa_Noma&quot;, &quot;Cigaban_Matta&quot;, &quot;Yada_Iri&quot;, &quot;HIMMA&quot; ), labels=c( &quot;Boukassa Noma&quot;, &quot;Cigaban Matta&quot;, &quot;Yada Iri&quot;, &quot;Himma&quot; )), gender = factor(gender, levels=c(&quot;male&quot;, &quot;female&quot;), labels=c(&quot;Male&quot;, &quot;Female&quot;)), age = factor(age, levels=c(&quot;15-29&quot;, &quot;30+&quot;), labels=c(&quot;&lt; 30&quot;, &quot;≥ 30&quot;)), crop = factor(crop) )] Constructed Variables We construct total costs per ha costs_ha_lcu as the sum of individual cost line items. hh[, costs_ha_lcu := # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu)] hh[, summary(costs_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 21100 90719 172200 242594 299875 896000 We also construct total sales per ha sales_ha_lcu. hh[, sales_ha_lcu := sales_kg_lcu * sales_ha_kg] hh[, summary(sales_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0 100000 250000 297626 400000 1000000 Note that 6 respondents indicate no sales this past season (crop failure or decision not to sell): kbl(hh[sales_ha_lcu==0, .(hhid, group, adm2_nm, costs_ha_lcu, yield_ha_kg, sales_ha_kg)]) hhid group adm2_nm costs_ha_lcu yield_ha_kg sales_ha_kg NRE042 Boukassa Noma Guidan Roumdji 118200 1500 0 NRE046 Boukassa Noma Guidan Roumdji 113250 1000 0 NRE047 Boukassa Noma Guidan Roumdji 61900 100 0 NRE056 Cigaban Matta Guidan Roumdji 85000 500 0 NRE074 Yada Iri Guidan Roumdji 502000 800 0 NRE076 Yada Iri Guidan Roumdji 542000 800 0 Further we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as output per unit of input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( margin_ha_lcu = sales_ha_lcu - costs_ha_lcu )][, `:=`( sales_ha_sh = sales_ha_lcu / costs_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_ha_lcu, costs_ha_ppp = costs_ha_lcu / xrate, sales_ha_ppp = sales_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / costs_ha_ppp )] hh[, summary(margin_ha_sh)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## -1.0000 -0.5173 0.4750 1.0650 1.8612 9.8108 Below we append some of the information that was recorded at the group level. kbl(group, align=&quot;lllllc&quot;) Group Region Department Commune Location Market access Irrigation Seasons Transboundary trade Members Established Boukassa Noma Maradi Guidan Roumdji Chadakori Kouroungoussaou – – 1 Yes 56 1998 Yada Iri Maradi Guidan Roumdji Chadakori Chadakori – – 1 No 80 1998 Cigaban Matta Maradi Guidan Roumdji Chadakori Chadakori – – 1 No 33 1998 HIMMA Maradi Dakoro Sabon Machi Sabon Machi – – 1 Yes 44 1999 # Same recodes in the group-level dataset group[, Group := factor(Group, levels=c( &quot;Boukassa Noma&quot;, &quot;Cigaban Matta&quot;, &quot;Yada Iri&quot;, &quot;HIMMA&quot; ), labels=c( &quot;Boukassa Noma&quot;, &quot;Cigaban Matta&quot;, &quot;Yada Iri&quot;, &quot;Himma&quot; ))] # Merge hh[group, on=.(group=Group), `:=`( group_year = `Established`, group_size = `Members`, seasons = `Seasons`, irrigated = `Irrigation`, market_access = `Market access`, ttrade = `Transboundary trade` )] Finally we normalize all cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table per ha hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Transport = tran_ha_lcu, Labor = labor_ha_lcu, Certification = cert_lcu, Labeling = yield_ha_kg * labl_kg_lcu, Packaging = yield_ha_kg * pckg_kg_lcu, Marketing = mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) And we lump all marketing costs into a single category. hh_prod_cost[, type_alt := factor(as.character(type), labels=c( Seeds = &quot;Seeds&quot;, Fertilizer = &quot;Fertilizer&quot;, Pesticides = &quot;Pesticides&quot;, Labor = &quot;Labor&quot;, Certification = &quot;Marketing&quot;, Transport = &quot;Marketing&quot;, Labeling = &quot;Marketing&quot;, Packaging = &quot;Marketing&quot;, Marketing = &quot;Marketing&quot; ))] hh_prod_cost &lt;- hh_prod_cost[, .( lcu = sum(lcu, na.rm=T) ), by=.(hhid, type=type_alt) ][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid) ][hh, on=.(hhid), `:=`( # Add classes group = i.group, gender = i.gender, age = i.age, crop = i.crop )] Descriptive Statistics Respondent Characteristics First a breakdown by group. ggplot( hh[, .N, by=.(group, age, gender, crop)], aes(axis1=gender, axis2=age, axis3=crop, y=N)) + geom_alluvium(aes(fill=group), width=1/4) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Gender&quot;, &quot;Age&quot;, &quot;Crop&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Survey Respondents (Niger)&quot;, subtitle = &quot;Stratified by club and demographics&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, and age age). ttt_ftable(hh, vars=c(&quot;group&quot;, &quot;gender&quot;, &quot;age&quot;)) Contingency Table (% of respondents) group gender ≥ 30 Sum N = 80 | Mantel-Haenszel chi-squared = 2.81 | p-value = 0.4219 Boukassa Noma Male 0 7.5 7.5 Female 1.2 3.8 5 Sum 1.2 11.2 12.5 Cigaban Matta Male 0 10 10 Female 0 2.5 2.5 Sum 0 12.5 12.5 Yada Iri Male 0 18.8 18.8 Female 0 6.2 6.2 Sum 0 25 25 Himma Male 1.2 22.5 23.8 Female 8.8 17.5 26.2 Sum 10 40 50 Sum Male 1.2 58.8 60 Female 10 30 40 Sum 11.2 88.8 100 Mantel-Haenszel test shows weak association between the 3 variables, however there is an over-representation of younger female farmers in the sample, as shown in the 2x2 mosaic plots below (standardized residual of the loglinear model over 2). mosaicplot(~gender+age, hh, shade=T, main=NA, xlab=&quot;Gender&quot;, ylab=&quot;Age&quot;) mosaicplot(~sub(&quot; &quot;, &quot;\\n&quot;, group)+age, hh, shade=T, main=NA, xlab=&quot;Group&quot;, ylab=&quot;Age&quot;) NB. blue means there are more observations in the cell than would be expected under the null model (independence). Red means there are fewer observations than would have been expected. Seed Production Costs General breakdown and distribution of input costs across seed clubs, crop, gender, and input type. Note that HIMMA group grows both cowpea and millet. ttt(costs_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Total Input Costs in Absolute Terms (PPP$ / ha) - Niger&quot;) Total Input Costs in Absolute Terms (PPP$ / ha) - Niger group Statistic Male Female Boukassa Noma Mean 1,455 1,469 Med 1,545 1,334 SD 1,046 1,272 Cigaban Matta Mean 309 205 Med 265 205 SD 148 79 Yada Iri Mean 994 923 Med 811 571 SD 674 751 Himma Mean 1,098 831 Med 978 429 SD 686 858 ggplot(hh, aes(gender, costs_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(sub(&quot; &quot;, &quot;\\n&quot;, group), costs_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by crop and seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Breakdown across categories of farm input. ttt(ppp ~ type | gender+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Gender (PPP$ / ha) - Niger&quot;) Input Costs in Absolute Terms by Gender (PPP$ / ha) - Niger type Statistic cowpea millet Male Female Male Female Seeds Mean 11 14 4 3 Med 12 12 0 0 SD 7 10 5 5 Fertilizer Mean 113 112 132 71 Med 136 140 130 68 SD 40 40 68 51 Pesticides Mean 267 216 531 425 Med 136 0 0 0 SD 466 456 793 814 Labor Mean 185 152 108 90 Med 155 116 103 78 SD 87 87 55 50 Marketing Mean 370 347 252 320 Med 375 292 80 74 SD 190 136 343 391 ttt(ppp ~ type | group, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Niger&quot;) Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Niger type Statistic Boukassa Noma Cigaban Matta Yada Iri Himma Seeds Mean 4 1 12 8 Med 1 0 19 12 SD 5 2 9 8 Fertilizer Mean 101 118 124 96 Med 66 125 140 107 SD 103 47 33 47 Pesticides Mean 720 0 377 360 Med 689 0 0 146 SD 714 0 623 704 Labor Mean 104 85 147 154 Med 96 71 150 135 SD 50 41 69 94 Marketing Mean 531 84 316 340 Med 329 43 312 288 SD 489 127 174 260 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(gender, crop, type)] ggplot(tbl, aes(gender, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(5)) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Niger&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def() tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(group, crop, type)] ggplot(tbl, aes(group, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(5)) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Niger&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def() Are there significant differences across groups? We first compare input cost shares across gender, then across seed clubs. ggplot(hh_prod_cost[!type %in% c(&quot;Seeds&quot;)], aes(type, share, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + coord_flip() + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (Percent of Total Costs by Ha) - Niger&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggplot(hh_prod_cost[!type %in% c(&quot;Seeds&quot;)], aes(type, share, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + coord_flip() + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Niger&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures across groups? ttt(yield_ha_kg ~ group+crop | gender, data=hh, render=fmt, caption=&quot;Expected Seed Yield (kg / ha) - Niger&quot;) Expected Seed Yield (kg / ha) - Niger group crop Statistic Male Female Boukassa Noma millet Mean 850 838 Med 900 850 SD 459 565 Cigaban Matta millet Mean 688 340 Med 700 340 SD 236 198 Yada Iri cowpea Mean 562 620 Med 800 600 SD 279 179 Himma cowpea Mean 693 583 Med 700 600 SD 169 214 millet Mean 990 697 Med 1,000 700 SD 256 170 ggplot(hh, aes(gender, yield_ha_kg, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Seed Yield (kg / ha) - Niger&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, sales_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, yield_ha_kg, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Seed Yield (Kg / ha) - Niger&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, sales_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. outlier &lt;- hh[crop==&quot;millet&quot; &amp; costs_ha_ppp &gt; 2000, hhid] ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + geom_point(data=hh[hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg), alpha=.7, color=2, shape=18) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Niger&quot;, subtitle=&quot;Each point is a respondent (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(xlim=c(0, 2000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Niger&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;right&quot;) Profitability By gender: ttt(margin_ha_ppp ~ group+crop | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Niger&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Niger group crop Statistic Male Female Boukassa Noma millet Mean 33 -619 Med -37 -606 SD 919 277 Cigaban Matta millet Mean 639 125 Med 695 125 SD 572 113 Yada Iri cowpea Mean 68 280 Med 105 617 SD 1,342 668 Himma cowpea Mean 923 507 Med 566 799 SD 1,192 1,060 millet Mean -651 -75 Med -522 349 SD 679 1,465 ttt(margin_ha_sh ~ group+crop | gender, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Niger&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Niger group crop Statistic Male Female Boukassa Noma millet Mean -27% -66% Med -23% -67% SD 69% 38% Cigaban Matta millet Mean 219% 54% Med 283% 54% SD 156% 34% Yada Iri cowpea Mean 68% 70% Med 18% 113% SD 203% 99% Himma cowpea Mean 117% 84% Med 82% 142% SD 150% 134% millet Mean -35% 250% Med -37% 171% SD 50% 361% By age group: ttt(margin_ha_ppp ~ group+crop | age, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Niger&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Niger group crop Statistic ≥ 30 Boukassa Noma millet Mean -328 -217 Med -328 -440 SD NA 827 Cigaban Matta millet Mean NA 536 Med NA 538 SD NA 550 Yada Iri cowpea Mean NA 121 Med NA 135 SD NA 1,196 Himma cowpea Mean NA 798 Med NA 663 SD NA 1,143 millet Mean -820 182 Med -816 328 SD 1,493 1,075 ttt(margin_ha_sh ~ group+crop | age, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Niger&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Niger group crop Statistic ≥ 30 Boukassa Noma millet Mean -99% -36% Med -99% -34% SD NA 59% Cigaban Matta millet Mean NA 186% Med NA 230% SD NA 154% Yada Iri cowpea Mean NA 69% Med NA 46% SD NA 180% Himma cowpea Mean NA 107% Med NA 94% SD NA 143% millet Mean 87% 239% Med -78% 206% SD 372% 311% ggplot(hh, aes(x=1:nrow(hh), color=group)) + geom_linerange(aes(ymin=costs_ha_ppp, ymax=sales_ha_ppp), size=.6) + geom_point(aes(y=costs_ha_ppp), shape=20, size=1.4) + geom_point(aes(y=sales_ha_ppp, shape=margin_ha_ppp&gt;0, fill=group), size=1.4) + scale_y_continuous(labels=comma) + scale_shape_manual(values=c(25, 24)) + guides(shape=F, fill=F) + labs(x=NULL, y=NULL, color=&quot;&quot;, linetype=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Niger&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def(legend.position=&quot;right&quot;) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms (percentage of total costs per hectare). ggplot(hh, aes(gender, margin_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Niger&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, margin_ha_sh, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Niger&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_sh, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Niger&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) Correlation Significant associations. ggpairs( hh[, .(`seed club`=sub(&quot; &quot;, &quot;\\n&quot;, group), `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:4], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:4], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:4], alpha=.8)), title=&quot;Correlogram stratified by seed club - Niger&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) ggpairs( hh[, .(gender, age, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by gender - Niger&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) rm(tmp, x, y, i) saveRDS(hh, &quot;../tmp/data_nre.rds&quot;) "],["03.html", "Guatemala Survey Codebook Descriptive Statistics", " Guatemala Notes: 1 Int’l $ = 4.01 GTQ (Quetzal) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) All costs are reported per hectare, except for labeling and packaging costs For beans these costs are per bag of 3 pounds or 1.36 kg For potato these costs are per crate of 22.68 kg Other marketing costs are assumed also per hectare Inspection and certification fees are per farm (total fees for a single season) Some farmers grow multiple crops Survey Codebook xrate &lt;- 4.01 # Load respondent data hh &lt;- fread(&quot;../data/gtm/hh.csv&quot;) # Load complete codebook lbl &lt;- fread(&quot;../data/codebook.csv&quot;) There are 21 variables and 39 observations in this set. A detailed codebook is shown below. kbl(lbl[label %in% names(hh)], align=&quot;llccc&quot;, caption=&quot;Survey Codebook&quot;) Tab. 3: Survey Codebook code label type unit constructed adm1_nm Province character class FALSE group Group character class FALSE code Code character class FALSE age Age numeric years FALSE gender Sex character class FALSE crop Crop character class FALSE member_years How long have you been a member of this group? numeric years FALSE seed_ha_lcu Cost seed per ha (LCU) numeric lcu/ha FALSE fert_ha_lcu Cost of fertilizer per ha (LCU) numeric lcu/ha FALSE pest_ha_lcu Cost of pesticide per ha (LCU) numeric lcu/ha FALSE tran_ha_lcu Cost of transport per ha (LCU) logical lcu/ha FALSE labor_ha_lcu Labor cost (LCU) numeric lcu/ha FALSE cert_lcu Inspection / certification Fees (LCU) numeric lcu/farm/season FALSE labl_kg_lcu Labelling costs per kg (LCU) numeric lcu/kg FALSE pckg_kg_lcu Packaging costs per kg (LCU) numeric lcu/kg FALSE mark_kg_lcu Other marketing costs? (LCU) numeric lcu/kg FALSE yield_ha_kg Estimated Yield (kg/ha) numeric kg/ha FALSE sales_kg_lcu Selling price of seed per kg (LCU) numeric lcu/kg FALSE sales_ha_kg How many kg were sold in the season? numeric kg/ha FALSE margin_exp_ha_sh What was your expected gross margin? numeric lcu/ha FALSE Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. setorder(hh, adm1_nm, group, gender, crop) hh[, `:=`( hhid = paste(&quot;GTM&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;GTM&quot;, adm1_nm = factor(adm1_nm), group = factor(group, levels=c( &quot;ACORDI&quot;, &quot;PAQUIX&quot;, &quot;SAN BARTOLO&quot;, &quot;ADAT, AXOLA, ADIPY&quot; ), labels=c( &quot;Acordi&quot;, &quot;Paquix&quot;, &quot;San Bartolo&quot;, &quot;Adat Axola Adipy&quot; )), gender = factor(gender, levels=c(&quot;Male&quot;, &quot;Female&quot;)), age = factor(age, levels=c(&quot;15-29&quot;, &quot;30&quot;), labels=c(&quot;&lt; 30&quot;, &quot;≥ 30&quot;)), crop = factor(crop) )] Constructed Variables We construct total costs per ha costs_ha_lcu as the sum of individual cost line items. hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, costs_ha_lcu := # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs fifelse(crop==&quot;bean&quot;, 1/1.36, 1/22.68) * yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu)] hh[, summary(costs_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 130758 141622 3746290 25100149 25565442 236288594 We also construct total sales per ha sales_ha_lcu. hh[, sales_ha_lcu := sales_kg_lcu * sales_ha_kg] Further we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as output per unit of input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( margin_ha_lcu = sales_ha_lcu - costs_ha_lcu )][, `:=`( sales_ha_sh = sales_ha_lcu / costs_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_ha_lcu, costs_ha_ppp = costs_ha_lcu / xrate, sales_ha_ppp = sales_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / costs_ha_ppp )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table per ha hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Transport = tran_ha_lcu, Labor = labor_ha_lcu, Certification = cert_lcu, Labeling = fifelse(crop==&quot;bean&quot;, 1/1.36, 1/22.68) * yield_ha_kg * labl_kg_lcu, Packaging = fifelse(crop==&quot;bean&quot;, 1/1.36, 1/22.68) * yield_ha_kg * pckg_kg_lcu, Marketing = mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) And we lump all marketing costs into a single category. hh_prod_cost[, type_alt := factor(as.character(type), labels=c( Seeds = &quot;Seeds&quot;, Fertilizer = &quot;Fertilizer&quot;, Pesticides = &quot;Pesticides&quot;, Labor = &quot;Labor&quot;, Certification = &quot;Marketing&quot;, Transport = &quot;Marketing&quot;, Labeling = &quot;Marketing&quot;, Packaging = &quot;Marketing&quot;, Marketing = &quot;Marketing&quot; ))] hh_prod_cost &lt;- hh_prod_cost[, .( lcu = sum(lcu, na.rm=T) ), by=.(hhid, type=type_alt) ][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid) ][hh, on=.(hhid), `:=`( # Add classes group = i.group, gender = i.gender, age = i.age, crop = i.crop )] Descriptive Statistics Respondent Characteristics First a breakdown by group. ggplot( hh[, .N, by=.(adm1_nm, group, age, gender, crop)], aes(axis1=gender, axis2=age, axis3=crop, y=N)) + geom_alluvium(aes(fill=group), width=1/4) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Gender&quot;, &quot;Age&quot;, &quot;Crop&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Survey Respondents (Guatemala)&quot;, subtitle = &quot;Stratified by club and demographics&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, and age age). ttt_ftable(hh, vars=c(&quot;group&quot;, &quot;gender&quot;, &quot;age&quot;)) Contingency Table (% of respondents) group gender ≥ 30 Sum N = 39 | Mantel-Haenszel chi-squared = 5.02 | p-value = 0.1705 Acordi Male 5.1 12.8 17.9 Female 2.6 5.1 7.7 Sum 7.7 17.9 25.6 Paquix Male 0 25.6 25.6 Sum 0 25.6 25.6 San Bartolo Male 0 20.5 20.5 Female 0 5.1 5.1 Sum 0 25.6 25.6 Adat Axola Adipy Male 2.6 20.5 23.1 Sum 2.6 20.5 23.1 Sum Male 7.7 79.5 87.2 Female 2.6 10.3 12.8 Sum 10.3 89.7 100 Mantel-Haenszel test shows weak association between the 3 variables. This is further shown in the 2x2 mosaic plots below (standardized residuals between [-2,2]). mosaicplot(~gender+age, hh, shade=T, main=NA, xlab=&quot;Gender&quot;, ylab=&quot;Age&quot;) mosaicplot(~group+age, hh, shade=T, main=NA, xlab=&quot;Province&quot;, ylab=&quot;Age&quot;) NB. blue means there are more observations in the cell than would be expected under the null model (independence). Red means there are fewer observations than would have been expected. Seed Production Costs We then look at the general breakdown and distribution of input costs across seed clubs, crop, gender, and input type. Note that Acordi and Paquix grow potato, while San Bartolo and Adapt grow bean. ttt(costs_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Total Input Costs in Absolute Terms (PPP$ / ha) - Guatemala&quot;) Total Input Costs in Absolute Terms (PPP$ / ha) - Guatemala group Statistic Male Female Acordi Mean 23,782,007 4,309,351 Med 15,662,008 3,695,694 SD 22,316,920 3,720,099 Paquix Mean 6,364,971 NA Med 4,313,985 NA SD 4,869,445 NA San Bartolo Mean 64,174 72,133 Med 34,889 72,133 SD 42,195 55,897 Adat Axola Adipy Mean 45,187 NA Med 35,175 NA SD 13,647 NA ggplot(hh, aes(gender, costs_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by gender and crop type&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, costs_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by seed club and crop type&quot;) + theme_def(legend.position=&quot;none&quot;) Breakdown across categories of farm input. ttt(ppp ~ type | gender+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Gender (PPP$ / ha) - Guatemala&quot;) Input Costs in Absolute Terms by Gender (PPP$ / ha) - Guatemala type Statistic bean potato Male Female Male Female Seeds Mean 0 0 6 6 Med 0 0 6 6 SD 0 0 0 0 Fertilizer Mean 919 919 922 919 Med 919 919 923 919 SD 0 0 2 0 Pesticides Mean 11,754 16,255 275,986 87,665 Med 7,027 16,255 183,158 75,142 SD 7,764 13,953 340,375 75,920 Labor Mean 3,425 3,425 5,593 5,577 Med 3,425 3,425 5,604 5,577 SD 0 0 14 0 Marketing Mean 38,024 51,534 13,254,186 4,215,184 Med 23,803 51,534 8,798,827 3,614,050 SD 23,340 41,943 16,338,164 3,644,178 ttt(ppp ~ type | group, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Guatemala&quot;) Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Guatemala type Statistic Acordi Paquix San Bartolo Adat Axola Adipy Seeds Mean 6 6 0 0 Med 6 6 0 0 SD 0 0 0 0 Fertilizer Mean 919 923 919 919 Med 919 923 919 919 SD 0 0 0 0 Pesticides Mean 365,846 129,629 14,665 9,520 Med 176,113 87,772 6,956 7,027 SD 420,022 99,376 10,422 3,397 Labor Mean 5,577 5,604 3,425 3,425 Med 5,577 5,604 3,425 3,425 SD 0 0 0 0 Marketing Mean 17,567,862 6,228,809 46,757 31,324 Med 8,460,689 4,219,680 23,589 23,803 SD 20,161,077 4,770,068 31,329 10,250 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(gender, crop, type)] ggplot(tbl, aes(gender, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(5)) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Guatemala&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def() tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(group, crop, type)] ggplot(tbl, aes(group, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(5)) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Guatemala&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def() Are there significant differences across groups? ggplot(hh_prod_cost, aes(type, ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + coord_flip() + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Guatemala&quot;, subtitle=&quot;Stratified by gender and crop type&quot;) + theme_def(legend.position=&quot;top&quot;) ggplot(hh_prod_cost, aes(type, ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + coord_flip() + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Guatemala&quot;, subtitle=&quot;Stratified by seed club and crop type&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures across groups? fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(yield_ha_kg ~ group | gender, data=hh, render=fmt, caption=&quot;Seed Yield (kg / ha) - Guatemala&quot;) Seed Yield (kg / ha) - Guatemala group Statistic Male Female Acordi Mean 186,521 84,235 SD 111,053 42,118 Paquix Mean 97,336 NA SD 40,148 NA San Bartolo Mean 2,896 3,159 SD 1,090 1,489 Adat Axola Adipy Mean 2,106 NA SD 0 NA fmt &lt;- function(x) c(Mean=comma(mean(x, na.rm=T)), SD=comma(sd(x, na.rm=T))) ttt(yield_ha_kg ~ group | age, data=hh, render=fmt, caption=&quot;Seed Yield (kg / ha) - Guatemala&quot;) Seed Yield (kg / ha) - Guatemala group Statistic ≥ 30 Acordi Mean 168,470 150,420 SD 151,857 93,728 Paquix Mean NA 97,336 SD NA 40,148 San Bartolo Mean NA 2,948 SD NA 1,087 Adat Axola Adipy Mean 2,106 2,106 SD NA 0 ggplot(hh, aes(gender, yield_ha_kg, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Seed Yield (kg / ha) - Guatemala&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, sales_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, yield_ha_kg, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Seed Yield (Kg / ha) - Guatemala&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, sales_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. outlier &lt;- &quot;&quot; ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + geom_point(data=hh[hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg), alpha=.7, color=2, shape=18) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Guatemala&quot;, subtitle=&quot;Each point is a respondent (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Guatemala&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;right&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=group, fill=group), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Guatemala&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;right&quot;) Profitability By gender: ttt(margin_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Guatemala&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Guatemala group Statistic Male Female Acordi Mean 24,016,375 4,240,485 SD 21,834,180 3,684,277 Paquix Mean 7,821,382 NA SD 6,115,086 NA San Bartolo Mean 9,174 8,431 SD 15,052 14,046 Adat Axola Adipy Mean 31,703 NA SD 37,464 NA ttt(margin_ha_sh ~ group | gender, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Guatemala&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Guatemala group Statistic Male Female Acordi Mean 103% 98% Med 99% 98% SD 7% 1% Paquix Mean 119% NA Med 122% NA SD 13% NA San Bartolo Mean 8% 6% Med 6% 6% SD 12% 15% Adat Axola Adipy Mean 53% NA Med 7% NA SD 63% NA By age group: ttt(margin_ha_ppp ~ group | age, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Guatemala&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Guatemala group Statistic ≥ 30 Acordi Mean 22,472,925 16,202,472 SD 31,266,553 16,688,582 Paquix Mean NA 7,821,382 SD NA 6,115,086 San Bartolo Mean NA 9,025 SD NA 14,079 Adat Axola Adipy Mean -673 35,750 SD NA 37,889 ttt(margin_ha_sh ~ group | age, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Guatemala&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Guatemala group Statistic ≥ 30 Acordi Mean 98% 102% Med 99% 99% SD 2% 8% Paquix Mean NA 119% Med NA 122% SD NA 13% San Bartolo Mean NA 8% Med NA 6% SD NA 12% Adat Axola Adipy Mean -2% 60% Med -2% 63% SD NA 63% ggplot(hh, aes(x=1:nrow(hh), color=group)) + geom_linerange(aes(ymin=costs_ha_ppp, ymax=sales_ha_ppp, linetype=gender), size=.6) + geom_point(aes(y=costs_ha_ppp), shape=20, size=1.4) + geom_point(aes(y=sales_ha_ppp), shape=17, size=1.4) + scale_y_continuous(labels=comma) + labs(x=NULL, y=NULL, color=&quot;&quot;, linetype=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def(legend.position=&quot;right&quot;) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms as percentage of total costs per hectare. ggplot(hh, aes(gender, margin_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Guatemala&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, margin_ha_sh, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Guatemala&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Guatemala&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_sh, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Guatemala&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) rm(tmp, x, y, i) saveRDS(hh, &quot;../tmp/data_gtm.rds&quot;) "],["04.html", "Uganda", " Uganda [pending] "],["05.html", "Zambia Survey Codebook Descriptive Statistics", " Zambia Notes: 1 Int’l $ = 5.59 ZMW (Kwacha) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) All costs are reported per hectare. Inspection, certification and other marketing costs are assumed for the entire farm. Labeling and packaging are per kg. Some farmers grow multiple crops Survey Codebook xrate &lt;- 5.59 # Load respondent data hh &lt;- fread(&quot;../data/zmb/hh.csv&quot;) group &lt;- fread(&quot;../data/zmb/group.csv&quot;) # Load complete codebook lbl &lt;- fread(&quot;../data/codebook.csv&quot;) There are 23 variables and 76 observations in this set. A detailed codebook is shown below. kbl(lbl[label %in% names(hh)], align=&quot;llccc&quot;, caption=&quot;Survey Codebook&quot;) Tab. 4: Survey Codebook code label type unit constructed adm1_nm Province character class FALSE group Group character class FALSE code Code character class FALSE age Age numeric years FALSE gender Sex character class FALSE crop Crop character class FALSE member_years How long have you been a member of this group? numeric years FALSE seed_ha_lcu Cost seed per ha (LCU) numeric lcu/ha FALSE fert_ha_lcu Cost of fertilizer per ha (LCU) numeric lcu/ha FALSE pest_ha_lcu Cost of pesticide per ha (LCU) numeric lcu/ha FALSE tran_ha_lcu Cost of transport per ha (LCU) logical lcu/ha FALSE labor_ha_lcu Labor cost (LCU) numeric lcu/ha FALSE cert_lcu Inspection / certification Fees (LCU) numeric lcu/farm/season FALSE labl_kg_lcu Labelling costs per kg (LCU) numeric lcu/kg FALSE pckg_kg_lcu Packaging costs per kg (LCU) numeric lcu/kg FALSE mark_kg_lcu Other marketing costs? (LCU) numeric lcu/kg FALSE yield_ha_kg Estimated Yield (kg/ha) numeric kg/ha FALSE sales_kg_lcu Selling price of seed per kg (LCU) numeric lcu/kg FALSE sales_grain_sowing_kg_lcu Selling price of grain per kg (LCU) at sowing numeric lcu/kg FALSE sales_grain_harvest_kg_lcu Selling price of grain per kg (LCU) at harvest numeric lcu/kg FALSE sales_ha_kg How many kg were sold in the season? numeric kg/ha FALSE margin_exp_ha_sh What was your expected gross margin? numeric lcu/ha FALSE Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. setorder(hh, adm1_nm, group, gender, crop) hh[, `:=`( hhid = paste(&quot;ZMB&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;ZMB&quot;, adm1_nm = factor(adm1_nm), # Abbreviate seed club names group = factor(group, levels=c( &quot;Mweete Seed Growers Association&quot;, &quot;Tiwine Womens Seed growers Cooperative&quot;, &quot;Mumbwa Seed Growers Association&quot;, &quot;Chiyota Seed Growers Association&quot; ), labels=c( &quot;Mweete&quot;, &quot;Tiwine&quot;, &quot;Mumbwa&quot;, &quot;Chiyota&quot; )), gender = factor(gender, levels=c(&quot;male&quot;, &quot;female&quot;), labels=c(&quot;Male&quot;, &quot;Female&quot;)), age = factor(age, levels=c(&quot;25&quot;, &quot;15-29&quot;, &quot;30+&quot;), labels=c(&quot;&lt; 30&quot;, &quot;&lt; 30&quot;, &quot;≥ 30&quot;)), crop = factor(crop) )] Constructed Variables We construct total costs per ha costs_ha_lcu as the sum of individual cost line items. hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, costs_ha_lcu := # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu)] hh[, summary(costs_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 20.0 498.1 993.2 1524.9 1861.2 10240.0 We also construct total sales per ha sales_ha_lcu. hh[, sales_ha_lcu := sales_kg_lcu * sales_ha_kg] Further we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as output per unit of input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( margin_ha_lcu = sales_ha_lcu - costs_ha_lcu )][, `:=`( sales_ha_sh = sales_ha_lcu / costs_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_ha_lcu, costs_ha_ppp = costs_ha_lcu / xrate, sales_ha_ppp = sales_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / costs_ha_ppp )] Below we append some of the information that was recorded at the group level. kbl(group, align=&quot;llc&quot;) Group Market access Soil Irrigation Seasons Transboundary trade Members Established Tiwine Womens Seed growers Cooperative Close to market with good road network good No 1 No 50 2014 Chiyota Seed Growers Association Road is very bad. Far from markets as they take the produce to Lusaka good No 1 Yes 25 2013 Mumbwa Seed Growers Association The purchasing seed companies (Afriseed and Kamano seed company) collect on site loamy No 1 No 31 2001 Mweete Seed Growers Association They only sale to the seed company that supports them sandy No 1 No 21 2019 Kamimpampa Cooperative Good road network and supplies Afriseed company sandy No 1 No 70 2016 # Same recodes in the group-level dataset group[, Group := factor(Group, levels=c( &quot;Mweete Seed Growers Association&quot;, &quot;Tiwine Womens Seed growers Cooperative&quot;, &quot;Mumbwa Seed Growers Association&quot;, &quot;Chiyota Seed Growers Association&quot;, &quot;Kamimpampa Cooperative&quot; ), labels=c( &quot;Mweete&quot;, &quot;Tiwine&quot;, &quot;Mumbwa&quot;, &quot;Chiyota&quot;, &quot;Kamimpampa&quot; ))] # Merge hh[group, on=.(group=Group), `:=`( group_year = `Established`, group_size = `Members`, seasons = `Seasons`, irrigated = `Irrigation`, market_access = `Market access`, ttrade = `Transboundary trade` )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table per ha hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Transport = tran_ha_lcu, Labor = labor_ha_lcu, Certification = cert_lcu, Labeling = yield_ha_kg * labl_kg_lcu, Packaging = yield_ha_kg * pckg_kg_lcu, Marketing = mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) And we lump all marketing costs into a single category. hh_prod_cost[, type_alt := factor(as.character(type), labels=c( Seeds = &quot;Seeds&quot;, Fertilizer = &quot;Fertilizer&quot;, Pesticides = &quot;Pesticides&quot;, Labor = &quot;Labor&quot;, Certification = &quot;Marketing&quot;, Transport = &quot;Marketing&quot;, Labeling = &quot;Marketing&quot;, Packaging = &quot;Marketing&quot;, Marketing = &quot;Marketing&quot; ))] hh_prod_cost &lt;- hh_prod_cost[, .( lcu = sum(lcu, na.rm=T) ), by=.(hhid, type=type_alt) ][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid) ][hh, on=.(hhid), `:=`( # Add classes group = i.group, gender = i.gender, age = i.age, crop = i.crop )] Descriptive Statistics Respondent Characteristics First a breakdown by group. ggplot( hh[, .N, by=.(adm1_nm, group, age, gender, crop)], aes(axis1=gender, axis2=age, axis3=crop, y=N)) + geom_alluvium(aes(fill=group), width=1/4) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Gender&quot;, &quot;Age&quot;, &quot;Crop&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Survey Respondents (Zambia)&quot;, subtitle = &quot;Stratified by club and demographics&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, and age age). ttt_ftable(hh, vars=c(&quot;group&quot;, &quot;gender&quot;, &quot;age&quot;)) Contingency Table (% of respondents) group gender ≥ 30 Sum N = 76 | Mantel-Haenszel chi-squared = 4.79 | p-value = 0.1881 Mweete Male 2.6 10.5 13.2 Female 0 5.3 5.3 Sum 2.6 15.8 18.4 Tiwine Male 2.6 11.8 14.5 Female 1.3 14.5 15.8 Sum 3.9 26.3 30.3 Mumbwa Male 0 14.5 14.5 Female 0 17.1 17.1 Sum 0 31.6 31.6 Chiyota Male 0 14.5 14.5 Female 0 5.3 5.3 Sum 0 19.7 19.7 Sum Male 5.3 51.3 56.6 Female 1.3 42.1 43.4 Sum 6.6 93.4 100 Mantel-Haenszel test shows weak association between the 3 variables. This is further shown in the 2x2 mosaic plots below (standardized residuals between [-2,2]). mosaicplot(~gender+age, hh, shade=T, main=NA, xlab=&quot;Gender&quot;, ylab=&quot;Age&quot;) mosaicplot(~group+age, hh, shade=T, main=NA, xlab=&quot;Province&quot;, ylab=&quot;Age&quot;) NB. blue means there are more observations in the cell than would be expected under the null model (independence). Red means there are fewer observations than would have been expected. Seed Production Costs We then look at the general breakdown and distribution of input costs across seed clubs, crop, gender, and input type. ttt(costs_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Total Input Costs in Absolute Terms (PPP$ / ha) - Zambia&quot;) Total Input Costs in Absolute Terms (PPP$ / ha) - Zambia group Statistic Male Female Mweete Mean 408 150 SD 324 50 Tiwine Mean 166 358 SD 69 538 Mumbwa Mean 229 271 SD 304 192 Chiyota Mean 261 255 SD 198 231 ggplot(hh, aes(gender, costs_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by gender and crop type&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, costs_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by seed club and crop type&quot;) + theme_def(legend.position=&quot;none&quot;) Breakdown across categories of farm input. ttt(ppp ~ type | gender+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Gender (PPP$ / ha) - Zambia&quot;) Input Costs in Absolute Terms by Gender (PPP$ / ha) - Zambia type Statistic bean cowpea groundnut maize soybean Male Female Male Female Male Female Male Female Male Female Seeds Mean 0 0 2 0 0 0 0 0 0 0 SD 0 0 7 0 0 0 0 0 1 0 Fertilizer Mean 0 42 74 66 24 0 194 353 48 126 SD 0 41 98 73 58 0 195 421 78 149 Pesticides Mean 0 0 3 0 0 0 0 0 0 0 SD 0 0 12 0 0 0 0 0 0 0 Labor Mean 18 22 54 3 27 24 44 79 89 135 SD 31 21 77 7 50 31 67 122 97 138 Marketing Mean 96 81 173 73 53 102 73 92 156 136 SD 33 69 195 39 51 240 92 58 150 196 ttt(ppp ~ type | group, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Zambia&quot;) Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Zambia type Statistic Mweete Tiwine Mumbwa Chiyota Seeds Mean 2 0 0 0 SD 7 0 0 0 Fertilizer Mean 88 130 113 70 SD 91 284 166 117 Pesticides Mean 3 0 0 0 SD 12 0 0 0 Labor Mean 55 87 13 71 SD 76 111 22 91 Marketing Mean 186 49 125 118 SD 187 55 129 171 tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(crop, gender, type)] ggplot(tbl, aes(gender, share, fill=type)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Zambia&quot;, subtitle=&quot;Stratified by gender and crop types&quot;) + theme_def() tbl &lt;- hh_prod_cost[, .( share = mean(share, na.rm=T) ), keyby=.(group, crop, type)] ggplot(tbl, aes(group, share, fill=type)) + geom_bar(stat=&quot;identity&quot;, alpha=.8, width=.6) + scale_y_continuous(labels=percent) + scale_fill_manual(&quot;&quot;, values=colorRampPalette(pal)(9)) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Zambia&quot;, subtitle=&quot;Stratified by seed club and crop type&quot;) + theme_def() Are there significant differences across groups? ggplot(hh_prod_cost, aes(type, ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + coord_flip() + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Zambia&quot;, subtitle=&quot;Stratified by gender and crop type&quot;) + theme_def(legend.position=&quot;top&quot;) ggplot(hh_prod_cost, aes(type, ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + coord_flip() + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Zambia&quot;, subtitle=&quot;Stratified by seed club and crop type&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures across groups? ttt(yield_ha_kg ~ group | gender, data=hh, render=fmt, caption=&quot;Seed Yield (kg / ha) - Zambia&quot;) Seed Yield (kg / ha) - Zambia group Statistic Male Female Mweete Mean 610 330 SD 476 203 Tiwine Mean 893 1,535 SD 668 2,698 Mumbwa Mean 709 1,147 SD 822 896 Chiyota Mean 1,019 585 SD 879 692 ttt(yield_ha_kg ~ group | age, data=hh, render=fmt, caption=&quot;Seed Yield (kg / ha) - Zambia&quot;) Seed Yield (kg / ha) - Zambia group Statistic ≥ 30 Mweete Mean 425 548 SD 106 463 Tiwine Mean 1,008 1,261 SD 345 2,134 Mumbwa Mean NA 946 SD NA 873 Chiyota Mean NA 903 SD NA 833 ggplot(hh, aes(gender, yield_ha_kg, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Seed Yield (kg / ha) - Zambia&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, sales_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, yield_ha_kg, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Seed Yield (Kg / ha) - Zambia&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, sales_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. outlier &lt;- &quot;&quot; ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + geom_point(data=hh[hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg), alpha=.7, color=2, shape=18) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Zambia&quot;, subtitle=&quot;Each point is a respondent (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + #coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Zambia&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;right&quot;) Profitability By gender: ttt(margin_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Zambia&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Zambia group Statistic Male Female Mweete Mean 276 421 SD 351 537 Tiwine Mean 404 375 SD 622 1,179 Mumbwa Mean 398 2,337 SD 437 3,508 Chiyota Mean 672 234 SD 1,105 267 ttt(margin_ha_sh ~ group | gender, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Zambia&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Zambia group Statistic Male Female Mweete Mean 96% 300% Med 91% 125% SD 128% 408% Tiwine Mean 344% 1 805% Med 209% 212% SD 540% 3 289% Mumbwa Mean 667% 1 177% Med 423% 618% SD 786% 1 408% Chiyota Mean 312% 154% Med 138% 115% SD 403% 163% By age group: ttt(margin_ha_ppp ~ group | age, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Zambia&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Zambia group Statistic ≥ 30 Mweete Mean 295 321 SD 37 429 Tiwine Mean 1,183 264 SD 739 897 Mumbwa Mean NA 1,449 SD NA 2,735 Chiyota Mean NA 555 SD NA 963 ttt(margin_ha_sh ~ group | age, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Zambia&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Zambia group Statistic ≥ 30 Mweete Mean 113% 161% Med 113% 84% SD 30% 263% Tiwine Mean 876% 1 106% Med 523% 150% SD 829% 2 596% Mumbwa Mean NA 943% Med NA 428% SD NA 1 170% Chiyota Mean NA 270% Med NA 138% SD NA 356% ggplot(hh, aes(x=1:nrow(hh), color=group)) + geom_linerange(aes(ymin=costs_ha_ppp, ymax=sales_ha_ppp), size=.6) + geom_point(aes(y=costs_ha_ppp), shape=20, size=1.4) + geom_point(aes(y=sales_ha_ppp, shape=margin_ha_ppp&gt;0, fill=group), size=1.4) + scale_y_continuous(labels=comma) + scale_shape_manual(values=c(25, 24)) + guides(shape=F, fill=F) + labs(x=NULL, y=NULL, color=&quot;&quot;, linetype=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Niger&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def(legend.position=&quot;right&quot;) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms as percentage of total costs per hectare. ggplot(hh, aes(gender, margin_ha_ppp, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Zambia&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(gender, margin_ha_sh, fill=gender)) + geom_boxplot(alpha=.7) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Zambia&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_ppp, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh, aes(group, margin_ha_sh, fill=group)) + geom_boxplot(alpha=.7) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Zambia&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) rm(tmp, x, y, i) saveRDS(hh, &quot;../tmp/data_zmb.rds&quot;) # Combine all country datasets gtm &lt;- readRDS(&quot;../tmp/data_gtm.rds&quot;) nre &lt;- readRDS(&quot;../tmp/data_nre.rds&quot;) vnm &lt;- readRDS(&quot;../tmp/data_vnm.rds&quot;) zmb &lt;- readRDS(&quot;../tmp/data_zmb.rds&quot;) vars &lt;- names(nre) hh &lt;- rbindlist(list( gtm[, .SD, .SDcols=names(gtm) %in% vars], nre[, .SD, .SDcols=names(nre) %in% vars], vnm[, .SD, .SDcols=names(vnm) %in% vars], zmb[, .SD, .SDcols=names(zmb) %in% vars] ), fill=T) setcolorder(hh, lbl$code[lbl$code %in% vars]) fwrite(hh, &quot;../data/hh.csv&quot;) "]]
