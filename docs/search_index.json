[["index.html", "Supporting Seed Systems for Development Objectives Codebook", " Supporting Seed Systems for Development BACOU, Melanie Last updated on 2021-08-05 – CODES AND NOTES Objectives This notebook summarizes results from the 2020 S34D field surveys. The objective of this activity is to understand the operational efficiency and profitability of seed producer groups across different environments (multiple geographies, policy and regulatory systems). The farmers in the surveyed groups produce certified seeds as well as high-quality informal seeds that go through internal seed quality assurance mechanisms. We have chosen several countries that are at different stages of agricultural transformation and with varying degrees of seed systems maturity. Comparing and contrasting these seed producer clubs within and across their respective contexts can help guide development partners in designing interventions and inform policy making and seed system regulations. The analysis is split by country. R code chunks are shown for reproducibility. library(thematic) library(showtext) library(viridisLite) library(lubridate) library(kableExtra) library(scales) library(ggpubr) library(data.table) library(summarytools) library(ggalluvial) library(GGally) library(ttt) rm(list=ls()) # Global package options options( ttt.theme=&quot;booktabs&quot;) st_options( plain.ascii=FALSE, bootstrap.css=FALSE, headings=FALSE, dfSummary.graph.magnif=.8, dfSummary.varnumbers=FALSE) knitr::opts_chunk$set( fig.height=3, fig.width=5, dpi=220, fig.path=&quot;fig/&quot;, fig.showtext=TRUE, include=TRUE, error=FALSE, warning=FALSE, message=FALSE) # Helper - Default USAID FtF colors for plots pal &lt;- c(&quot;#4799b5&quot;, &quot;#94a545&quot;, &quot;#d37d28&quot;, &quot;#8B1E3F&quot;, &quot;#403b33&quot;) thematic_on(&quot;transparent&quot;, &quot;#2f2f29&quot;, c(&quot;#4799b5&quot;, &quot;#e6e7e8&quot;), font_spec(c(&quot;Roboto Condensed&quot;, &quot;Roboto&quot;)), qualitative = pal) theme_def &lt;- function( base_size = 7, base_family = &quot;Roboto Condensed&quot;, base_fill = &quot;transparent&quot;, ...) theme_minimal(base_size, base_family) + theme( panel.background = element_rect(fill=base_fill, color=NA), plot.background = element_rect(fill=base_fill, color=NA), legend.box.background = element_rect(fill=base_fill, color=NA), text = element_text(lineheight=.8), plot.title = element_text(size=base_size+1), plot.subtitle = element_text(color=pal[1], size=base_size), strip.text = element_text(face=&quot;bold&quot;, hjust=0, size=base_size), axis.text = element_text(size=base_size), axis.title = element_text(hjust=0), legend.key.width = unit(.8, &quot;line&quot;), legend.key.height = unit(.8, &quot;line&quot;) ) + theme(...) # Helper - Default theme for tables kbl &lt;- function(...) kableExtra::kbl(...) %&gt;% kable_styling( bootstrap_options=c(&quot;condensed&quot;, &quot;responsive&quot;, &quot;striped&quot;, &quot;hover&quot;), font_size = 14) # Helper - TTT Formatters fmt &lt;- function(x) c( mean = comma(mean(x, na.rm=T)), median = comma(median(x, na.rm=T)), sd = comma(sd(x, na.rm=T))) fmt_pct &lt;- function(x) c( mean = percent(mean(x, na.rm=T)), median = percent(median(x, na.rm=T)), sd = percent(sd(x, na.rm=T))) count &lt;- function(x) data.frame(y=Inf, label=paste(&quot;N =&quot;, length(x))) ggBoxTest &lt;- function(..., jitter=TRUE, grp.c=NULL, grp.s=NULL, cp=NULL, ref=NULL) { p = ggplot(...) if(jitter) p = p + geom_jitter(alpha=.5) p = p + geom_boxplot(alpha=.7, outlier.shape=NA) + stat_summary(grp.c, fun.data=count, geom=&quot;text&quot;, size=3, color=1, vjust=.9) if(is.null(cp) &amp;&amp; is.null(ref)) p = p + stat_compare_means(grp.s, label=&quot;p.signif&quot;, size=3.5, vjust=1, fontface=&quot;bold&quot;) + stat_compare_means(grp.s, label=&quot;p.format&quot;, size=3, vjust=3) else p = p + stat_compare_means(comparisons=cp, ref.group=ref, label=&quot;p.signif&quot;, size=3, vjust=0) } Codebook All survey datasets have been consolidated into a unique data file. A unified codebook is shown below for reference. # Load unified codebook lbl &lt;- fread(&quot;../data/codebook.csv&quot;) kbl(lbl, align=&quot;llccc&quot;, caption=&quot;Consolidated Survey Codebook&quot;) Tab. 1: Consolidated Survey Codebook code label type unit constructed notes hhid Unique farmer/crop ID character uid TRUE iso3 ISO3 country code character class TRUE adm1_nm Province character class FALSE adm1_nm Region character class FALSE adm2_nm District character class FALSE adm3_nm Location character class FALSE group Group character class FALSE code Code character class FALSE age Age character class FALSE &lt; 30, ≥ 30 age_num Age (continunous) numeric years FALSE gender Sex character class FALSE Male, Female crop Crop character class FALSE member_years How long have you been a member of this group? numeric years FALSE seed_ha_lcu Cost seed per ha (LCU) numeric lcu/ha FALSE fert_ha_lcu Cost of fertilizer per ha (LCU) numeric lcu/ha FALSE pest_ha_lcu Cost of pesticide per ha (LCU) numeric lcu/ha FALSE tran_ha_lcu Cost of transport per ha (LCU) numeric lcu/ha FALSE labor_ha_lcu Labor cost (LCU) numeric lcu/ha FALSE cert_lcu Inspection / certification Fees (LCU) numeric lcu/farm/season FALSE labl_kg_lcu Labelling costs per kg (LCU) numeric lcu/kg FALSE pckg_kg_lcu Packaging costs per kg (LCU) numeric lcu/kg FALSE mark_kg_lcu Other marketing costs? (LCU) numeric lcu/kg FALSE yield_ha_kg Estimated Yield (kg/ha) numeric kg/ha FALSE sales_kg_lcu Selling price of seed per kg (LCU) numeric lcu/kg FALSE sales_grain_sowing_kg_lcu Selling price of grain per kg (LCU) at sowing numeric lcu/kg FALSE sales_grain_harvest_kg_lcu Selling price of grain per kg (LCU) at harvest numeric lcu/kg FALSE sales_ha_kg How many kg were sold in the season? numeric kg/ha FALSE margin_exp_ha_sh What was your expected gross margin? numeric lcu/ha FALSE area_ha Area (ha) numeric ha FALSE costs_exp_ha_lcu Total production cost numeric lcu/ha TRUE costs_real_ha_lcu Total production costs per ha (realized yield) numeric lcu/ha TRUE sales_exp_ha_lcu Gross sales numeric lcu/ha TRUE sales_real_ha_lcu Gross sales per ha (realized yield) numeric lcu/ha TRUE costs_ha_ppp Total production costs per ha in PPP equivalent numeric ppp/ha TRUE sales_ha_sh Gross sales as share of tpc numeric share TRUE sales_ha_ppp Gross sales in PPP equivalent numeric ppp/ha TRUE margin_ha_lcu Gross margin per ha numeric lcu/ha TRUE margin_ha_sh Margin as share of tpc numeric share TRUE margin_ha_ppp Margin in PPP equivalent numeric ppp/ha TRUE tfp Total factor productivity numeric kg/lcu TRUE ssd Farmer participates in formal seed system distribution logical true/false TRUE Informal, Formal group_year Year the group was established integer year TRUE group_size Members in the group integer members TRUE soil_type Primary soil type character class TRUE seasons Number of seasons per year integer seasons/year TRUE irrigated Level of irrigation character class TRUE market_access Market access character class TRUE ttrade Presence of transboundary trade logical true/false TRUE date Date date date FALSE "],["01.html", "Vietnam Survey Recodes Descriptive Statistics Correlation", " Vietnam Field work in Vietnam consists of a qualitative assessment with focus group discussions and quantitative surveys. We first look at the consolidated survey results. Notes: 1 Int’l $ = 7,473.67 VND (Vietnamese Dong) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) Focus crop = rice Transportation costs are lumped into the cost of pesticides, fertilizers and harvesting. Labor costs are per hectare Inspection and certification fees are per farm (total fees for a single season). Only farmers who sell to seed centers or seed companies do incur these marketing costs. We differentiate between expected yield per ha yield_ha_kg and realized sales in the last season sales_ha_kg. Survey Recodes xrate &lt;- 7473.67 # Load respondent data hh &lt;- fread(&quot;../data/vnm/hh.csv&quot;) # Load group data group &lt;- fread(&quot;../data/vnm/group.csv&quot;) There are 21 variables and 60 observations in this set. A summary is shown below. print(dfSummary(hh), max.tbl.height=500, table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Variable Stats / Values Freqs (% of Valid) Graph Valid Missing Code [character] 1. Farmer 12. Farmer 103. Farmer 114. Farmer 125. Farmer 136. Farmer 147. Farmer 158. Farmer 169. Farmer 1710. Farmer 18[ 50 others ] 1(1.7%)1(1.7%)1(1.7%)1(1.7%)1(1.7%)1(1.7%)1(1.7%)1(1.7%)1(1.7%)1(1.7%)50(83.3%) 60 (100.0%) 0 (0.0%) Age [integer] Mean (sd) : 51.7 (10.6)min &le; med &le; max:32 &le; 52.5 &le; 75IQR (CV) : 15 (0.2) 32 distinct values 60 (100.0%) 0 (0.0%) Sex [character] 1. Nam2. Nữ 48(80.0%)12(20.0%) 60 (100.0%) 0 (0.0%) Group [character] 1. Binh My2. Ta Ben3. Trung Hiep4. Vinh Qui5. Vinh Trach 7(11.7%)13(21.7%)12(20.0%)10(16.7%)18(30.0%) 60 (100.0%) 0 (0.0%) Province [character] 1. An Giang2. Bạc Li&#0234;u3. Vĩnh Long 35(58.3%)13(21.7%)12(20.0%) 60 (100.0%) 0 (0.0%) How long have you been a member of this group? [integer] Mean (sd) : 10.2 (7.5)min &le; med &le; max:1 &le; 9.5 &le; 41IQR (CV) : 11 (0.7) 18 distinct values 60 (100.0%) 0 (0.0%) Cost seed per ha (LCU) [integer] Mean (sd) : 2023800 (636007.9)min &le; med &le; max:550000 &le; 1952500 &le; 3900000IQR (CV) : 901500 (0.3) 45 distinct values 60 (100.0%) 0 (0.0%) Cost of fertilizer per ha (LCU) [integer] Mean (sd) : 4439145 (1335996)min &le; med &le; max:2489300 &le; 4156000 &le; 8020000IQR (CV) : 1837800 (0.3) 59 distinct values 60 (100.0%) 0 (0.0%) Cost of pesticide per ha (LCU) [integer] Mean (sd) : 5710617 (2860988)min &le; med &le; max:810000 &le; 5157000 &le; 13212000IQR (CV) : 4045000 (0.5) 60 distinct values 60 (100.0%) 0 (0.0%) Cost of transport per ha (LCU) [logical] All NA's 0 (0.0%) 60 (100.0%) Labor cost (LCU) [integer] Mean (sd) : 8877388 (2700077)min &le; med &le; max:3762000 &le; 8500000 &le; 15338000IQR (CV) : 3967000 (0.3) 58 distinct values 60 (100.0%) 0 (0.0%) Inspection / certification Fees (LCU) [integer] Mean (sd) : 67700 (304582.1)min &le; med &le; max:0 &le; 0 &le; 1650000IQR (CV) : 0 (4.5) 0:56(93.3%)300000:1(1.7%)462000:1(1.7%)1650000:2(3.3%) 60 (100.0%) 0 (0.0%) Labelling costs per kg (LCU) [integer] 1 distinct value 0:60(100.0%) 60 (100.0%) 0 (0.0%) Packaging costs per kg (LCU) [integer] Mean (sd) : 2.3 (13.8)min &le; med &le; max:0 &le; 0 &le; 100IQR (CV) : 0 (5.9) 0:58(96.7%)40:1(1.7%)100:1(1.7%) 60 (100.0%) 0 (0.0%) Other marketing costs? (LCU) [integer] 1 distinct value 0:60(100.0%) 60 (100.0%) 0 (0.0%) Estimated Yield (kg/ha) [integer] Mean (sd) : 8763.2 (1628.2)min &le; med &le; max:6300 &le; 8480 &le; 13000IQR (CV) : 2500 (0.2) 25 distinct values 60 (100.0%) 0 (0.0%) Selling price of seed per kg (LCU) [integer] Mean (sd) : 7572.5 (2001.3)min &le; med &le; max:5300 &le; 7000 &le; 13000IQR (CV) : 600 (0.3) 19 distinct values 60 (100.0%) 0 (0.0%) How many kg were sold in the season? [integer] Mean (sd) : 8506.8 (1776.3)min &le; med &le; max:3200 &le; 8200 &le; 12000IQR (CV) : 2850 (0.2) 29 distinct values 60 (100.0%) 0 (0.0%) What was your expected gross margin? [numeric] Mean (sd) : 0.6 (0.1)min &le; med &le; max:0.2 &le; 0.7 &le; 0.8IQR (CV) : 0.1 (0.2) 33 distinct values 60 (100.0%) 0 (0.0%) Total production cost [integer] Mean (sd) : 21138367 (4025039)min &le; med &le; max:12465300 &le; 21671900 &le; 33338000IQR (CV) : 4829735 (0.2) 60 distinct values 60 (100.0%) 0 (0.0%) Gross sales [integer] Mean (sd) : 63491772 (16928812)min &le; med &le; max:28329000 &le; 63660000 &le; 97500000IQR (CV) : 24325000 (0.3) 49 distinct values 60 (100.0%) 0 (0.0%) Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 Recode variable names (see codebook). setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. Note that we create a categorical variable ssd to indicate whether a farmer currently engages in formal seed system distribution. For consistency across countries we also reclassify age into 2 categories &lt; 30 and ≥ 30. setorder(hh, adm1_nm, group, gender) hh[, `:=`( hhid = paste(&quot;VNM&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;VNM&quot;, crop = &quot;rice&quot;, adm1_nm = factor(adm1_nm), group = factor(group, levels=hh[, unique(group)]), gender = factor(gender, levels=c(&quot;Nam&quot;, &quot;Nữ&quot;), labels=c(&quot;Male&quot;, &quot;Female&quot;)), ssd = factor(cert_lcu &gt; 0, levels=c(F, T), labels=c(&quot;Informal&quot;, &quot;Formal&quot;)), age_num = age, age = factor(age &gt;= 30, levels=c(F, T), labels=c(&quot;&lt; 30&quot;, &quot;≥ 30&quot;)), years = factor(member_years &gt;= 5, levels=c(F, T), labels=c(&quot;&lt; 5&quot;, &quot;≥ 5&quot;)) )] Spatial Covariates Using community GPS coordinates we also suggest to enrich this dataset with additional biophysical and geospatial variables, e.g.: Agroecological zone Travel time to nearest market Distance to nearest seed center / company Size of nearest seed center / company Population density Last season total rainfall Last season heat stress days (if any) [pending GPS coordinates] Constructed Variables Farmers report both expected yields yield_ha_kg and actual sales in the last season sales_ha_kg, so we can construct both expected and realized costs in monetary terms costs_exp_ha_lcu and costs_real_ha_lcu. Note that we then use realized sales to calculate profitability metrics. hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, `:=`( # Expected costs costs_exp_ha_lcu = # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + # Per kg costs yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu + mark_kg_lcu), # Realized costs costs_real_ha_lcu = # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + # Per kg costs sales_ha_kg * (labl_kg_lcu + pckg_kg_lcu + mark_kg_lcu) )] Using realized costs and sales, we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as expected output per unit of (expected) input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( sales_exp_ha_lcu = yield_ha_kg * sales_kg_lcu, sales_real_ha_lcu = sales_ha_kg * sales_kg_lcu )][, `:=`( margin_ha_lcu = sales_real_ha_lcu - costs_real_ha_lcu )][, `:=`( # Shares sales_ha_sh = sales_real_ha_lcu / costs_real_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_real_ha_lcu, # PPP$ costs_ha_ppp = costs_real_ha_lcu / xrate, sales_ha_ppp = sales_real_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / (costs_exp_ha_lcu / xrate) )] Below we append some of the information that was recorded at the group level. kbl(group, align=&quot;lccccccc&quot;) Group Established Members Soil Seasons Irrigation Market access Transboundary trade Ta Ben 2001 30 loamy 2.0 good Vicinity to local market, good road to infrastructure No Trung Hiep 2003 8 sandy-silty 2.5 good Vicinity to local market, good road to infrastructure No Vinh Trach 2004 15 clay 3.0 good Vicinity to local market, good road to infrastructure Yes Binh My 2004 8 clay 3.0 good Vicinity to local market, good road to infrastructure Yes Vinh Qui 2002 40 clay 3.0 good Vicinity to local market, good road to infrastructure Yes # Merge hh[group, on=.(group=Group), `:=`( group_year = `Established`, group_size = `Members`, soil_type = `Soil`, seasons = `Seasons`, irrigated = `Irrigation`, market_access = `Market access`, ttrade = `Transboundary trade` )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Labor = labor_ha_lcu, Transport = tran_ha_lcu, Certification = cert_lcu, Labeling = sales_ha_kg * labl_kg_lcu, Packaging = sales_ha_kg * pckg_kg_lcu, Marketing = sales_ha_kg * mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) And we lump all marketing costs into a single category. levels(hh_prod_cost$type) &lt;- levels(hh_prod_cost$type)[c(1,2,3,4,9,9,9,9,9)] hh_prod_cost &lt;- hh_prod_cost[, .( lcu = sum(lcu, na.rm=T) ), by=.(hhid, type) ][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid) ][hh, on=.(hhid), `:=`( # Add categorical variables group = group, gender = gender, age = age, years = years, crop = crop, ssd = ssd )] Note that in the current survey we are missing farm sizes (or planted acreage), so we can not directly study the effect of farm size on the per-unit costs of production and yields, or look at potential scale effects on a farmer’s efficiency and profitability. We can however study whether larger groups might have positive effects. Descriptive Statistics Respondent Characteristics Breakdown by categorical variables. ggplot( hh[, .N, by=.(group, age, gender, crop, years)], aes(axis1=crop, axis2=gender, axis3=age, axis4=years, y=N)) + geom_alluvium(aes(fill=group), width=1/4, alpha=.7, color=&quot;white&quot;) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Crop&quot;, &quot;Gender&quot;, &quot;Age&quot;, &quot;Years in Seed Club&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Categories of Survey Respondents - Vietnam&quot;, subtitle = &quot;Stratified by seed club&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, years in seed club years, and use of formal seed system distribution ssd). Rice in Vietnam is a male-dominated production, hence the absence of female respondents in a few clubs. print(ctable(hh$group, hh$gender, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Gender&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Gender Group Male Female Total Binh My 7 ( 100% ) 0 ( 0% ) 7 ( 100% ) Vinh Qui 10 ( 100% ) 0 ( 0% ) 10 ( 100% ) Vinh Trach 17 ( 94% ) 1 ( 6% ) 18 ( 100% ) Ta Ben 10 ( 77% ) 3 ( 23% ) 13 ( 100% ) Trung Hiep 4 ( 33% ) 8 ( 67% ) 12 ( 100% ) Total 48 ( 80% ) 12 ( 20% ) 60 ( 100% ) &nbsp;&#935;2 = 23.0075&nbsp;&nbsp;&nbsp;df = 4&nbsp;&nbsp;&nbsp;p = .0001 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 print(ctable(hh$group, hh$ssd, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Seed System&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Seed System Group Informal Formal Total Binh My 6 ( 86% ) 1 ( 14% ) 7 ( 100% ) Vinh Qui 10 ( 100% ) 0 ( 0% ) 10 ( 100% ) Vinh Trach 16 ( 89% ) 2 ( 11% ) 18 ( 100% ) Ta Ben 13 ( 100% ) 0 ( 0% ) 13 ( 100% ) Trung Hiep 11 ( 92% ) 1 ( 8% ) 12 ( 100% ) Total 56 ( 93% ) 4 ( 7% ) 60 ( 100% ) &nbsp;&#935;2 = 2.9209&nbsp;&nbsp;&nbsp;df = 4&nbsp;&nbsp;&nbsp;p = .5711 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 print(ctable(hh$group, hh$years, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Years in Seed Club&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Years in Seed Club Group &lt; 5 ≥ 5 Total Binh My 3 ( 43% ) 4 ( 57% ) 7 ( 100% ) Vinh Qui 3 ( 30% ) 7 ( 70% ) 10 ( 100% ) Vinh Trach 8 ( 44% ) 10 ( 56% ) 18 ( 100% ) Ta Ben 0 ( 0% ) 13 ( 100% ) 13 ( 100% ) Trung Hiep 0 ( 0% ) 12 ( 100% ) 12 ( 100% ) Total 14 ( 23% ) 46 ( 77% ) 60 ( 100% ) &nbsp;&#935;2 = 13.8332&nbsp;&nbsp;&nbsp;df = 4&nbsp;&nbsp;&nbsp;p = .0078 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 Seed Production Costs General breakdown and distribution of (realized) input costs across seed clubs, gender, and input type. ttt(costs_ha_ppp ~ group | gender, data=hh, render=fmt, caption=&quot;Total Input Costs in Absolute Terms (PPP$ / ha) - Vietnam&quot;) Total Input Costs in Absolute Terms (PPP$ / ha) - Vietnam group Statistic Male Female Binh My mean 2,913 NA median 3,106 NA sd 642 NA Vinh Qui mean 3,011 NA median 2,950 NA sd 621 NA Vinh Trach mean 2,882 2,520 median 2,938 2,520 sd 442 NA Ta Ben mean 2,817 2,076 median 2,806 2,048 sd 447 235 Trung Hiep mean 2,401 2,961 median 2,437 2,973 sd 685 481 Boxplots with mean comparison p-value and significance levels. Each level is compared to the sample mean. (ns : p &gt; 0.05, * : p ≤ 0.05, ** : p ≤ 0.01, *** = p ≤ 0.001, **** = p ≤ 0.0001) ggBoxTest(hh, aes(gender, costs_ha_ppp, fill=gender, color=gender), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(group, costs_ha_ppp, fill=group, color=group), ref=&quot;.all.&quot;) + facet_wrap(~crop) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Breakdown across categories of farm input. ttt(ppp ~ type | gender, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Gender (PPP$ / ha) - Vietnam&quot;) Input Costs in Absolute Terms by Gender (PPP$ / ha) - Vietnam type Statistic Male Female Seeds mean 281 228 median 270 220 sd 91 34 Fertilizer mean 613 517 median 592 496 sd 179 161 Pesticides mean 748 827 median 690 718 sd 385 384 Labor mean 1,203 1,128 median 1,136 1,167 sd 391 205 Marketing mean 14 3 median 0 0 sd 49 12 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(gender, ssd, type)] ggplot(tbl, aes(gender, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~ssd) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Vietnam&quot;, subtitle=&quot;Stratified by gender and seed system&quot;) + theme_def(legend.position=&quot;right&quot;) ttt(ppp ~ type | years, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Years in Seed Group (PPP$ / ha) - Vietnam&quot;) Input Costs in Absolute Terms by Years in Seed Group (PPP$ / ha) - Vietnam type Statistic ≥ 5 Seeds mean 284 267 median 287 259 sd 64 91 Fertilizer mean 648 578 median 616 538 sd 183 176 Pesticides mean 810 750 median 721 680 sd 363 391 Labor mean 1,147 1,200 median 1,080 1,167 sd 406 351 Marketing mean 0 15 median 0 0 sd 0 50 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(years, crop, type)] ggplot(tbl, aes(years, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Vietnam&quot;, subtitle=&quot;Stratified by crop and years in seed club&quot;) + theme_def(legend.position=&quot;right&quot;) ttt(ppp ~ type | ssd, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Seed System Type (PPP$ / ha) - Vietnam&quot;) Input Costs in Absolute Terms by Seed System Type (PPP$ / ha) - Vietnam type Statistic Informal Formal Seeds mean 265 347 median 261 311 sd 80 132 Fertilizer mean 597 551 median 563 507 sd 179 196 Pesticides mean 781 531 median 697 486 sd 384 322 Labor mean 1,167 1,480 median 1,123 1,452 sd 359 277 Marketing mean 2 149 median 0 168 sd 14 88 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(crop, group, type)] ggplot(tbl, aes(group, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;right&quot;) Are there significant differences across groups? We first compare input cost shares across gender, then across seed clubs. ggBoxTest(hh_prod_cost, aes(type, share, fill=gender, color=gender), grp.c=aes(group=type), grp.s=aes(group=gender)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (Percent of Total Costs by Ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh_prod_cost, aes(type, share, fill=group, color=group), grp.c=aes(group=type), grp.s=aes(group=group)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures (expected seed yields and sales) across groups. ttt(yield_ha_kg ~ group | gender+crop, data=hh, render=fmt, caption=&quot;Expected Rice Seed Yield (kg / ha) - Vietnam&quot;) Expected Rice Seed Yield (kg / ha) - Vietnam group Statistic rice Male Female Binh My mean 8,272 NA median 8,400 NA sd 1,325 NA Vinh Qui mean 9,850 NA median 10,250 NA sd 1,717 NA Vinh Trach mean 8,709 9,000 median 8,460 9,000 sd 1,883 NA Ta Ben mean 9,770 7,467 median 10,000 7,700 sd 1,113 404 Trung Hiep mean 7,182 7,938 median 7,250 7,750 sd 623 904 ttt(sales_ha_kg ~ group | gender+crop, data=hh, render=fmt, caption=&quot;Seed Sales (kg / ha) - Vietnam&quot;) Seed Sales (kg / ha) - Vietnam group Statistic rice Male Female Binh My mean 8,272 NA median 8,400 NA sd 1,325 NA Vinh Qui mean 9,620 NA median 10,250 NA sd 2,040 NA Vinh Trach mean 8,155 9,000 median 8,000 9,000 sd 1,788 NA Ta Ben mean 9,770 7,313 median 10,000 7,238 sd 1,113 356 Trung Hiep mean 6,382 7,938 median 7,250 7,750 sd 2,149 904 ttt(yield_ha_kg ~ group | years+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Vietnam&quot;) Realized Seed Sales (kg / ha) - Vietnam group Statistic rice ≥ 5 Binh My mean 6,948 9,265 median 6,923 9,330 sd 45 666 Vinh Qui mean 7,833 10,714 median 8,000 11,000 sd 289 1,220 Vinh Trach mean 8,850 8,626 median 9,100 8,230 sd 1,842 1,911 Ta Ben mean NA 9,238 median NA 9,300 sd NA 1,406 Trung Hiep mean NA 7,686 median NA 7,500 sd NA 874 ttt(sales_ha_kg ~ group | years+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Vietnam&quot;) Realized Seed Sales (kg / ha) - Vietnam group Statistic rice ≥ 5 Binh My mean 6,948 9,265 median 6,923 9,330 sd 45 666 Vinh Qui mean 7,833 10,386 median 8,000 11,000 sd 289 1,984 Vinh Trach mean 8,850 7,683 median 9,100 7,600 sd 1,842 1,565 Ta Ben mean NA 9,203 median NA 9,300 sd NA 1,453 Trung Hiep mean NA 7,419 median NA 7,500 sd NA 1,538 Differences in efficiency measures across gender with mean comparison (Wilcoxon) p-value. ggBoxTest(hh, aes(gender, yield_ha_kg, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Rice Seed Yield (kg / ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(gender, sales_ha_ppp, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) Differences in efficiency measures by years in seed club with mean comparison (Wilcoxon) p-value. ggBoxTest(hh, aes(years, yield_ha_kg, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Seed Yield (kg / ha) - Vietnam&quot;, subtitle=&quot;Stratified by years in seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(years, sales_ha_ppp, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by years in seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Differences in efficiency measures across seed clubs with global ANOVA p-value. ggBoxTest(hh, aes(group, yield_ha_kg, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Rice Seed Yield (Kg / ha) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(group, sales_ha_ppp, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. Note that Farmer VNM013 in Winh Qui has total costs over PPP$ 4,000/ha. He was excluded from the approximated curves below. outlier &lt;- hh[costs_ha_ppp &gt; mean(costs_ha_ppp) + 3*sd(costs_ha_ppp), hhid] kbl( caption=&quot;Farmers with total input costs &gt; mean + 3*sd&quot;, hh[hhid %in% outlier, .(hhid, group, crop, yield_ha_kg, costs_ha_ppp)], format.args=list(big.mark=&quot;,&quot;, digits=0)) Tab. 2: Farmers with total input costs &gt; mean + 3*sd hhid group crop yield_ha_kg costs_ha_ppp VNM013 Vinh Qui rice 7,500 4,461 ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Vietnam&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~gender, scales=&quot;free_x&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Vietnam&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=group, fill=group), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~group) + coord_cartesian(ylim=c(4000, 14000)) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Vietnam&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) Profitability Farmers’ gross profit margins by gender and years in seed club. ttt(margin_ha_ppp ~ group | gender+years, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Vietnam&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Vietnam group Statistic ≥ 5 Male Female Male Female Binh My mean 2,971 NA 4,491 NA median 3,427 NA 4,074 NA sd 869 NA 1,398 NA Vinh Qui mean 3,773 NA 6,610 NA median 4,144 NA 6,768 NA sd 1,072 NA 1,548 NA Vinh Trach mean 4,889 6,391 3,946 NA median 5,405 6,391 4,133 NA sd 1,968 NA 1,940 NA Ta Ben mean NA NA 6,627 5,003 median NA NA 6,600 4,828 sd NA NA 925 596 Trung Hiep mean NA NA 7,084 8,235 median NA NA 7,648 8,665 sd NA NA 2,657 1,947 ttt(margin_ha_sh ~ group | gender+years, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of total input costs) - Vietnam&quot;) Mean Gross Profit Margin in Relative Terms (% of total input costs) - Vietnam group Statistic ≥ 5 Male Female Male Female Binh My mean 127% NA 153% NA median 116% NA 130% NA sd 74% NA 73% NA Vinh Qui mean 136% NA 222% NA median 163% NA 220% NA sd 69% NA 41% NA Vinh Trach mean 162% 254% 148% NA median 169% 254% 152% NA sd 49% NA 87% NA Ta Ben mean NA NA 240% 245% median NA NA 222% 236% sd NA NA 48% 56% Trung Hiep mean NA NA 304% 285% median NA NA 256% 249% sd NA NA 136% 91% ggplot(hh, aes(x=hhid, color=group)) + geom_hline(aes(yintercept=0), color=1) + geom_linerange(aes(ymin=0, ymax=margin_ha_ppp), size=.6) + geom_point(aes(y=0), shape=20, size=1.4) + geom_point(aes(y=margin_ha_ppp, shape=margin_ha_ppp &lt; 0, fill=group), size=1.4) + scale_y_continuous(labels=comma) + scale_shape_manual(values=24:25) + guides(x=&quot;none&quot;, shape=&quot;none&quot;) + labs(x=NULL, y=NULL, color=&quot;&quot;, fill=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Vietnam&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def( legend.position=&quot;right&quot;, panel.grid.major.x=element_blank() ) Farmers’ gross profit margins by gender and across seed clubs in both absolute terms and in relative terms as percentage of total input costs per hectare. ggBoxTest(hh, aes(gender, margin_ha_ppp, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Vietnam&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(gender, margin_ha_sh, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Vietnam&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(years, margin_ha_ppp, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Vietnam&quot;, subtitle=&quot;Stratified by years in seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(years, margin_ha_sh, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Vietnam&quot;, subtitle=&quot;Stratified by years in seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(group, margin_ha_ppp, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Vietnam&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(group, margin_ha_sh, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Vietnam&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(member_years, margin_ha_ppp)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20) + scale_x_continuous(limits=c(0, 22)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms vs. Years in Seed Club - Vietnam&quot;, subtitle=&quot;Each point is a respondent (years vs. PPP$)&quot;) + theme_def(legend.position=&quot;top&quot;) Correlation Significant pairwise associations. ggpairs( hh[, .(`seed club`=group, `age`=age_num, `years in club`=member_years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:5], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:5], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:5], alpha=.8)), title=&quot;Correlogram stratified by seed club - Vietnam&quot; ) + theme_def( strip.text=element_text(hjust=.5), axis.text.x=element_text(angle=-45), panel.grid.major=element_blank() ) ggpairs( hh[, .(gender, `age`=age_num, `years in club`=member_years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by gender - Vietnam&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) ggpairs( hh[, .(`years in club`=years, `age`=age_num, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by years in seed club - Vietnam&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) saveRDS(hh, &quot;../tmp/data_vnm.rds&quot;) "],["02.html", "Niger Survey Recodes Descriptive Statistics Correlation", " Niger Notes: 1 Int’l $ = 257.60 XOF (CFA) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) Focus crop = cowpea and millet All costs are reported per hectare. Inspection, certification and other marketing costs are assumed for the entire farm. Labeling and packaging are per kg. Some farmers grow multiple crops Survey Recodes xrate &lt;- 257.60 # Load respondent data hh &lt;- fread(&quot;../data/nre/hh.csv&quot;) group &lt;- fread(&quot;../data/nre/group.csv&quot;) There are 24 variables and 80 observations in this set. A summary is shown below. print(dfSummary(hh), max.tbl.height=500, table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Variable Stats / Values Freqs (% of Valid) Graph Valid Missing Code [character] 1. Chadakori_MI_FG12. Chadakori_MI_FG23. Chadakori_NI_FG14. Chadakori_NI_FG25. Sabon_Machi_MI_FG16. Sabon_Machi_MI_FG27. Sabon_Machi_NI_FG18. Sabon_Machi_NI_FG2 10(12.5%)10(12.5%)10(12.5%)10(12.5%)10(12.5%)10(12.5%)10(12.5%)10(12.5%) 80 (100.0%) 0 (0.0%) Group [character] 1. Boukassa_Noma2. Cigaban_Matta3. HIMMA4. Yada_Iri 10(12.5%)10(12.5%)40(50.0%)20(25.0%) 80 (100.0%) 0 (0.0%) Crop [character] 1. cowpea2. millet 40(50.0%)40(50.0%) 80 (100.0%) 0 (0.0%) District [character] 1. Dakoro2. Guidan Roumdji 40(50.0%)40(50.0%) 80 (100.0%) 0 (0.0%) Location [character] 1. Chadakori2. Sabon Machi 40(50.0%)40(50.0%) 80 (100.0%) 0 (0.0%) Date [IDate, Date] 1. 2021-04-282. 2021-04-30 40(50.0%)40(50.0%) 80 (100.0%) 0 (0.0%) Age [character] 1. 15-292. 30+ 9(11.2%)71(88.8%) 80 (100.0%) 0 (0.0%) Sex [character] 1. female2. male 32(40.0%)48(60.0%) 80 (100.0%) 0 (0.0%) Cost seed per ha (LCU) [integer] Mean (sd) : 7136.9 (5225.8)min &le; med &le; max:1200 &le; 5000 &le; 25000IQR (CV) : 6000 (0.7) 30 distinct values 80 (100.0%) 0 (0.0%) Cost of fertilizer per ha (LCU) [integer] Mean (sd) : 27441.9 (14019.1)min &le; med &le; max:0 &le; 31250 &le; 75000IQR (CV) : 18000 (0.5) 35 distinct values 80 (100.0%) 0 (0.0%) Cost of pesticide per ha (LCU) [integer] Mean (sd) : 6648.1 (8051.2)min &le; med &le; max:0 &le; 3000 &le; 36000IQR (CV) : 9500 (1.2) 29 distinct values 80 (100.0%) 0 (0.0%) Cost of transport per ha (LCU) [integer] Mean (sd) : 5822.8 (4742.9)min &le; med &le; max:0 &le; 5000 &le; 25000IQR (CV) : 3187.5 (0.8) 25 distinct values 80 (100.0%) 0 (0.0%) Labor cost (LCU) [integer] Mean (sd) : 35362.5 (20947.8)min &le; med &le; max:0 &le; 30000 &le; 95000IQR (CV) : 28500 (0.6) 41 distinct values 80 (100.0%) 0 (0.0%) Inspection / certification Fees (LCU) [integer] Mean (sd) : 2031.2 (2028.8)min &le; med &le; max:0 &le; 2000 &le; 10000IQR (CV) : 3000 (1) 0:31(38.8%)500:1(1.2%)1000:1(1.2%)1500:4(5.0%)2000:5(6.2%)3000:25(31.2%)5000:12(15.0%)10000:1(1.2%) 80 (100.0%) 0 (0.0%) Labelling costs per kg (LCU) [integer] Mean (sd) : 123.9 (232.1)min &le; med &le; max:0 &le; 0 &le; 1400IQR (CV) : 131.2 (1.9) 13 distinct values 80 (100.0%) 0 (0.0%) Packaging costs per kg (LCU) [integer] Mean (sd) : 98.2 (100.3)min &le; med &le; max:0 &le; 100 &le; 500IQR (CV) : 112 (1) 22 distinct values 80 (100.0%) 0 (0.0%) Other marketing costs? (LCU) [integer] Mean (sd) : 931.2 (3474.8)min &le; med &le; max:0 &le; 0 &le; 30000IQR (CV) : 1000 (3.7) 0:58(72.5%)1000:6(7.5%)1500:4(5.0%)2000:4(5.0%)2500:1(1.2%)3000:4(5.0%)5000:2(2.5%)30000:1(1.2%) 80 (100.0%) 0 (0.0%) Estimated Yield (kg/ha) [integer] Mean (sd) : 684.6 (280)min &le; med &le; max:100 &le; 700 &le; 1500IQR (CV) : 300 (0.4) 19 distinct values 80 (100.0%) 0 (0.0%) Selling price of seed per kg (LCU) [integer] Mean (sd) : 825 (354.2)min &le; med &le; max:200 &le; 800 &le; 1500IQR (CV) : 500 (0.4) 200:1(1.2%)250:4(5.0%)300:1(1.2%)350:1(1.2%)500:21(26.2%)750:11(13.8%)800:3(3.8%)1000:28(35.0%)1500:10(12.5%) 80 (100.0%) 0 (0.0%) Selling price of grain per kg (LCU) at sowing [integer] Mean (sd) : 419.4 (216.8)min &le; med &le; max:200 &le; 362.5 &le; 1200IQR (CV) : 250 (0.5) 16 distinct values 80 (100.0%) 0 (0.0%) Selling price of grain per kg (LCU) at harvest [integer] Mean (sd) : 245.9 (189.5)min &le; med &le; max:100 &le; 150 &le; 1000IQR (CV) : 167 (0.8) 17 distinct values 80 (100.0%) 0 (0.0%) How many kg were sold in the season? [integer] Mean (sd) : 353.4 (289.8)min &le; med &le; max:0 &le; 300 &le; 1500IQR (CV) : 385 (0.8) 22 distinct values 80 (100.0%) 0 (0.0%) What was your expected gross margin? [integer] Mean (sd) : 137489.4 (145046.5)min &le; med &le; max:50 &le; 73500 &le; 5e+05IQR (CV) : 180000 (1.1) 36 distinct values 80 (100.0%) 0 (0.0%) How long have you been a member of this group? [integer] Mean (sd) : 11.9 (7.9)min &le; med &le; max:1 &le; 11 &le; 23IQR (CV) : 15 (0.7) 18 distinct values 80 (100.0%) 0 (0.0%) Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. setorder(hh, adm2_nm, adm3_nm, group, gender, crop) hh[, `:=`( hhid = paste(&quot;NRE&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;NRE&quot;, crop = factor(crop), adm2_nm = factor(adm2_nm), adm3_nm = factor(adm3_nm), group = factor(group, levels=c( &quot;Boukassa_Noma&quot;, &quot;Cigaban_Matta&quot;, &quot;Yada_Iri&quot;, &quot;HIMMA&quot; ), labels=c( &quot;Boukassa Noma&quot;, &quot;Cigaban Matta&quot;, &quot;Yada Iri&quot;, &quot;Himma&quot; )), gender = factor(gender, levels=c(&quot;male&quot;, &quot;female&quot;), labels=c(&quot;Male&quot;, &quot;Female&quot;)), age = factor(age, levels=c(&quot;15-29&quot;, &quot;30+&quot;), labels=c(&quot;&lt; 30&quot;, &quot;≥ 30&quot;)), years = factor(member_years &gt;= 5, levels=c(F, T), labels=c(&quot;&lt; 5&quot;, &quot;≥ 5&quot;)) )] Constructed Variables Farmers report both expected yields yield_ha_kg and actual sales in the last season sales_ha_kg, so we can construct both expected and realized costs in monetary terms costs_exp_ha_lcu and costs_real_ha_lcu. Note that we then use realized sales to calculate profitability metrics. We assume that in Niger marketing costs for both cowpea and millet are reported for the entire farm (not by kg as in Vietnam). hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, `:=`( # Expected costs costs_exp_ha_lcu = # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu), # Realized costs costs_real_ha_lcu = # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs sales_ha_kg * (labl_kg_lcu + pckg_kg_lcu) )] hh[, summary(costs_exp_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 21100 90719 172200 242594 299875 896000 hh[, summary(costs_real_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 21100 71775 126550 161174 186500 729500 Using realized costs and sales, we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as expected output per unit of (expected) input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( sales_exp_ha_lcu = yield_ha_kg * sales_kg_lcu, sales_real_ha_lcu = sales_ha_kg * sales_kg_lcu )][, `:=`( margin_ha_lcu = sales_real_ha_lcu - costs_real_ha_lcu )][, `:=`( # Shares sales_ha_sh = sales_real_ha_lcu / costs_real_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_real_ha_lcu, # PPP$ costs_ha_ppp = costs_real_ha_lcu / xrate, sales_ha_ppp = sales_real_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / (costs_exp_ha_lcu / xrate) )] Note that 6 respondents indicate having no sales (and hence a negative gross margin) this past season (crop failure or decision not to sell?). tmp &lt;- hh[sales_ha_kg==0, .( hhid, code, group, crop, sales_exp_ha_lcu, sales_real_ha_lcu, margin_ha_lcu, yield_ha_kg)] kbl( setnames(tmp, lbl[data.table(code=names(tmp)), on=.(code), label]), format.args=list(big.mark=&quot;,&quot;)) Unique farmer/crop ID Code Group Crop Gross sales Gross sales per ha (realized yield) Gross margin per ha Estimated Yield (kg/ha) NRE042 Chadakori_MI_FG1 Boukassa Noma millet 375,000 0 -28,200 1,500 NRE046 Chadakori_MI_FG1 Boukassa Noma millet 300,000 0 -88,250 1,000 NRE047 Chadakori_MI_FG1 Boukassa Noma millet 25,000 0 -21,900 100 NRE056 Chadakori_MI_FG2 Cigaban Matta millet 250,000 0 -75,000 500 NRE074 Chadakori_NI_FG2 Yada Iri cowpea 400,000 0 -94,000 800 NRE076 Chadakori_NI_FG2 Yada Iri cowpea 1,200,000 0 -134,000 800 Below we append some of the information that was recorded at the group level. # Same recodes in the group-level dataset group[, Group := factor(Group, levels=c( &quot;Boukassa Noma&quot;, &quot;Cigaban Matta&quot;, &quot;Yada Iri&quot;, &quot;HIMMA&quot; ), labels=c( &quot;Boukassa Noma&quot;, &quot;Cigaban Matta&quot;, &quot;Yada Iri&quot;, &quot;Himma&quot; ))] # Merge hh[group, on=.(group=Group), `:=`( group_year = `Established`, group_size = `Members`, seasons = `Seasons`, irrigated = `Irrigation`, market_access = `Market access`, ttrade = `Transboundary trade` )] kbl(group, align=&quot;lllllc&quot;) Group Region Department Commune Location Market access Irrigation Seasons Transboundary trade Members Established Boukassa Noma Maradi Guidan Roumdji Chadakori Kouroungoussaou – – 1 Yes 56 1998 Yada Iri Maradi Guidan Roumdji Chadakori Chadakori – – 1 No 80 1998 Cigaban Matta Maradi Guidan Roumdji Chadakori Chadakori – – 1 No 33 1998 Himma Maradi Dakoro Sabon Machi Sabon Machi – – 1 Yes 44 1999 Finally we normalize all cost line items into a “long” table hh_prod_cost for charting. Again we use farmers’ realized costs here. # Normalize production cost table per ha hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Labor = labor_ha_lcu, Transport = tran_ha_lcu, Certification = cert_lcu, Labeling = sales_ha_kg * labl_kg_lcu, Packaging = sales_ha_kg * pckg_kg_lcu, Marketing = mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) And we lump all marketing costs into a single category. levels(hh_prod_cost$type) &lt;- levels(hh_prod_cost$type)[c(1,2,3,4,9,9,9,9,9)] hh_prod_cost &lt;- hh_prod_cost[, .( lcu = sum(lcu, na.rm=T) ), by=.(hhid, type) ][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid) ][hh, on=.(hhid), `:=`( # Add classes group = group, gender = gender, age = age, years = years, crop = crop )] Descriptive Statistics Respondent Characteristics Breakdown by categorical variables. Note that farmers in HIMMA grow both crops. ggplot( hh[, .N, by=.(group, age, gender, crop, years)], aes(axis1=crop, axis2=gender, axis3=age, axis4=years, y=N)) + geom_alluvium(aes(fill=group), width=1/4, alpha=.7, color=&quot;white&quot;) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Crop&quot;, &quot;Gender&quot;, &quot;Age&quot;, &quot;Years in Seed Club&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Categories of Survey Respondents - Niger&quot;, subtitle = &quot;Stratified by seed club&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, age age, and years in seed club years). print(ctable(hh$group, hh$gender, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Gender&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Gender Group Male Female Total Boukassa Noma 6 ( 60% ) 4 ( 40% ) 10 ( 100% ) Cigaban Matta 8 ( 80% ) 2 ( 20% ) 10 ( 100% ) Yada Iri 15 ( 75% ) 5 ( 25% ) 20 ( 100% ) Himma 19 ( 48% ) 21 ( 52% ) 40 ( 100% ) Total 48 ( 60% ) 32 ( 40% ) 80 ( 100% ) &nbsp;&#935;2 = 6.1458&nbsp;&nbsp;&nbsp;df = 3&nbsp;&nbsp;&nbsp;p = .1047 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 print(ctable(hh$group, hh$age, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Age&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Age Group &lt; 30 ≥ 30 Total Boukassa Noma 1 ( 10% ) 9 ( 90% ) 10 ( 100% ) Cigaban Matta 0 ( 0% ) 10 ( 100% ) 10 ( 100% ) Yada Iri 0 ( 0% ) 20 ( 100% ) 20 ( 100% ) Himma 8 ( 20% ) 32 ( 80% ) 40 ( 100% ) Total 9 ( 11% ) 71 ( 89% ) 80 ( 100% ) &nbsp;&#935;2 = 6.8858&nbsp;&nbsp;&nbsp;df = 3&nbsp;&nbsp;&nbsp;p = .0756 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 print(ctable(hh$group, hh$years, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Years in Seed Club&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Years in Seed Club Group &lt; 5 ≥ 5 Total Boukassa Noma 5 ( 50% ) 5 ( 50% ) 10 ( 100% ) Cigaban Matta 4 ( 40% ) 6 ( 60% ) 10 ( 100% ) Yada Iri 3 ( 15% ) 17 ( 85% ) 20 ( 100% ) Himma 5 ( 12% ) 35 ( 88% ) 40 ( 100% ) Total 17 ( 21% ) 63 ( 79% ) 80 ( 100% ) &nbsp;&#935;2 = 9.3371&nbsp;&nbsp;&nbsp;df = 3&nbsp;&nbsp;&nbsp;p = .0251 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 Seed Production Costs General breakdown and distribution of input costs across seed clubs, gender, years in seed club, and input type. ttt(costs_ha_ppp ~ group | gender+years, data=hh, render=fmt, caption=&quot;Total Input Costs in Absolute Terms (PPP$ / ha) - Niger&quot;) Total Input Costs in Absolute Terms (PPP$ / ha) - Niger group Statistic ≥ 5 Male Female Male Female Boukassa Noma mean 1,112 1,102 1,177 674 median 901 1,102 613 674 sd 894 1,414 1,458 798 Cigaban Matta mean 219 250 322 149 median 231 250 291 149 sd 30 NA 107 NA Yada Iri mean 356 404 724 628 median 356 404 599 481 sd 209 NA 547 309 Himma mean 696 402 806 418 median 696 379 728 307 sd NA 262 356 342 Boxplots with mean comparison p-value and significance levels. When more than two levels, each level is compared to the group mean. (ns : p &gt; 0.05, * : p ≤ 0.05, ** : p ≤ 0.01, *** = p ≤ 0.001, **** = p ≤ 0.0001) ggBoxTest(hh, aes(crop, costs_ha_ppp, color=gender, fill=gender), grp.c=aes(group=crop), grp.s=aes(group=gender)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh, aes(crop, costs_ha_ppp, color=group, fill=group), grp.c=aes(group=crop), grp.s=aes(group=group)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by crop&quot;) + theme_def(legend.position=&quot;top&quot;) Breakdown across categories of farm input. ttt(ppp ~ type | gender+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Gender (PPP$ / ha) - Niger&quot;) Input Costs in Absolute Terms by Gender (PPP$ / ha) - Niger type Statistic cowpea millet Male Female Male Female Seeds mean 35 36 26 14 median 35 23 17 12 sd 18 24 24 7 Fertilizer mean 113 112 132 71 median 136 140 130 68 sd 40 40 68 51 Pesticides mean 50 41 5 4 median 47 27 4 2 sd 32 32 4 5 Labor mean 185 152 108 90 median 155 116 103 78 sd 87 87 55 50 Marketing mean 349 250 426 253 median 218 148 31 41 sd 385 251 686 501 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(gender, crop, type)] ggplot(tbl, aes(gender, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Niger&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;right&quot;) ttt(ppp ~ type | years+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Years in Seed Group (PPP$ / ha) - Niger&quot;) Input Costs in Absolute Terms by Years in Seed Group (PPP$ / ha) - Niger type Statistic cowpea millet ≥ 5 ≥ 5 Seeds mean 25 37 12 23 median 22 35 12 13 sd 12 20 4 21 Fertilizer mean 92 116 90 104 median 97 140 70 116 sd 55 36 64 68 Pesticides mean 38 49 5 4 median 29 49 4 3 sd 28 33 4 5 Labor mean 147 181 94 100 median 164 155 82 78 sd 86 87 49 55 Marketing mean 205 342 418 303 median 114 198 23 76 sd 195 372 764 530 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(years, crop, type)] ggplot(tbl, aes(years, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Niger&quot;, subtitle=&quot;Stratified by crop and years in seed club&quot;) + theme_def(legend.position=&quot;right&quot;) ttt(ppp ~ type | group+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Niger&quot;) Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Niger type Statistic cowpea millet Yada Iri Himma Boukassa Noma Cigaban Matta Himma Seeds mean 32 40 20 13 23 median 31 35 12 12 12 sd 13 24 18 6 22 Fertilizer mean 124 101 101 118 91 median 140 110 66 125 107 sd 33 43 103 47 52 Pesticides mean 29 65 4 5 4 median 21 64 4 4 3 sd 20 32 1 6 5 Labor mean 147 205 104 85 102 median 150 204 96 71 78 sd 69 94 50 41 59 Marketing mean 321 323 812 45 241 median 176 246 433 23 82 sd 435 256 935 70 369 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(group, crop, type)] ggplot(tbl, aes(group, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Niger&quot;, subtitle=&quot;Stratified by crop and seed club&quot;) + theme_def(legend.position=&quot;right&quot;) Are there significant differences across groups? We first compare input cost shares across gender, then across seed clubs. ggBoxTest(hh_prod_cost, aes(type, share, color=gender, fill=gender), grp.c=aes(group=type), grp.s=aes(group=gender)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (Percent of Total Costs by Ha) - Niger&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh_prod_cost, aes(type, share, color=years, fill=years), grp.c=aes(group=type), grp.s=aes(group=years)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (Percent of Total Costs by Ha) - Niger&quot;, subtitle=&quot;Stratified by crop and years in seed club&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh_prod_cost, aes(type, share, color=group, fill=group), grp.c=aes(group=type), grp.s=aes(group=group)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Niger&quot;, subtitle=&quot;Stratified by crop and seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Differences between the 2 crops. ggBoxTest(hh_prod_cost, aes(type, share, color=crop, fill=crop), grp.c=aes(group=type), grp.s=aes(group=crop)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Niger&quot;, subtitle=&quot;Stratified by crop&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures (expected seed yields and actual sales) across groups. ttt(yield_ha_kg ~ group | gender+crop, data=hh, render=fmt, caption=&quot;Expected Seed Yield (kg / ha) - Niger&quot;) Expected Seed Yield (kg / ha) - Niger group Statistic cowpea millet Male Female Male Female Boukassa Noma mean NA NA 850 838 median NA NA 900 850 sd NA NA 459 565 Cigaban Matta mean NA NA 688 340 median NA NA 700 340 sd NA NA 236 198 Yada Iri mean 562 620 NA NA median 800 600 NA NA sd 279 179 NA NA Himma mean 693 583 990 697 median 700 600 1,000 700 sd 169 214 256 170 ttt(sales_ha_kg ~ group | gender+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Niger&quot;) Realized Seed Sales (kg / ha) - Niger group Statistic cowpea millet Male Female Male Female Boukassa Noma mean NA NA 433 251 median NA NA 400 252 sd NA NA 427 288 Cigaban Matta mean NA NA 319 170 median NA NA 300 170 sd NA NA 181 99 Yada Iri mean 351 280 NA NA median 250 300 NA NA sd 389 110 NA NA Himma mean 536 334 293 276 median 550 250 250 300 sd 265 355 209 205 ttt(yield_ha_kg ~ group | years+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Niger&quot;) Realized Seed Sales (kg / ha) - Niger group Statistic cowpea millet ≥ 5 ≥ 5 Boukassa Noma mean NA NA 670 1,020 median NA NA 700 1,000 sd NA NA 315 572 Cigaban Matta mean NA NA 620 617 median NA NA 650 600 sd NA NA 105 343 Yada Iri mean 467 596 NA NA median 400 800 NA NA sd 306 250 NA NA Himma mean 433 700 850 762 median 400 700 850 700 sd 58 170 71 239 ttt(sales_ha_kg ~ group | years+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Niger&quot;) Realized Seed Sales (kg / ha) - Niger group Statistic cowpea millet ≥ 5 ≥ 5 Boukassa Noma mean NA NA 381 340 median NA NA 500 200 sd NA NA 363 422 Cigaban Matta mean NA NA 298 283 median NA NA 300 250 sd NA NA 45 232 Yada Iri mean 167 363 NA NA median 100 300 NA NA sd 115 359 NA NA Himma mean 367 494 300 278 median 400 500 300 275 sd 58 322 141 209 Differences in efficiency measures across gender with mean comparison (Wilcoxon) p-value. ggBoxTest(hh, aes(gender, yield_ha_kg, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Seed Yield (kg / ha) - Niger&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(gender, sales_ha_ppp, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) Differences in efficiency measures by years in seed club with mean comparison (Wilcoxon) p-value. ggBoxTest(hh, aes(years, yield_ha_kg, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Seed Yield (kg / ha) - Niger&quot;, subtitle=&quot;Stratified crop and by years in seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(years, sales_ha_ppp, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified crop and by years in seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Differences in efficiency measures across seed clubs with global ANOVA p-value. ggBoxTest(hh, aes(group, yield_ha_kg, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Seed Yield (Kg / ha) - Niger&quot;, subtitle=&quot;Stratified by crop and seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(group, sales_ha_ppp, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Niger&quot;, subtitle=&quot;Stratified crop and by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. Note that in the approximated curves below we remove outliers with total input costs over PPP$ 2,000 per ha. outlier &lt;- hh[costs_ha_ppp &gt; mean(costs_ha_ppp) + 3*sd(costs_ha_ppp), hhid] kbl( caption=&quot;Farmers with total input costs &gt; mean + 3*sd&quot;, hh[hhid %in% outlier, .(hhid, group, crop, yield_ha_kg, costs_ha_ppp)], format.args=list(big.mark=&quot;,&quot;, digits=0)) Tab. 3: Farmers with total input costs &gt; mean + 3*sd hhid group crop yield_ha_kg costs_ha_ppp NRE048 Boukassa Noma millet 1,000 2,832 NRE080 Yada Iri cowpea 800 2,463 ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Niger&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(aes(color=gender, fill=gender), size=.8, level=.9) + geom_point(alpha=.7, shape=20) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, color=&quot;&quot;, fill=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Niger&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;top&quot;) Profitability Farmers’ gross profit margins by gender and years in seed club. ttt(margin_ha_ppp ~ group+crop | gender+years, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Niger&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Niger group crop Statistic ≥ 5 Male Female Male Female Boukassa Noma millet mean 311 -130 376 54 median 263 -130 163 54 sd 679 44 597 231 Cigaban Matta millet mean 723 216 629 45 median 701 216 386 45 sd 49 NA 796 NA Yada Iri cowpea mean 130 -16 427 779 median 130 -16 372 701 sd 72 NA 848 188 Himma cowpea mean 80 1,031 1,099 511 median 80 1,031 730 313 sd NA 263 1,088 903 millet mean NA 687 192 398 median NA 687 430 349 sd NA 1,021 433 760 ttt(margin_ha_sh ~ group+crop | gender+years, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Niger&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Niger group crop Statistic ≥ 5 Male Female Male Female Boukassa Noma millet mean -7% -53% -12% -41% median 29% -53% 27% -41% sd 81% 64% 76% 83% Cigaban Matta millet mean 333% 86% 176% 30% median 323% 86% 197% 30% sd 36% NA 189% NA Yada Iri cowpea mean 51% -4% 55% 144% median 51% -4% 46% 151% sd 50% NA 139% 64% Himma cowpea mean 11% 175% 140% 52% median 11% 175% 97% 51% sd NA 78% 145% 136% millet mean NA 483% 21% 252% median NA 483% 30% 190% sd NA 704% 86% 323% Note that 24 respondents show negative margins. kbl(caption=&quot;Respondents with negative gross margins.&quot;, hh[margin_ha_ppp &lt; 0, .(hhid, code, group, crop, costs_ha_ppp, yield_ha_kg, sales_ha_kg, margin_ha_ppp)], format.args=list(big.mark=&quot;,&quot;, digits=1)) Tab. 4: Respondents with negative gross margins. hhid code group crop costs_ha_ppp yield_ha_kg sales_ha_kg margin_ha_ppp NRE003 Sabon_Machi_NI_FG1 Himma cowpea 437 700 100 -146 NRE004 Sabon_Machi_NI_FG2 Himma cowpea 280 800 6 -257 NRE007 Sabon_Machi_MI_FG1 Himma millet 229 800 200 -35 NRE008 Sabon_Machi_MI_FG1 Himma millet 487 700 60 -254 NRE009 Sabon_Machi_MI_FG1 Himma millet 490 800 80 -334 NRE010 Sabon_Machi_MI_FG1 Himma millet 551 700 80 -241 NRE011 Sabon_Machi_MI_FG1 Himma millet 326 600 20 -307 NRE016 Sabon_Machi_MI_FG2 Himma millet 1,279 420 250 -793 NRE026 Sabon_Machi_NI_FG1 Himma cowpea 631 800 200 -10 NRE031 Sabon_Machi_NI_FG2 Himma cowpea 571 700 100 -280 NRE038 Sabon_Machi_MI_FG1 Himma millet 736 800 200 -347 NRE039 Sabon_Machi_MI_FG1 Himma millet 269 750 13 -193 NRE042 Chadakori_MI_FG1 Boukassa Noma millet 109 1,500 0 -109 NRE043 Chadakori_MI_FG1 Boukassa Noma millet 102 150 3 -99 NRE044 Chadakori_MI_FG1 Boukassa Noma millet 2,102 700 500 -161 NRE046 Chadakori_MI_FG1 Boukassa Noma millet 343 1,000 0 -343 NRE047 Chadakori_MI_FG1 Boukassa Noma millet 85 100 0 -85 NRE056 Chadakori_MI_FG2 Cigaban Matta millet 291 500 0 -291 NRE063 Chadakori_NI_FG1 Yada Iri cowpea 404 800 100 -16 NRE074 Chadakori_NI_FG2 Yada Iri cowpea 365 800 0 -365 NRE075 Chadakori_NI_FG2 Yada Iri cowpea 644 800 100 -256 NRE076 Chadakori_NI_FG2 Yada Iri cowpea 520 800 0 -520 NRE078 Chadakori_NI_FG2 Yada Iri cowpea 573 800 120 -340 NRE079 Chadakori_NI_FG2 Yada Iri cowpea 367 200 120 -134 outlier &lt;- c( hh[margin_ha_ppp &gt; median(margin_ha_ppp) + 3*sd(margin_ha_ppp), hhid], hh[margin_ha_sh &gt; median(margin_ha_sh) + 3*sd(margin_ha_sh), hhid] ) kbl(caption=&quot;Respondents with gross margins &gt; median + 3*sd&quot;, hh[hhid %in% outlier, .(hhid, code, group, crop, costs_ha_ppp, yield_ha_kg, sales_ha_kg, margin_ha_ppp, margin_ha_sh)], format.args=list(big.mark=&quot;,&quot;, digits=1)) Tab. 4: Respondents with gross margins &gt; median + 3*sd hhid code group crop costs_ha_ppp yield_ha_kg sales_ha_kg margin_ha_ppp margin_ha_sh NRE013 Sabon_Machi_MI_FG2 Himma millet 144 900 400 1,409 10 NRE020 Sabon_Machi_MI_FG2 Himma millet 165 600 300 1,582 10 NRE024 Sabon_Machi_NI_FG1 Himma cowpea 720 600 600 2,774 4 NRE025 Sabon_Machi_NI_FG1 Himma cowpea 679 700 600 2,814 4 NRE033 Sabon_Machi_NI_FG2 Himma cowpea 1,007 1,000 1,000 2,875 3 ggplot(hh, aes(x=hhid, color=group)) + geom_hline(aes(yintercept=0), color=1) + geom_linerange(aes(ymin=0, ymax=margin_ha_ppp), size=.6) + geom_point(aes(y=0), shape=20, size=1.4) + geom_point(aes(y=margin_ha_ppp, shape=margin_ha_ppp &lt; 0, fill=group), size=1.4) + scale_y_continuous(labels=comma) + scale_shape_manual(values=24:25) + guides(x=&quot;none&quot;, shape=&quot;none&quot;) + labs(x=NULL, y=NULL, color=&quot;&quot;, fill=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Niger&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def( legend.position=&quot;right&quot;, panel.grid.major.x=element_blank() ) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms as percentage of total costs per hectare. ggBoxTest(hh[!hhid %in% outlier], aes(gender, margin_ha_ppp, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Niger&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(gender, margin_ha_sh, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Niger&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(years, margin_ha_ppp, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Niger&quot;, subtitle=&quot;Stratified by years in seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(years, margin_ha_sh, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Niger&quot;, subtitle=&quot;Stratified by years in seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(group, margin_ha_ppp, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Niger&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(group, margin_ha_sh, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Niger&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(member_years, margin_ha_ppp)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20) + scale_x_continuous(limits=c(0, 22)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms vs. Years in Seed Club - Niger&quot;, subtitle=&quot;Each point is a respondent (years vs. PPP$)&quot;) + theme_def(legend.position=&quot;top&quot;) Correlation Significant pairwise associations. ggpairs( hh[, .(`seed club`=group, `years in club`=member_years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:4], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:4], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:4], alpha=.8)), title=&quot;Correlogram stratified by seed club - Niger&quot; ) + theme_def( strip.text=element_text(hjust=.5), axis.text.x=element_text(angle=-45), panel.grid.major=element_blank() ) ggpairs( hh[, .(gender, `years in club`=member_years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by gender - Niger&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) ggpairs( hh[, .(`years in club`=years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by years in seed club - Niger&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) saveRDS(hh, &quot;../tmp/data_nre.rds&quot;) "],["03.html", "Guatemala Survey Recodes Descriptive Statistics Correlation", " Guatemala Notes: 1 Int’l $ = 4.01 GTQ (Quetzal) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) Focus crop = bean and potato All costs are reported per hectare, except for labeling and packaging costs For beans these costs are per bag of 3 pounds or 1.36 kg For potato these costs are per crate of 22.68 kg Other marketing costs are assumed also per hectare Inspection and certification fees are per farm (total fees for a single season) Actual sales are assumed for the planted area (not by hectare) Sales prices are assumed by bag or crate (not by kg) Some farmers grow multiple crops Survey Recodes xrate &lt;- 4.01 # Load respondent data hh &lt;- fread(&quot;../data/gtm/hh.csv&quot;) group &lt;- fread(&quot;../data/gtm/group.csv&quot;) There are 21 variables and 39 observations in this set. A summary is shown below. print(dfSummary(hh), max.tbl.height=500, table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Variable Stats / Values Freqs (% of Valid) Graph Valid Missing Group [character] 1. ACORDI2. ADAT, AXOLA, ADIPY3. PAQUIX4. SAN BARTOLO 10(25.6%)9(23.1%)10(25.6%)10(25.6%) 39 (100.0%) 0 (0.0%) Province [character] 1. CAPELLANIA2. PAQUIX3. REGADILLOS, CHIANTLA4. SAN MARTIN CUCHUMATAN 10(25.6%)10(25.6%)10(25.6%)9(23.1%) 39 (100.0%) 0 (0.0%) Code [character] 1. Agricultor 82. Agricultor 93. Agricultor 104. Agricultor 15. Agricultor 26. Agricultor 37. Agricultor 48. Agricultor 59. Agricultor 610. Agricultor 7[ 21 others ] 4(10.3%)4(10.3%)3(7.7%)1(2.6%)1(2.6%)1(2.6%)1(2.6%)1(2.6%)1(2.6%)1(2.6%)21(53.8%) 39 (100.0%) 0 (0.0%) Age [character] 1. 15-292. 30 4(10.3%)35(89.7%) 39 (100.0%) 0 (0.0%) Sex [character] 1. Female2. Male 5(12.8%)34(87.2%) 39 (100.0%) 0 (0.0%) Cost seed per ha (LCU) [numeric] Mean (sd) : 7776.9 (7059.6)min &le; med &le; max:690 &le; 13225 &le; 15794.1IQR (CV) : 13819.5 (0.9) 690.00:19(48.7%)13225.00:10(25.6%)15794.10:10(25.6%) 39 (100.0%) 0 (0.0%) Cost of fertilizer per ha (LCU) [numeric] Min : 3685.3Mean : 3689.8Max : 3703 3685.29:29(74.4%)3703.00:10(25.6%) 39 (100.0%) 0 (0.0%) Cost of pesticide per ha (LCU) [numeric] Mean (sd) : 9182.7 (591.6)min &le; med &le; max:8583.8 &le; 9728.2 &le; 9775IQR (CV) : 1167.9 (0.1) 8583.75:19(48.7%)9728.25:10(25.6%)9775.00:10(25.6%) 39 (100.0%) 0 (0.0%) Cost of transport per ha (LCU) [numeric] Mean (sd) : 2322.6 (1163.3)min &le; med &le; max:1144.5 &le; 3433.5 &le; 3450IQR (CV) : 2297.2 (0.5) 1144.50:19(48.7%)3433.50:10(25.6%)3450.00:10(25.6%) 39 (100.0%) 0 (0.0%) Labor cost (LCU) [numeric] Mean (sd) : 18187 (4397.1)min &le; med &le; max:13734 &le; 22363.5 &le; 22471IQR (CV) : 8683.3 (0.2) 13734.00:19(48.7%)22363.53:10(25.6%)22471.00:10(25.6%) 39 (100.0%) 0 (0.0%) Inspection / certification Fees (LCU) [numeric] Min : 0Mean : 12.2Max : 23.8 0.00:19(48.7%)23.82:20(51.3%) 39 (100.0%) 0 (0.0%) Labelling costs per kg (LCU) [numeric] Mean (sd) : 77.7 (77.5)min &le; med &le; max:16.5 &le; 40.6 &le; 324.5IQR (CV) : 91.2 (1) 25 distinct values 39 (100.0%) 0 (0.0%) Packaging costs per kg (LCU) [numeric] Mean (sd) : 3194.7 (4107.4)min &le; med &le; max:49.6 &le; 1947.1 &le; 15576.7IQR (CV) : 5202.3 (1.3) 25 distinct values 39 (100.0%) 0 (0.0%) Other marketing costs? (LCU) [numeric] Mean (sd) : 381.4 (322.8)min &le; med &le; max:113.4 &le; 113.4 &le; 1050IQR (CV) : 374.1 (0.8) 12 distinct values 39 (100.0%) 0 (0.0%) Estimated Yield (kg/ha) [numeric] Mean (sd) : 66157.6 (86000.7)min &le; med &le; max:2105.9 &le; 42117.6 &le; 336940.8IQR (CV) : 103390.5 (1.3) 13 distinct values 39 (100.0%) 0 (0.0%) Selling price of seed per kg (LCU) [numeric] Mean (sd) : 7473.5 (7745.6)min &le; med &le; max:1386 &le; 3992.8 &le; 31942.4IQR (CV) : 9248.3 (1) 25 distinct values 39 (100.0%) 0 (0.0%) How many kg were sold in the season? [integer] Mean (sd) : 3049.9 (3857.5)min &le; med &le; max:90 &le; 1840 &le; 14720IQR (CV) : 4868.5 (1.3) 25 distinct values 39 (100.0%) 0 (0.0%) What was your expected gross margin? [numeric] Mean (sd) : 2837.2 (3382.9)min &le; med &le; max:170 &le; 1566.8 &le; 12534.4IQR (CV) : 4406.7 (1.2) 26 distinct values 39 (100.0%) 0 (0.0%) How long have you been a member of this group? [integer] Mean (sd) : 3.9 (2.6)min &le; med &le; max:1 &le; 3 &le; 15IQR (CV) : 3 (0.7) 1:3(7.7%)2:8(20.5%)3:10(25.6%)4:7(17.9%)5:7(17.9%)6:1(2.6%)8:1(2.6%)10:1(2.6%)15:1(2.6%) 39 (100.0%) 0 (0.0%) Area (ha) [numeric] Mean (sd) : 0.1 (0.1)min &le; med &le; max:0 &le; 0.1 &le; 0.4IQR (CV) : 0.1 (0.7) 0.04&thinsp;!:15(38.5%)0.09&thinsp;!:14(35.9%)0.13&thinsp;!:5(12.8%)0.18&thinsp;!:2(5.1%)0.26&thinsp;!:1(2.6%)0.31&thinsp;!:1(2.6%)0.35&thinsp;!:1(2.6%)!&thinsp;rounded 39 (100.0%) 0 (0.0%) Crop [character] 1. bean2. potato 19(48.7%)20(51.3%) 39 (100.0%) 0 (0.0%) Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 Recode variable names. setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. setorder(hh, adm1_nm, group, gender, crop) hh[, `:=`( hhid = paste(&quot;GTM&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;GTM&quot;, crop = factor(crop), adm1_nm = factor(adm1_nm), group = factor(group, levels=c( &quot;ACORDI&quot;, &quot;PAQUIX&quot;, &quot;SAN BARTOLO&quot;, &quot;ADAT, AXOLA, ADIPY&quot; ), labels=c( &quot;Acordi&quot;, &quot;Paquix&quot;, &quot;San Bartolo&quot;, &quot;Adat Axola Adipy&quot; )), gender = factor(gender, levels=c(&quot;Male&quot;, &quot;Female&quot;)), age = factor(age, levels=c(&quot;15-29&quot;, &quot;30&quot;), labels=c(&quot;&lt; 30&quot;, &quot;≥ 30&quot;)), years = factor(member_years &gt;= 5, levels=c(F, T), labels=c(&quot;&lt; 5&quot;, &quot;≥ 5&quot;)) )] Constructed Variables Farmers report both expected yields yield_ha_kg and actual sales in the last season sales_ha_kg, so we can construct both expected and realized costs in monetary terms costs_exp_ha_lcu and costs_real_ha_lcu. Note that we then use realized sales to calculate profitability metrics. We assume that in Guatemala marketing costs for both bean and potato are reported for the entire farm (not by kg as in Vietnam). hh[, `:=`( tran_ha_lcu = as.numeric(tran_ha_lcu), # Reported sales assumed by planted area sales_ha_kg = sales_ha_kg/area_ha, # Reported sales price assumed by bag/crate sales_kg_lcu = fcase( crop==&quot;bean&quot;, 1/1.36, crop==&quot;potato&quot;, 1/22.68) * sales_kg_lcu )][, tran_ha_lcu := fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu) ][, `:=`( # Expected costs costs_exp_ha_lcu = # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs fcase( crop==&quot;bean&quot;, 1/1.36, crop==&quot;potato&quot;, 1/22.68) * yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu), # Realized costs costs_real_ha_lcu = # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs fcase( crop==&quot;bean&quot;, 1/1.36, crop==&quot;potato&quot;, 1/22.68) * sales_ha_kg * (labl_kg_lcu + pckg_kg_lcu) )] hh[, summary(costs_exp_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 130758 141622 3746290 25100149 25565442 236288594 hh[, summary(costs_real_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 127592 149713 3709358 6396050 10804345 29307914 Using realized costs and sales, we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as expected output per unit of (expected) input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( sales_exp_ha_lcu = yield_ha_kg * sales_kg_lcu, sales_real_ha_lcu = sales_ha_kg * sales_kg_lcu )][, `:=`( margin_ha_lcu = sales_real_ha_lcu - costs_real_ha_lcu )][, `:=`( # Shares sales_ha_sh = sales_real_ha_lcu / costs_real_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_real_ha_lcu, # PPP$ costs_ha_ppp = costs_real_ha_lcu / xrate, sales_ha_ppp = sales_real_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / (costs_exp_ha_lcu / xrate) )] Note that expected seed yields and actual sales look somewhat inconsistent, especially for potato. Packaging costs for potato seems also too high. ggplot(hh, aes(x=hhid, color=group)) + geom_linerange(aes(ymin=yield_ha_kg, ymax=sales_ha_kg), size=.6) + geom_point(aes(y=yield_ha_kg), shape=20, size=1.4) + geom_point(aes(y=sales_ha_kg, fill=group, shape=sales_ha_kg-yield_ha_kg&gt;0), size=1.4) + scale_y_continuous(labels=comma) + scale_shape_manual(values=25:24) + facet_wrap(~crop, scales=&quot;free&quot;) + guides(x=&quot;none&quot;, shape=&quot;none&quot;) + labs(x=NULL, y=NULL, color=&quot;&quot;, fill=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def( legend.position=&quot;right&quot;, panel.grid.major.x=element_blank() ) Verify unit price (per kg) in PPP$ terms. hh[crop==&quot;bean&quot;, summary(sales_kg_lcu / xrate)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 254.1 259.8 279.6 374.7 519.6 593.0 hh[crop==&quot;potato&quot;, summary(sales_kg_lcu / xrate)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 43.90 87.81 118.54 138.90 161.89 351.22 Below we append some of the information that was recorded at the group level. kbl(group, align=&quot;llc&quot;) Group Region District Location Market Access Irrigation Seasons Transboundary trade Members Established Notes ADAT, AXOLA, ADIPY Huehuetenango Aguacatan Climentoro – No 1 No 13 1974 Aplicación de abono orgánico (Compost). No existe acceso a riego. Un ciclo de cultivo por año. Manejo integrado de plagas. Rotación de cultivos. Practicas de conservación de suelo Barreras vivas, pastos) PAQUIX Huehuetenango Chiantla Paquix – No 1 No 50 1998 Aplicación de abono orgánico (Compost). No existe acceso a riego. Un ciclo de cultivo por año. Manejo integrado de plagas. Rotación de cultivos. Practicas de conservación de suelo Barreras vivas, pastos) ACORDI Huehuetenango Chiantla Capellania – No 1 No 29 1998 Aplicación de abono orgánico (Compost). No existe acceso a riego. Un ciclo de cultivo por año. Manejo integrado de plagas. Rotación de cultivos. Practicas de conservación de suelo Barreras vivas, pastos) SAN BARTOLO Huehuetenango Chiantla Regadillos – Yes 2 No 55 2016 -Incorporación de abono orgánico. -Dos ciclos de producción (primer ciclo los meses de enero, febrero y marzo; segundo ciclo meses de noviembre y diciembre). Rotación de cultivos. Manejo integrado de plagas. sistema de riego por aspersión. # Same recodes in the group-level dataset group[, Group := factor(Group, levels=c( &quot;ACORDI&quot;, &quot;PAQUIX&quot;, &quot;SAN BARTOLO&quot;, &quot;ADAT, AXOLA, ADIPY&quot; ), labels=c( &quot;Acordi&quot;, &quot;Paquix&quot;, &quot;San Bartolo&quot;, &quot;Adat Axola Adipy&quot; ))] # Merge hh[group, on=.(group=Group), `:=`( group_year = `Established`, group_size = `Members`, seasons = `Seasons`, irrigated = `Irrigation`, market_access = `Market Access`, ttrade = `Transboundary trade` )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table per ha hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Labor = labor_ha_lcu, Transport = tran_ha_lcu, Certification = cert_lcu, Labeling = fcase( crop==&quot;bean&quot;, 1/1.36, crop==&quot;potato&quot;, 1/22.68) * sales_ha_kg * labl_kg_lcu, Packaging = fcase( crop==&quot;bean&quot;, 1/1.36, crop==&quot;potato&quot;, 1/22.68) * sales_ha_kg * pckg_kg_lcu, Marketing = mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) And we lump all seed marketing costs into a single category. levels(hh_prod_cost$type) &lt;- levels(hh_prod_cost$type)[c(1,2,3,4,9,9,9,9,9)] hh_prod_cost &lt;- hh_prod_cost[, .( lcu = sum(lcu, na.rm=T) ), by=.(hhid, type) ][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid) ][hh, on=.(hhid), `:=`( # Add classes group = group, gender = gender, age = age, years = years, crop = crop )] Descriptive Statistics Respondent Characteristics Breakdown by categorical variables. ggplot( hh[, .N, by=.(group, age, gender, crop, years)], aes(axis1=crop, axis2=gender, axis3=age, axis4=years, y=N)) + geom_alluvium(aes(fill=group), width=1/4, alpha=.7, color=&quot;white&quot;) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Crop&quot;, &quot;Gender&quot;, &quot;Age&quot;, &quot;Years in Seed Club&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Categories of Survey Respondents - Guatemala&quot;, subtitle = &quot;Stratified by seed club&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, age age, and years in seed club years). print(ctable(hh$group, hh$gender, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Gender&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Gender Group Male Female Total Acordi 7 ( 70% ) 3 ( 30% ) 10 ( 100% ) Paquix 10 ( 100% ) 0 ( 0% ) 10 ( 100% ) San Bartolo 8 ( 80% ) 2 ( 20% ) 10 ( 100% ) Adat Axola Adipy 9 ( 100% ) 0 ( 0% ) 9 ( 100% ) Total 34 ( 87% ) 5 ( 13% ) 39 ( 100% ) &nbsp;&#935;2 = 5.8959&nbsp;&nbsp;&nbsp;df = 3&nbsp;&nbsp;&nbsp;p = .1168 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 print(ctable(hh$group, hh$age, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Age&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Age Group &lt; 30 ≥ 30 Total Acordi 3 ( 30% ) 7 ( 70% ) 10 ( 100% ) Paquix 0 ( 0% ) 10 ( 100% ) 10 ( 100% ) San Bartolo 0 ( 0% ) 10 ( 100% ) 10 ( 100% ) Adat Axola Adipy 1 ( 11% ) 8 ( 89% ) 9 ( 100% ) Total 4 ( 10% ) 35 ( 90% ) 39 ( 100% ) &nbsp;&#935;2 = 6.5279&nbsp;&nbsp;&nbsp;df = 3&nbsp;&nbsp;&nbsp;p = .0886 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 print(ctable(hh$group, hh$years, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Years in Seed Club&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Years in Seed Club Group &lt; 5 ≥ 5 Total Acordi 5 ( 50% ) 5 ( 50% ) 10 ( 100% ) Paquix 7 ( 70% ) 3 ( 30% ) 10 ( 100% ) San Bartolo 10 ( 100% ) 0 ( 0% ) 10 ( 100% ) Adat Axola Adipy 6 ( 67% ) 3 ( 33% ) 9 ( 100% ) Total 28 ( 72% ) 11 ( 28% ) 39 ( 100% ) &nbsp;&#935;2 = 6.4071&nbsp;&nbsp;&nbsp;df = 3&nbsp;&nbsp;&nbsp;p = .0934 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 Seed Production Costs General breakdown and distribution of input costs across seed clubs, gender, years in seed club, and input type. Note that for potato input costs are too high because expected yields yield_ha_kg are too high (potato yields should be around 25 mt/ha). This needs checking. ttt(costs_ha_ppp ~ group+crop | gender+years, data=hh, render=fmt, caption=&quot;Total Input Costs in Absolute Terms (PPP$ / ha) - Guatemala&quot;) Total Input Costs in Absolute Terms (PPP$ / ha) - Guatemala group crop Statistic ≥ 5 Male Female Male Female Acordi potato mean 3,324,027 2,749,359 5,337,739 1,381,555 median 2,530,891 2,749,359 5,484,968 1,381,555 sd 2,819,561 NA 1,139,867 644,789 Paquix potato mean 2,699,210 NA 2,544,545 NA median 2,639,341 NA 1,836,896 NA sd 976,226 NA 1,836,403 NA San Bartolo bean mean 44,824 45,372 NA NA median 36,439 45,372 NA NA sd 15,640 19,168 NA NA Adat Axola Adipy bean mean 42,659 NA 50,262 NA median 35,552 NA 58,926 NA sd 13,130 NA 15,006 NA ttt(yield_ha_kg ~ group+crop | gender+years, data=hh, render=fmt, caption=&quot;Expected Yield (kg / ha) - Guatemala&quot;) Expected Yield (kg / ha) - Guatemala group crop Statistic ≥ 5 Male Female Male Female Acordi potato mean 147,412 126,353 238,666 63,176 median 105,294 126,353 252,706 63,176 sd 130,949 NA 64,336 29,782 Paquix potato mean 96,731 NA 98,747 NA median 84,640 NA 84,640 NA sd 31,991 NA 64,645 NA San Bartolo bean mean 2,896 3,159 NA NA median 2,106 3,159 NA NA sd 1,090 1,489 NA NA Adat Axola Adipy bean mean 2,106 NA 2,106 NA median 2,106 NA 2,106 NA sd 0 NA 0 NA Boxplots with mean comparison p-value and significance levels. When more than two levels, each level is compared to the group mean. (ns : p &gt; 0.05, * : p ≤ 0.05, ** : p ≤ 0.01, *** = p ≤ 0.001, **** = p ≤ 0.0001) ggBoxTest(hh, aes(crop, costs_ha_ppp, color=gender, fill=gender), grp.c=aes(group=crop), grp.s=aes(group=gender)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh, aes(crop, costs_ha_ppp, color=group, fill=group), grp.c=aes(group=crop), grp.s=aes(group=group)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by crop&quot;) + theme_def(legend.position=&quot;top&quot;) Breakdown across categories of farm input. ttt(ppp ~ type | gender+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Gender (PPP$ / ha) - Guatemala&quot;) Input Costs in Absolute Terms by Gender (PPP$ / ha) - Guatemala type Statistic bean potato Male Female Male Female Seeds mean 172 172 3,562 3,939 median 172 172 3,298 3,939 sd 0 0 325 0 Fertilizer mean 919 919 922 919 median 919 919 923 919 sd 0 0 2 0 Pesticides mean 2,141 2,141 2,433 2,426 median 2,141 2,141 2,438 2,426 sd 0 0 6 0 Labor mean 3,425 3,425 5,593 5,577 median 3,425 3,425 5,604 5,577 sd 0 0 14 0 Marketing mean 38,363 38,715 3,272,046 1,824,629 median 30,374 38,715 3,211,431 1,824,629 sd 14,011 19,168 1,864,099 911,869 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(gender, crop, type)] ggplot(tbl, aes(gender, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Guatemala&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;right&quot;) ttt(ppp ~ type | years+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Years in Seed Group (PPP$ / ha) - Guatemala&quot;) Input Costs in Absolute Terms by Years in Seed Group (PPP$ / ha) - Guatemala type Statistic bean potato ≥ 5 ≥ 5 Seeds mean 172 172 3,565 3,698 median 172 172 3,298 3,939 sd 0 0 330 332 Fertilizer mean 919 919 922 921 median 919 919 923 919 sd 0 0 2 2 Pesticides mean 2,141 2,141 2,433 2,430 median 2,141 2,141 2,438 2,426 sd 0 0 6 6 Labor mean 3,425 3,425 5,593 5,587 median 3,425 3,425 5,604 5,577 sd 0 0 14 14 Marketing mean 37,424 43,605 2,899,150 3,288,609 median 29,477 52,269 2,681,789 2,971,592 sd 14,051 15,006 1,667,567 2,114,119 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(years, crop, type)] ggplot(tbl, aes(years, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Guatemala&quot;, subtitle=&quot;Stratified by crop and years in seed club&quot;) + theme_def(legend.position=&quot;right&quot;) ttt(ppp ~ type | group+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Guatemala&quot;) Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Guatemala type Statistic bean potato San Bartolo Adat Axola Adipy Acordi Paquix Seeds mean 172 172 3,939 3,298 median 172 172 3,939 3,298 sd 0 0 0 0 Fertilizer mean 919 919 919 923 median 919 919 919 923 sd 0 0 0 0 Pesticides mean 2,141 2,141 2,426 2,438 median 2,141 2,141 2,426 2,438 sd 0 0 0 0 Labor mean 3,425 3,425 5,577 5,604 median 3,425 3,425 5,577 5,604 sd 0 0 0 0 Marketing mean 38,277 38,537 3,469,319 2,640,548 median 29,782 30,374 2,973,965 2,468,071 sd 15,203 13,360 2,276,833 1,179,128 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(group, crop, type)] ggplot(tbl, aes(group, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop, scales=&quot;free_x&quot;) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Guatemala&quot;, subtitle=&quot;Stratified by crop and seed club&quot;) + theme_def(legend.position=&quot;right&quot;) Are there significant differences across groups? We first compare input cost shares across gender, then across seed clubs. ggBoxTest(hh_prod_cost, aes(type, share, color=gender, fill=gender), grp.c=aes(group=type), grp.s=aes(group=gender)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (Percent of Total Costs by Ha) - Guatemala&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh_prod_cost, aes(type, share, color=years, fill=years), grp.c=aes(group=type), grp.s=aes(group=years)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (Percent of Total Costs by Ha) - Guatemala&quot;, subtitle=&quot;Stratified by crop and years in seed club&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh_prod_cost, aes(type, share, color=group, fill=group), grp.c=aes(group=type), grp.s=aes(group=group)) + scale_y_continuous(labels=percent) + facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Guatemala&quot;, subtitle=&quot;Stratified by crop and seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Differences between the 2 crops. ggBoxTest(hh_prod_cost, aes(type, share, color=crop, fill=crop), grp.c=aes(group=type), grp.s=aes(group=crop)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Guatemala&quot;, subtitle=&quot;Stratified by crop&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures (expected seed yields and actual sales) across groups. ttt(yield_ha_kg ~ group | gender+crop, data=hh, render=fmt, caption=&quot;Expected Seed Yield (kg / ha) - Guatemala&quot;) Expected Seed Yield (kg / ha) - Guatemala group Statistic bean potato Male Female Male Female Acordi mean NA NA 186,521 84,235 median NA NA 168,470 84,235 sd NA NA 111,053 42,118 Paquix mean NA NA 97,336 NA median NA NA 84,640 NA sd NA NA 40,148 NA San Bartolo mean 2,896 3,159 NA NA median 2,106 3,159 NA NA sd 1,090 1,489 NA NA Adat Axola Adipy mean 2,106 NA NA NA median 2,106 NA NA NA sd 0 NA NA NA ttt(sales_ha_kg ~ group | gender+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Guatemala&quot;) Realized Seed Sales (kg / ha) - Guatemala group Statistic bean potato Male Female Male Female Acordi mean NA NA 42,593 41,723 median NA NA 41,723 41,723 sd NA NA 1,506 0 Paquix mean NA NA 46,382 NA median NA NA 46,939 NA sd NA NA 2,669 NA San Bartolo mean 2,143 2,063 NA NA median 2,086 2,063 NA NA sd 125 32 NA NA Adat Axola Adipy mean 2,111 NA NA NA median 2,086 NA NA NA sd 53 NA NA NA ttt(yield_ha_kg ~ group | years+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Guatemala&quot;) Realized Seed Sales (kg / ha) - Guatemala group Statistic bean potato ≥ 5 ≥ 5 Acordi mean NA NA 143,200 168,470 median NA NA 126,353 168,470 sd NA NA 113,795 107,379 Paquix mean NA NA 96,731 98,747 median NA NA 84,640 84,640 sd NA NA 31,991 64,645 San Bartolo mean 2,948 NA NA NA median 2,106 NA NA NA sd 1,087 NA NA NA Adat Axola Adipy mean 2,106 2,106 NA NA median 2,106 2,106 NA NA sd 0 0 NA NA ttt(sales_ha_kg ~ group | years+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Guatemala&quot;) Realized Seed Sales (kg / ha) - Guatemala group Statistic bean potato ≥ 5 ≥ 5 Acordi mean NA NA 42,419 42,245 median NA NA 41,723 41,723 sd NA NA 1,555 1,166 Paquix mean NA NA 46,889 45,200 median NA NA 46,939 46,939 sd NA NA 2,582 3,011 San Bartolo mean 2,127 NA NA NA median 2,086 NA NA NA sd 116 NA NA NA Adat Axola Adipy mean 2,124 2,086 NA NA median 2,098 2,086 NA NA sd 62 0 NA NA Differences in efficiency measures across gender with mean comparison (Wilcoxon) p-value. ggBoxTest(hh, aes(gender, yield_ha_kg, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Seed Yield (kg / ha) - Guatemala&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(gender, sales_ha_ppp, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;none&quot;) Differences in efficiency measures by years in seed club with mean comparison (Wilcoxon) p-value. ggBoxTest(hh, aes(years, yield_ha_kg, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Seed Yield (kg / ha) - Guatemala&quot;, subtitle=&quot;Stratified crop and by years in seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(years, sales_ha_ppp, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified crop and by years in seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Differences in efficiency measures across seed clubs with global ANOVA p-value. ggBoxTest(hh, aes(group, yield_ha_kg, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Expected Seed Yield (Kg / ha) - Guatemala&quot;, subtitle=&quot;Stratified by crop and seed club&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh, aes(group, sales_ha_ppp, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Stratified crop and by seed club&quot;) + theme_def(legend.position=&quot;none&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. Note that in the approximated curves below we remove outliers with total input costs over PPP$ 6,000,000 per ha. outlier &lt;- hh[costs_ha_ppp &gt; median(costs_ha_ppp) + 2*sd(costs_ha_ppp), hhid] kbl( caption=&quot;Farmers with total input costs &gt; median + 2*sd&quot;, hh[hhid %in% outlier, .(hhid, group, crop, yield_ha_kg, costs_ha_ppp)], format.args=list(big.mark=&quot;,&quot;)) Tab. 5: Farmers with total input costs &gt; median + 2*sd hhid group crop yield_ha_kg costs_ha_ppp GTM004 Acordi potato 294,823.2 6,396,837 GTM005 Acordi potato 336,940.8 7,308,707 GTM007 Acordi potato 252,705.6 5,484,968 ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Guatemala&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) Profitability Farmers’ gross profit margins by gender and years in seed club. ttt(margin_ha_ppp ~ group+crop | gender+years, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Guatemala&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Guatemala group crop Statistic ≥ 5 Male Female Male Female Acordi potato mean 3,325,655 2,745,931 5,357,088 1,366,090 median 2,525,539 2,745,931 5,505,612 1,366,090 sd 2,844,373 NA 1,149,897 650,463 Paquix potato mean 2,696,532 NA 2,540,506 NA median 2,636,137 NA 1,826,630 NA sd 984,817 NA 1,852,563 NA San Bartolo bean mean 745,174 755,928 NA NA median 578,783 755,928 NA NA sd 310,640 380,543 NA NA Adat Axola Adipy bean mean 702,153 NA 853,020 NA median 561,133 NA 1,025,013 NA sd 260,632 NA 297,900 NA ttt(margin_ha_sh ~ group+crop | gender+years, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Guatemala&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Guatemala group crop Statistic ≥ 5 Male Female Male Female Acordi potato mean 99% 100% 100% 99% median 100% 100% 100% 99% sd 1% NA 0% 1% Paquix potato mean 100% NA 99% NA median 100% NA 99% NA sd 1% NA 1% NA San Bartolo bean mean 1 632% 1 635% NA NA median 1 588% 1 635% NA NA sd 100% 148% NA NA Adat Axola Adipy bean mean 1 622% NA 1 675% NA median 1 578% NA 1 740% NA sd 95% NA 112% NA Note that 0 respondents show negative margins. kbl(caption=&quot;Respondents with negative gross margins.&quot;, hh[margin_ha_ppp &lt; 0, .(hhid, code, group, crop, costs_ha_ppp, yield_ha_kg, sales_ha_kg, margin_ha_ppp)]) Tab. 6: Respondents with negative gross margins. hhid code group crop costs_ha_ppp yield_ha_kg sales_ha_kg margin_ha_ppp outlier &lt;- kbl(caption=&quot;Respondents with gross margins &gt; median + 3*sd&quot;, hh[margin_ha_ppp &gt; median(margin_ha_ppp) + 3*sd(margin_ha_ppp), .(hhid, code, group, crop, costs_ha_ppp, yield_ha_kg, sales_ha_kg, margin_ha_ppp)], format.args=list(big.mark=&quot;,&quot;, digits=1)) ggplot(hh, aes(x=hhid, color=group)) + geom_hline(aes(yintercept=0), color=1) + geom_linerange(aes(ymin=0, ymax=margin_ha_ppp), size=.6) + geom_point(aes(y=0), shape=20, size=1.4) + geom_point(aes(y=margin_ha_ppp, shape=margin_ha_ppp &lt; 0, fill=group), size=1.4) + scale_y_continuous(labels=comma) + scale_shape_manual(values=24:25) + guides(x=&quot;none&quot;, shape=&quot;none&quot;) + labs(x=NULL, y=NULL, color=&quot;&quot;, fill=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Guatemala&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def( legend.position=&quot;right&quot;, panel.grid.major.x=element_blank() ) Farmers’ gross profit margins by gender and across groups in both absolute terms and in relative terms as percentage of total costs per hectare. ggBoxTest(hh[!hhid %in% outlier], aes(gender, margin_ha_ppp, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Guatemala&quot;, subtitle=&quot;Stratified by gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(gender, margin_ha_sh, color=gender, fill=gender), cp=list(1:2)) + scale_y_continuous(labels=percent) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Guatemala&quot;, subtitle=&quot;Stratified by gender (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(years, margin_ha_ppp, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Guatemala&quot;, subtitle=&quot;Stratified by years in seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(years, margin_ha_sh, color=years, fill=years), cp=list(1:2)) + scale_y_continuous(labels=percent) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Guatemala&quot;, subtitle=&quot;Stratified by years in seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(group, margin_ha_ppp, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Guatemala&quot;, subtitle=&quot;Stratified by seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(group, margin_ha_sh, color=group, fill=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + facet_wrap(~crop, scales=&quot;free_y&quot;) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Guatemala&quot;, subtitle=&quot;Stratified by seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;none&quot;) ggplot(hh[!hhid %in% outlier], aes(member_years, margin_ha_ppp)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20) + scale_x_continuous(limits=c(0, 22)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms vs. Years in Seed Club - Guatemala&quot;, subtitle=&quot;Each point is a respondent (years vs. PPP$)&quot;) + theme_def(legend.position=&quot;top&quot;) Correlation Significant pairwise associations. ggpairs( hh[, .(`seed club`=group, `years in club`=member_years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:4], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:4], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:4], alpha=.8)), title=&quot;Correlogram stratified by seed club - Guatemala&quot; ) + theme_def( strip.text=element_text(hjust=.5), axis.text.x=element_text(angle=-45), panel.grid.major=element_blank() ) ggpairs( hh[, .(gender, `years in club`=member_years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by gender - Guatemala&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) ggpairs( hh[, .(`years in club`=years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by years in seed club - Guatemala&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) saveRDS(hh, &quot;../tmp/data_gtm.rds&quot;) "],["04.html", "Uganda", " Uganda [pending] "],["05.html", "Zambia Survey Recodes Descriptive Statistics Correlation", " Zambia Notes: 1 Int’l $ = 5.59 ZMW (Kwacha) using 2020 World Bank PPP conversion rates (1 Int’l $ = 1 USD) Focus crops = soybean, maize, cowpea, bean All costs are reported per hectare. Inspection, certification and other marketing costs are assumed for the entire farm. Labeling and packaging are per kg. Some farmers grow multiple crops Survey Recodes xrate &lt;- 5.59 # Load respondent data hh &lt;- fread(&quot;../data/zmb/hh.csv&quot;) group &lt;- fread(&quot;../data/zmb/group.csv&quot;) There are 23 variables and 76 observations in this set. A summary is shown below. print(dfSummary(hh), max.tbl.height=500, table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Error : thematic doesn’t (yet) support the ‘PNG’ graphics device. Please report this error to https://github.com/rstudio/thematic/issues/new Variable Stats / Values Freqs (% of Valid) Graph Valid Missing Code [character] 1. FARMER422. FARMER173. FARMER464. FARMER525. FARMER156. FARMER167. FARMER188. FARMER199. FARMER2610. FARMER27[ 42 others ] 5(6.6%)3(3.9%)3(3.9%)3(3.9%)2(2.6%)2(2.6%)2(2.6%)2(2.6%)2(2.6%)2(2.6%)50(65.8%) 76 (100.0%) 0 (0.0%) Province [character] 1. Chongwe District2. Mumbwa District3. Rufunsa District 37(48.7%)24(31.6%)15(19.7%) 76 (100.0%) 0 (0.0%) Group [character] 1. Chiyota Seed Growers Asso2. Mumbwa Seed Growers Assoc3. Mweete Seed Growers Assoc4. Tiwine Womens Seed grower 15(19.7%)24(31.6%)14(18.4%)23(30.3%) 76 (100.0%) 0 (0.0%) Age [character] 1. 15-292. 30+ 5(6.6%)71(93.4%) 76 (100.0%) 0 (0.0%) Sex [character] 1. female2. male 33(43.4%)43(56.6%) 76 (100.0%) 0 (0.0%) Crop [character] 1. bean2. cowpea3. groundnut4. maize5. soybean 8(10.5%)21(27.6%)12(15.8%)18(23.7%)17(22.4%) 76 (100.0%) 0 (0.0%) Cost seed per ha (LCU) [integer] Mean (sd) : 237.4 (359.2)min &le; med &le; max:0 &le; 175 &le; 1800IQR (CV) : 253.5 (1.5) 32 distinct values 76 (100.0%) 0 (0.0%) Cost of fertilizer per ha (LCU) [integer] Mean (sd) : 586.9 (1069)min &le; med &le; max:0 &le; 225 &le; 7200IQR (CV) : 652.5 (1.8) 31 distinct values 76 (100.0%) 0 (0.0%) Cost of pesticide per ha (LCU) [integer] Mean (sd) : 205.4 (368.6)min &le; med &le; max:0 &le; 63.5 &le; 2020IQR (CV) : 300 (1.8) 31 distinct values 76 (100.0%) 0 (0.0%) Cost of transport per ha (LCU) [integer] Mean (sd) : 103.6 (244.2)min &le; med &le; max:0 &le; 10 &le; 1640IQR (CV) : 100 (2.4) 23 distinct values 76 (100.0%) 0 (0.0%) Labor cost (LCU) [integer] Mean (sd) : 305.6 (476.3)min &le; med &le; max:0 &le; 100 &le; 2000IQR (CV) : 385 (1.6) 24 distinct values 76 (100.0%) 0 (0.0%) Inspection / certification Fees (LCU) [integer] Mean (sd) : 2.1 (17.2)min &le; med &le; max:0 &le; 0 &le; 150IQR (CV) : 0 (8.2) 0:74(97.4%)10:1(1.3%)150:1(1.3%) 76 (100.0%) 0 (0.0%) Labelling costs per kg (LCU) [numeric] Min : 0Mean : 0Max : 0.1 0.00:75(98.7%)0.14:1(1.3%) 76 (100.0%) 0 (0.0%) Packaging costs per kg (LCU) [numeric] Mean (sd) : 0.1 (0.2)min &le; med &le; max:0 &le; 0 &le; 1.4IQR (CV) : 0 (2.8) 11 distinct values 76 (100.0%) 0 (0.0%) Other marketing costs? (LCU) [integer] Mean (sd) : 7.4 (34.3)min &le; med &le; max:0 &le; 0 &le; 250IQR (CV) : 0 (4.7) 0:68(89.5%)10:3(3.9%)20:1(1.3%)40:1(1.3%)70:1(1.3%)150:1(1.3%)250:1(1.3%) 76 (100.0%) 0 (0.0%) Estimated Yield (kg/ha) [integer] Mean (sd) : 946.4 (1269.3)min &le; med &le; max:0 &le; 500 &le; 9600IQR (CV) : 962.5 (1.3) 43 distinct values 76 (100.0%) 0 (0.0%) Selling price of seed per kg (LCU) [numeric] Mean (sd) : 13.5 (40.4)min &le; med &le; max:0 &le; 7.5 &le; 300IQR (CV) : 4 (3) 22 distinct values 75 (98.7%) 1 (1.3%) Selling price of grain per kg (LCU) at sowing [numeric] Mean (sd) : 4.1 (5.2)min &le; med &le; max:0 &le; 3 &le; 30IQR (CV) : 7 (1.3) 21 distinct values 75 (98.7%) 1 (1.3%) Selling price of grain per kg (LCU) at harvest [numeric] Mean (sd) : 2.8 (3.5)min &le; med &le; max:0 &le; 1.8 &le; 16IQR (CV) : 4 (1.3) 20 distinct values 74 (97.4%) 2 (2.6%) How many kg were sold in the season? [integer] Mean (sd) : 771.2 (1246.9)min &le; med &le; max:0 &le; 375 &le; 9000IQR (CV) : 762.5 (1.6) 29 distinct values 76 (100.0%) 0 (0.0%) What was your expected gross margin? [integer] Mean (sd) : 5649.4 (9791.9)min &le; med &le; max:0 &le; 2870 &le; 72000IQR (CV) : 4200 (1.7) 52 distinct values 76 (100.0%) 0 (0.0%) Gross Revenue [integer] Mean (sd) : 5649.4 (9791.9)min &le; med &le; max:0 &le; 2870 &le; 72000IQR (CV) : 4200 (1.7) 52 distinct values 76 (100.0%) 0 (0.0%) How long have you been a member of this group? [integer] Mean (sd) : 5.5 (4.6)min &le; med &le; max:0 &le; 5 &le; 16IQR (CV) : 7 (0.8) 15 distinct values 76 (100.0%) 0 (0.0%) Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 Recode variable names (see codebook). setnames(hh, lbl$label, lbl$code, skip_absent=T) Additional recodes for categorical variables. setorder(hh, adm1_nm, group, gender, crop) hh[, `:=`( hhid = paste(&quot;ZMB&quot;, gsub(&quot; &quot;, &quot;0&quot;, format(1:.N, width=3)), sep=&quot;&quot;), iso3 = &quot;ZMB&quot;, crop = factor(crop), adm1_nm = factor(adm1_nm), # Abbreviate seed club names group = factor(group, levels=c( &quot;Mweete Seed Growers Association&quot;, &quot;Tiwine Womens Seed growers Cooperative&quot;, &quot;Mumbwa Seed Growers Association&quot;, &quot;Chiyota Seed Growers Association&quot; ), labels=c( &quot;Mweete&quot;, &quot;Tiwine&quot;, &quot;Mumbwa&quot;, &quot;Chiyota&quot; )), gender = factor(gender, levels=c(&quot;male&quot;, &quot;female&quot;), labels=c(&quot;Male&quot;, &quot;Female&quot;)), age = factor(age, levels=c(&quot;25&quot;, &quot;15-29&quot;, &quot;30+&quot;), labels=c(&quot;&lt; 30&quot;, &quot;&lt; 30&quot;, &quot;≥ 30&quot;)), years = factor(member_years &gt;= 5, levels=c(F, T), labels=c(&quot;&lt; 5&quot;, &quot;≥ 5&quot;)) )] Constructed Variables Farmers report both expected yields yield_ha_kg and sales in the last season sales_ha_kg, so we can construct both expected and realized costs in monetary terms costs_exp_ha_lcu and costs_real_ha_lcu. We use realized yields to calculate profitability metrics. Note that 1 farmer did not report a sales price, so we use the reported median. kbl(caption=&quot;Missing sales entry&quot;, hh[is.na(sales_kg_lcu), .(hhid, code, group, crop, yield_ha_kg, sales_ha_kg, sales_kg_lcu)]) Tab. 7: Missing sales entry hhid code group crop yield_ha_kg sales_ha_kg sales_kg_lcu ZMB023 FARMER27 Tiwine maize 2500 0 – hh[, tran_ha_lcu := as.numeric(tran_ha_lcu) ][, `:=`( tran_ha_lcu = fifelse(is.na(tran_ha_lcu), 0, tran_ha_lcu), sales_kg_lcu = fifelse(is.na(sales_kg_lcu), median(sales_kg_lcu, na.rm=T), sales_kg_lcu) ), by=.(group, crop)][, `:=`( # Expected costs costs_exp_ha_lcu = # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs yield_ha_kg * (labl_kg_lcu + pckg_kg_lcu), # Realized costs costs_real_ha_lcu = # Per ha costs seed_ha_lcu + fert_ha_lcu + pest_ha_lcu + tran_ha_lcu + labor_ha_lcu + cert_lcu + mark_kg_lcu + # Per kg costs sales_ha_kg * (labl_kg_lcu + pckg_kg_lcu) )] hh[, summary(costs_exp_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 20.0 498.1 993.2 1524.9 1861.2 10240.0 hh[, summary(costs_real_ha_lcu)] ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 10.0 497.5 973.2 1505.8 1853.8 9760.0 Using realized costs and sales, we construct gross margin per ha margin_ha_lcu, total sales sales_ha_sh and profit margin margin_ha_sh per unit of (variable) input costs, and costs_ha_ppp, sales_ha_ppp and margin_ha_ppp in PPP terms to allow for comparisons across groups and countries. We also construct a measure of total factor productivity tfp as expected output per unit of (expected) input costs. Strictly speaking it is only “partial factor productivity” here because we don’t include the rental cost of land, land preparation costs, irrigation costs, and the costs of animal and mechanical implements. hh[, `:=`( sales_exp_ha_lcu = yield_ha_kg * sales_kg_lcu, sales_real_ha_lcu = sales_ha_kg * sales_kg_lcu )][, `:=`( margin_ha_lcu = sales_real_ha_lcu - costs_real_ha_lcu )][, `:=`( sales_ha_sh = sales_real_ha_lcu / costs_real_ha_lcu, margin_ha_sh = margin_ha_lcu / costs_real_ha_lcu, costs_ha_ppp = costs_real_ha_lcu / xrate, sales_ha_ppp = sales_real_ha_lcu / xrate, margin_ha_ppp = margin_ha_lcu / xrate )][, `:=`( tfp = yield_ha_kg / (costs_exp_ha_lcu / xrate) )] Below we append some of the information that was recorded at the group level. kbl(group, align=&quot;llc&quot;) Group Market access Soil Irrigation Seasons Transboundary trade Members Established Tiwine Womens Seed growers Cooperative Close to market with good road network good No 1 No 50 2014 Chiyota Seed Growers Association Road is very bad. Far from markets as they take the produce to Lusaka good No 1 Yes 25 2013 Mumbwa Seed Growers Association The purchasing seed companies (Afriseed and Kamano seed company) collect on site loamy No 1 No 31 2001 Mweete Seed Growers Association They only sale to the seed company that supports them sandy No 1 No 21 2019 Kamimpampa Cooperative Good road network and supplies Afriseed company sandy No 1 No 70 2016 # Same recodes in the group-level dataset group[, Group := factor(Group, levels=c( &quot;Mweete Seed Growers Association&quot;, &quot;Tiwine Womens Seed growers Cooperative&quot;, &quot;Mumbwa Seed Growers Association&quot;, &quot;Chiyota Seed Growers Association&quot;, &quot;Kamimpampa Cooperative&quot; ), labels=c( &quot;Mweete&quot;, &quot;Tiwine&quot;, &quot;Mumbwa&quot;, &quot;Chiyota&quot;, &quot;Kamimpampa&quot; ))] # Merge hh[group, on=.(group=Group), `:=`( group_year = `Established`, group_size = `Members`, seasons = `Seasons`, irrigated = `Irrigation`, market_access = `Market access`, ttrade = `Transboundary trade` )] Finally we normalize all farmer cost line items into a “long” table hh_prod_cost for charting. # Normalize production cost table per ha hh_prod_cost &lt;- hh[, .(hhid, Seeds = seed_ha_lcu, Fertilizer = fert_ha_lcu, Pesticides = pest_ha_lcu, Labor = labor_ha_lcu, Transport = tran_ha_lcu, Certification = cert_lcu, Labeling = sales_ha_kg * labl_kg_lcu, Packaging = sales_ha_kg * pckg_kg_lcu, Marketing = mark_kg_lcu )] hh_prod_cost &lt;- melt(hh_prod_cost, id.vars=1, value.name=&quot;lcu&quot;, variable.name=&quot;type&quot;) And we lump all marketing costs into a single category. levels(hh_prod_cost$type) &lt;- levels(hh_prod_cost$type)[c(1,2,3,4,9,9,9,9,9)] hh_prod_cost &lt;- hh_prod_cost[, .( lcu = sum(lcu, na.rm=T) ), by=.(hhid, type) ][, `:=`( # Add cost shares and PPP terms share = lcu/sum(lcu, na.rm=T), ppp = lcu/xrate ), by=.(hhid) ][hh, on=.(hhid), `:=`( # Add classes group = group, gender = gender, age = age, years = years, crop = crop )] Descriptive Statistics Respondent Characteristics Breakdown by categorical variables. Note that farmers in HIMMA grow both crops. ggplot( hh[, .N, by=.(group, age, gender, crop, years)], aes(axis1=crop, axis2=gender, axis3=age, axis4=years, y=N)) + geom_alluvium(aes(fill=group), width=1/4, alpha=.7, color=&quot;white&quot;) + geom_stratum(width=1/4) + geom_text(stat=&quot;stratum&quot;, aes(label=after_stat(stratum)), angle=90, size=2.2) + scale_x_discrete(limits=c(&quot;Crop&quot;, &quot;Gender&quot;, &quot;Age&quot;, &quot;Years in Seed Club&quot;)) + labs(y=NULL, fill=&quot;Seed Club&quot;, title = &quot;Categories of Survey Respondents - Zambia&quot;, subtitle = &quot;Stratified by seed club&quot;) + theme_def(axis.text=element_text(face=&quot;bold&quot;)) Showing contingency table between each pair of categorical variables (seed club group, gender, age age, and years in seed club years). print(ctable(hh$group, hh$gender, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Gender&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Gender Group Male Female Total Mweete 10 ( 71% ) 4 ( 29% ) 14 ( 100% ) Tiwine 11 ( 48% ) 12 ( 52% ) 23 ( 100% ) Mumbwa 11 ( 46% ) 13 ( 54% ) 24 ( 100% ) Chiyota 11 ( 73% ) 4 ( 27% ) 15 ( 100% ) Total 43 ( 57% ) 33 ( 43% ) 76 ( 100% ) &nbsp;&#935;2 = 4.8158&nbsp;&nbsp;&nbsp;df = 3&nbsp;&nbsp;&nbsp;p = .1858 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 print(ctable(hh$group, hh$age, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Age&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Age Group &lt; 30 ≥ 30 Total Mweete 2 ( 14% ) 12 ( 86% ) 14 ( 100% ) Tiwine 3 ( 13% ) 20 ( 87% ) 23 ( 100% ) Mumbwa 0 ( 0% ) 24 ( 100% ) 24 ( 100% ) Chiyota 0 ( 0% ) 15 ( 100% ) 15 ( 100% ) Total 5 ( 7% ) 71 ( 93% ) 76 ( 100% ) &nbsp;&#935;2 = 5.6633&nbsp;&nbsp;&nbsp;df = 3&nbsp;&nbsp;&nbsp;p = .1292 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 print(ctable(hh$group, hh$years, chisq=T, round.digits=0, dnn=c(&quot;Group&quot;, &quot;Years in Seed Club&quot;)), table.classes=&quot;table-condensed&quot;, method=&quot;render&quot;) Years in Seed Club Group &lt; 5 ≥ 5 Total Mweete 14 ( 100% ) 0 ( 0% ) 14 ( 100% ) Tiwine 3 ( 13% ) 20 ( 87% ) 23 ( 100% ) Mumbwa 14 ( 58% ) 10 ( 42% ) 24 ( 100% ) Chiyota 4 ( 27% ) 11 ( 73% ) 15 ( 100% ) Total 35 ( 46% ) 41 ( 54% ) 76 ( 100% ) &nbsp;&#935;2 = 30.2132&nbsp;&nbsp;&nbsp;df = 3&nbsp;&nbsp;&nbsp;p = .0000 Generated by summarytools 1.0.0 (R version 3.6.3)2021-08-05 Seed Production Costs General breakdown and distribution of input costs across seed clubs, gender, years in seed club, and input type. ttt(costs_ha_ppp ~ group | gender+years, data=hh, render=fmt, caption=&quot;Total Input Costs in Absolute Terms (PPP$ / ha) - Zambia&quot;) Total Input Costs in Absolute Terms (PPP$ / ha) - Zambia group Statistic ≥ 5 Male Female Male Female Mweete mean 389 152 NA NA median 296 152 NA NA sd 272 49 NA NA Tiwine mean 164 NA 164 350 median 136 NA 127 123 sd 77 NA 73 518 Mumbwa mean 62 217 674 326 median 52 172 708 243 sd 31 169 227 222 Chiyota mean 263 189 259 273 median 270 189 226 174 sd 225 NA 205 274 Boxplots with mean comparison p-value and significance levels. When more than two levels, each level is compared to the group mean. (ns : p &gt; 0.05, * : p ≤ 0.05, ** : p ≤ 0.01, *** = p ≤ 0.001, **** = p ≤ 0.0001) Note that 1 farmers have total input costs above PPP$ 800/ha. outlier &lt;- hh[costs_ha_ppp &gt; 1000, hhid] kbl(caption=&quot;Outliers&quot;, hh[hhid %in% outlier, .(hhid, code, group, crop, costs_ha_ppp)], format.args=list(big.mark=&quot;,&quot;, digits=0)) Tab. 8: Outliers hhid code group crop costs_ha_ppp ZMB021 FARMER16 Tiwine maize 1,746 ggBoxTest(hh[!hhid %in% outlier], aes(crop, costs_ha_ppp, color=gender, fill=gender), grp.c=aes(group=crop), grp.s=aes(group=gender)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(crop, costs_ha_ppp, color=group, fill=group), grp.c=aes(group=crop), grp.s=aes(group=group)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Total Input Costs (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by crop&quot;) + theme_def(legend.position=&quot;top&quot;) Breakdown across categories of farm input. ttt(ppp ~ type | gender+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Gender (PPP$ / ha) - Zambia&quot;) Input Costs in Absolute Terms by Gender (PPP$ / ha) - Zambia type Statistic bean cowpea groundnut maize soybean Male Female Male Female Male Female Male Female Male Female Seeds mean 65 52 35 36 35 36 26 24 63 74 median 54 0 35 38 18 0 14 18 14 0 sd 49 77 8 10 43 88 33 28 104 128 Fertilizer mean 0 42 74 66 24 0 194 353 48 126 median 0 45 35 54 0 0 141 209 1 111 sd 0 41 98 73 58 0 195 421 78 149 Pesticides mean 9 13 69 28 2 11 30 33 57 46 median 11 9 64 36 0 0 0 30 22 8 sd 8 19 70 25 5 26 84 29 110 79 Labor mean 18 22 54 3 27 24 44 79 89 135 median 0 31 18 0 0 9 0 36 64 54 sd 31 21 77 7 50 31 67 122 97 138 Marketing mean 22 17 60 10 15 53 15 22 36 24 median 29 12 3 4 12 2 13 21 8 18 sd 20 13 139 14 15 123 12 21 54 29 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(gender, crop, type)] ggplot(tbl, aes(gender, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop, nrow=1) + labs(y=&quot;&quot;, x=&quot;&quot;, fill=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Zambia&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;right&quot;) ttt(ppp ~ type | years+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Years in Seed Group (PPP$ / ha) - Zambia&quot;) Input Costs in Absolute Terms by Years in Seed Group (PPP$ / ha) - Zambia type Statistic bean cowpea groundnut maize soybean ≥ 5 ≥ 5 ≥ 5 ≥ 5 ≥ 5 Seeds mean 57 57 36 18 36 35 48 21 79 61 median 54 0 36 18 36 0 36 0 14 0 sd 48 99 8 NA NA 69 21 30 119 112 Fertilizer mean 18 40 75 0 0 13 233 271 24 110 median 0 45 55 0 0 0 179 179 0 89 sd 40 38 89 NA NA 43 176 341 58 130 Pesticides mean 7 18 58 0 11 6 5 37 45 56 median 9 9 54 0 11 0 0 0 16 27 sd 7 24 62 NA NA 19 8 69 84 106 Labor mean 18 25 39 0 0 28 1 71 34 149 median 0 31 0 0 0 0 0 36 28 179 sd 25 23 68 NA NA 41 2 99 35 122 Marketing mean 22 13 45 8 0 37 13 19 8 44 median 29 9 3 8 0 5 19 14 5 29 sd 16 13 117 NA NA 89 10 17 8 51 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(years, crop, type)] ggplot(tbl, aes(years, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop, nrow=1) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Zambia&quot;, subtitle=&quot;Stratified by crop and years in seed club&quot;) + theme_def(legend.position=&quot;right&quot;) ttt(ppp ~ type | group+crop, data=hh_prod_cost, render=fmt, caption=&quot;Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Zambia&quot;) Input Costs in Absolute Terms by Seed Group (PPP$ / ha) - Zambia type Statistic bean cowpea groundnut maize soybean Tiwine Mumbwa Mweete Mumbwa Tiwine Mumbwa Chiyota Tiwine Mumbwa Chiyota Tiwine Mumbwa Chiyota Seeds mean 18 81 38 30 14 36 72 4 46 27 27 149 56 median 0 89 38 31 0 36 36 0 36 18 0 140 0 sd 31 70 7 8 38 NA 101 11 29 34 66 131 120 Fertilizer mean 40 18 88 39 20 0 0 316 278 152 86 101 62 median 45 0 69 0 0 0 0 104 238 89 18 81 89 sd 38 40 91 79 54 NA 0 456 206 203 169 121 60 Pesticides mean 15 9 77 13 0 11 16 21 60 0 22 155 20 median 0 9 64 0 0 11 0 0 17 0 13 121 8 sd 26 6 65 19 0 NA 32 29 95 0 28 165 32 Labor mean 33 13 55 0 31 0 22 100 20 58 165 28 106 median 45 0 27 0 0 0 18 54 4 27 145 27 45 sd 29 18 76 0 49 NA 27 131 27 84 131 32 111 Marketing mean 21 17 64 3 7 0 90 23 16 13 11 26 51 median 27 12 23 3 2 0 25 21 6 14 8 10 29 sd 11 18 138 3 8 NA 144 17 19 8 11 39 59 tbl &lt;- hh_prod_cost[, .( ppp = mean(ppp, na.rm=T) ), keyby=.(group, crop, type)] ggplot(tbl, aes(group, ppp, fill=type)) + geom_bar(stat=&quot;identity&quot;, position=&quot;fill&quot;, alpha=.7, width=.6, color=&quot;white&quot;) + scale_y_continuous(labels=percent) + facet_wrap(~crop, scales=&quot;free_x&quot;, nrow=1) + labs(y=&quot;&quot;, x=&quot;&quot;, title=&quot;Breakdown of Input Costs by Category - Zambia&quot;, subtitle=&quot;Stratified by crop and seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Are there significant differences across groups? We first compare input cost shares across gender, then across seed clubs. ggBoxTest(hh_prod_cost[!type %in% c(&quot;Seeds&quot;)], aes(type, share, color=gender, fill=gender), grp.c=aes(group=type), grp.s=aes(group=gender), jitter=F) + scale_y_continuous(labels=percent) + #facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (Percent of Total Costs by Ha) - Zambia&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;right&quot;) Differences across years in seed club. ggBoxTest(hh_prod_cost[!type %in% c(&quot;Seeds&quot;)], aes(type, share, color=years, fill=years), grp.c=aes(group=type), grp.s=aes(group=years), jitter=F) + scale_y_continuous(labels=percent) + #facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (Percent of Total Costs by Ha) - Zambia&quot;, subtitle=&quot;Stratified by years in seed club&quot;) + theme_def(legend.position=&quot;right&quot;) Differences across seed clubs. ggBoxTest(hh_prod_cost[!type %in% c(&quot;Seeds&quot;)], aes(type, share, color=group, fill=group), grp.c=aes(group=type), grp.s=aes(group=group), jitter=F) + scale_y_continuous(labels=percent) + #facet_wrap(~crop) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Zambia&quot;, subtitle=&quot;Stratified by seed club&quot;) + theme_def(legend.position=&quot;right&quot;) Differences across crops. ggBoxTest(hh_prod_cost[!type %in% c(&quot;Seeds&quot;)], aes(type, share, color=crop, fill=crop), grp.c=aes(group=type), grp.s=aes(group=crop), jitter=F) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Input Costs by Category (PPP$ by Hectare) - Zambia&quot;, subtitle=&quot;Stratified by crop&quot;) + theme_def(legend.position=&quot;top&quot;) Efficiency Differences in productivity measures (expected seed yields and actual sales) across groups. ttt(yield_ha_kg ~ group | gender+crop, data=hh, render=fmt, caption=&quot;Expected Seed Yield (kg / ha) - Zambia&quot;) Expected Seed Yield (kg / ha) - Zambia group Statistic bean cowpea groundnut maize soybean Male Female Male Female Male Female Male Female Male Female Mweete mean NA NA 610 330 NA NA NA NA NA NA median NA NA 500 300 NA NA NA NA NA NA sd NA NA 476 203 NA NA NA NA NA NA Tiwine mean 200 200 NA NA 1,267 262 762 4,567 925 1,090 median 200 200 NA NA 1,400 325 400 2,500 875 750 sd NA 0 NA NA 808 189 829 4,382 254 1,294 Mumbwa mean 654 720 258 467 500 NA 1,552 1,417 925 2,137 median 654 875 200 350 500 NA 1,552 1,000 925 2,137 sd 264 622 193 293 NA NA 2,047 994 106 689 Chiyota mean NA NA NA NA 600 860 1,538 NA 772 310 median NA NA NA NA 600 860 1,825 NA 400 310 sd NA NA NA NA 212 1,047 849 NA 973 198 ttt(sales_ha_kg ~ group | gender+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Zambia&quot;) Realized Seed Sales (kg / ha) - Zambia group Statistic bean cowpea groundnut maize soybean Male Female Male Female Male Female Male Female Male Female Mweete mean NA NA 509 425 NA NA NA NA NA NA median NA NA 500 300 NA NA NA NA NA NA sd NA NA 328 397 NA NA NA NA NA NA Tiwine mean 0 650 NA NA 333 162 288 333 567 670 median 0 650 NA NA 300 200 325 0 350 750 sd NA 495 NA NA 252 111 217 577 375 634 Mumbwa mean 820 578 375 483 1,000 NA 1,605 1,500 1,425 5,325 median 820 750 200 400 1,000 NA 1,605 200 1,425 5,325 sd 28 481 421 236 NA NA 1,973 2,112 813 5,197 Chiyota mean NA NA NA NA 475 460 1,400 NA 680 300 median NA NA NA NA 475 460 1,575 NA 300 300 sd NA NA NA NA 35 481 912 NA 1,026 212 ttt(yield_ha_kg ~ group | years+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Zambia&quot;) Realized Seed Sales (kg / ha) - Zambia group Statistic bean cowpea groundnut maize soybean ≥ 5 ≥ 5 ≥ 5 ≥ 5 ≥ 5 Mweete mean NA NA 530 NA NA NA NA NA NA NA median NA NA 450 NA NA NA NA NA NA NA sd NA NA 429 NA NA NA NA NA NA NA Tiwine mean 200 200 NA NA NA 693 NA 2,393 950 1,036 median 200 200 NA NA NA 400 NA 1,600 950 812 sd NA 0 NA NA NA 724 NA 3,298 354 1,062 Mumbwa mean 858 35 364 250 500 NA 200 1,665 1,325 1,737 median 858 35 300 250 500 NA 200 1,666 1,325 1,737 sd 320 NA 264 NA NA NA NA 1,125 460 1,254 Chiyota mean NA NA NA NA NA 730 2,150 925 190 820 median NA NA NA NA NA 600 2,150 925 190 450 sd NA NA NA NA NA 635 0 813 28 944 ttt(sales_ha_kg ~ group | years+crop, data=hh, render=fmt, caption=&quot;Realized Seed Sales (kg / ha) - Zambia&quot;) Realized Seed Sales (kg / ha) - Zambia group Statistic bean cowpea groundnut maize soybean ≥ 5 ≥ 5 ≥ 5 ≥ 5 ≥ 5 Mweete mean NA NA 485 NA NA NA NA NA NA NA median NA NA 425 NA NA NA NA NA NA NA sd NA NA 335 NA NA NA NA NA NA NA Tiwine mean 0 650 NA NA NA 236 NA 307 350 752 median 0 650 NA NA NA 200 NA 250 350 875 sd NA 495 NA NA NA 189 NA 368 0 543 Mumbwa mean 835 35 367 750 1,000 NA 100 1,768 1,825 4,925 median 820 35 275 750 1,000 NA 100 1,105 1,825 4,925 sd 85 NA 328 NA NA NA NA 1,968 247 5,763 Chiyota mean NA NA NA NA NA 468 2,150 650 75 770 median NA NA NA NA NA 475 2,150 650 75 300 sd NA NA NA NA NA 278 0 495 106 969 Differences in efficiency measures across gender with mean comparison (Wilcoxon) p-value. Note the we take out outlying values. outlier &lt;- c( hh[yield_ha_kg &gt; median(yield_ha_kg) + 3*sd(yield_ha_kg), hhid], hh[sales_ha_ppp &gt; median(sales_ha_ppp) + 3*sd(yield_ha_kg), hhid] ) kbl(caption=&quot;Respondents with yields or sales &gt; median + 3*sd&quot;, hh[hhid %in% outlier, .(hhid, code, group, crop, yield_ha_kg, sales_ha_ppp)], format.args=list(big.mark=&quot;,&quot;)) Tab. 9: Respondents with yields or sales &gt; median + 3*sd hhid code group crop yield_ha_kg sales_ha_ppp ZMB021 FARMER16 Tiwine maize 9,600 0.000 ZMB045 FARMER46 Mumbwa maize 2,333 6,797.853 ZMB049 FARMER45 Mumbwa soybean 2,624 12,880.143 ZMB075 FARMER39 Chiyota soybean 2,500 4,472.272 ggBoxTest(hh[!hhid %in% outlier], aes(crop, yield_ha_kg, color=gender, fill=gender), grp.c=aes(group=crop), grp.s=aes(group=gender)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Expected Seed Yield (kg / ha) - Zambia&quot;, subtitle=&quot;Stratified by crop and gender&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(crop, sales_ha_ppp, color=gender, fill=gender), grp.c=aes(group=crop), grp.s=aes(group=gender)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified by gender&quot;) + theme_def(legend.position=&quot;top&quot;) Differences in efficiency measures by years in seed club with mean comparison (Wilcoxon) p-value. ggBoxTest(hh[!hhid %in% outlier], aes(crop, yield_ha_kg, color=years, fill=years), grp.c=aes(group=crop), grp.s=aes(group=years)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Expected Seed Yield (kg / ha) - Zambia&quot;, subtitle=&quot;Stratified crop and by years in seed club&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(crop, sales_ha_ppp, color=years, fill=years), grp.c=aes(group=crop), grp.s=aes(group=years)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified crop and by years in seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Differences in efficiency measures across seed clubs with global ANOVA p-value. ggBoxTest(hh[!hhid %in% outlier], aes(crop, yield_ha_kg, color=group, fill=group), grp.c=aes(group=crop), grp.s=aes(group=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Expected Seed Yield (Kg / ha) - Zambia&quot;, subtitle=&quot;Stratified by crop and seed club&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(crop, sales_ha_ppp, color=group, fill=group), grp.c=aes(group=crop), grp.s=aes(group=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Total Seed Sales (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Stratified crop by seed club&quot;) + theme_def(legend.position=&quot;top&quot;) Looking at production frontiers (units of output vs. units of input). We expect S-shape curves with farmers at different levels of technical efficiency along the curve. Note that in the approximated curves below we remove outliers with total input costs over PPP$ 1,700 per ha. outlier &lt;- hh[costs_ha_ppp &gt; median(costs_ha_ppp) + 3*sd(costs_ha_ppp), hhid] kbl( caption=&quot;Farmers with total input costs &gt; median + 3*sd&quot;, hh[hhid %in% outlier, .(hhid, group, crop, yield_ha_kg, costs_ha_ppp)], format.args=list(big.mark=&quot;,&quot;, digits=0)) Tab. 10: Farmers with total input costs &gt; median + 3*sd hhid group crop yield_ha_kg costs_ha_ppp ZMB021 Tiwine maize 9,600 1,746 ggplot(hh[!hhid %in% outlier], aes(costs_ha_ppp, yield_ha_kg)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20, color=1) + scale_x_continuous(labels=comma) + scale_y_continuous(labels=comma) + facet_wrap(~crop, scales=&quot;free&quot;, nrow=1) + labs(x=&quot;&quot;, y=&quot;&quot;, title=&quot;Production Frontier (Output vs. Input) - Zambia&quot;, subtitle=&quot;Each point is a respondent. Shade shows 90% CI (kg vs. PPP$ / ha)&quot;) + theme_def(legend.position=&quot;none&quot;) Profitability Farmers’ gross profit margins by crop, gender, and years in seed club. ttt(margin_ha_ppp ~ group+crop | gender+years, data=hh, render=fmt, caption=&quot;Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Zambia&quot;) Mean Gross Profit Margin in Absolute Terms (PPP$ / ha) - Zambia group crop Statistic ≥ 5 Male Female Male Female Mweete cowpea mean 294 418 NA NA median 307 216 NA NA sd 344 532 NA NA Tiwine bean mean -136 NA NA 1,470 median -136 NA NA 1,470 sd NA NA NA 1,805 groundnut mean NA NA 334 233 median NA NA 255 298 sd NA NA 362 170 maize mean NA NA 184 -701 median NA NA 269 -302 sd NA NA 379 914 soybean mean 417 NA 2,034 794 median 417 NA 2,034 792 sd 147 NA NA 1,045 Mumbwa bean mean 443 894 NA 1,664 median 443 894 NA 1,664 sd 196 346 NA NA cowpea mean 328 194 NA 994 median 223 194 NA 994 sd 352 83 NA NA groundnut mean 847 NA NA NA median 847 NA NA NA maize mean NA 3,433 317 1,900 median NA 3,433 317 847 sd NA NA 581 3,098 soybean mean 1,027 2,138 -328 12,321 median 1,027 2,138 -328 12,321 Chiyota groundnut mean NA NA 461 131 median NA NA 461 131 sd NA NA 329 2 maize mean 777 NA 384 NA median 777 NA 384 NA sd 152 NA 633 NA soybean mean -34 52 1,049 631 median -34 52 158 631 sd NA NA 1,856 NA ttt(margin_ha_sh ~ group+crop | gender+years, data=hh, render=fmt_pct, caption=&quot;Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Zambia&quot;) Mean Gross Profit Margin in Relative Terms (% of variable input costs) - Zambia group crop Statistic ≥ 5 Male Female Male Female Mweete cowpea mean 97% 285% NA NA median 91% 125% NA NA sd 126% 378% NA NA Tiwine bean mean -100% NA NA 1 256% median -100% NA NA 1 256% sd NA NA NA 1 564% groundnut mean NA NA 260% 7 546% median NA NA 211% 7 193% sd NA NA 276% 8 534% maize mean NA NA 191% -82% median NA NA 220% -100% sd NA NA 267% 31% soybean mean 310% NA 1 805% 132% median 310% NA 1 805% 212% sd 262% NA NA 204% Mumbwa bean mean 428% 989% NA 777% median 428% 989% NA 777% sd 7% 939% NA NA cowpea mean 614% 128% NA 3 831% median 461% 128% NA 3 831% sd 596% 59% NA NA groundnut mean 1 801% NA NA NA median 1 801% NA NA NA maize mean NA 2 369% 30% 536% median NA 2 369% 30% 360% sd NA NA 74% 709% soybean mean 2 208% 412% -46% 2 203% median 2 208% 412% -46% 2 203% Chiyota groundnut mean NA NA 595% 113% median NA NA 595% 113% sd NA NA 40% 128% maize mean 233% NA 647% NA median 233% NA 647% NA sd 134% NA 964% NA soybean mean -100% 28% 179% 363% median -100% 28% 53% 363% sd NA NA 280% NA Note that 14 respondents show negative margins. kbl(caption=&quot;Respondents with negative gross margins.&quot;, hh[margin_ha_ppp &lt; 0, .(hhid, code, group, crop, costs_ha_ppp, yield_ha_kg, sales_ha_kg, margin_ha_ppp)], format.args=list(big.mark=&quot;,&quot;, digits=1)) Tab. 11: Respondents with negative gross margins. hhid code group crop costs_ha_ppp yield_ha_kg sales_ha_kg margin_ha_ppp ZMB011 FARMER9 Mweete cowpea 655 588 294 -261 ZMB012 FARMER10 Mweete cowpea 165 50 0 -165 ZMB017 FARMER17 Tiwine groundnut 18 0 0 -18 ZMB021 FARMER16 Tiwine maize 1,746 9,600 0 -1,746 ZMB022 FARMER17 Tiwine maize 660 1,600 1,000 -302 ZMB023 FARMER27 Tiwine maize 54 2,500 0 -54 ZMB025 FARMER17 Tiwine soybean 250 0 0 -250 ZMB027 FARMER19 Tiwine bean 136 200 0 -136 ZMB031 FARMER15 Tiwine maize 304 250 0 -304 ZMB047 FARMER48 Mumbwa maize 639 1,000 200 -467 ZMB059 FARMER51 Mumbwa maize 432 105 210 -94 ZMB061 FARMER52 Mumbwa soybean 708 850 850 -328 ZMB068 FARMER29 Chiyota maize 182 350 300 -64 ZMB076 FARMER41 Chiyota soybean 34 210 0 -34 outlier &lt;- c( hh[margin_ha_ppp &gt; median(margin_ha_ppp) + 3*sd(margin_ha_ppp), hhid], hh[margin_ha_sh &gt; median(margin_ha_sh) + 3*sd(margin_ha_sh), hhid] ) kbl(caption=&quot;Respondents with gross margins &gt; median + 3*sd&quot;, hh[hhid %in% outlier, .(hhid, code, group, crop, costs_ha_ppp, yield_ha_kg, sales_ha_kg, margin_ha_ppp, margin_ha_sh)], format.args=list(big.mark=&quot;,&quot;, digits=1)) Tab. 11: Respondents with gross margins &gt; median + 3*sd hhid code group crop costs_ha_ppp yield_ha_kg sales_ha_kg margin_ha_ppp margin_ha_sh ZMB018 FARMER21 Tiwine groundnut 2 400 250 311 139 ZMB020 FARMER28 Tiwine groundnut 2 400 200 284 159 ZMB045 FARMER46 Mumbwa maize 426 2,333 5,000 6,372 15 ZMB049 FARMER45 Mumbwa soybean 559 2,624 9,000 12,321 22 ggplot(hh, aes(x=hhid, color=group)) + geom_hline(aes(yintercept=0), color=1) + geom_linerange(aes(ymin=0, ymax=margin_ha_ppp), size=.6) + geom_point(aes(y=0), shape=20, size=1.4) + geom_point(aes(y=margin_ha_ppp, shape=margin_ha_ppp &lt; 0, fill=group), size=1.4) + scale_y_continuous(labels=comma) + scale_shape_manual(values=24:25) + guides(x=&quot;none&quot;, shape=&quot;none&quot;) + labs(x=NULL, y=NULL, color=&quot;&quot;, fill=&quot;&quot;, title=&quot;Profit Margin (PPP$ / ha) - Zambia&quot;, subtitle=&quot;Each bar is a respondent&#39;s gross profit margin&quot;) + theme_def( legend.position=&quot;right&quot;, panel.grid.major.x=element_blank() ) Farmers’ gross profit margins by gender and across groups in both absolute and relative terms (as percentage of total costs per hectare). ggBoxTest(hh[!hhid %in% outlier], aes(crop, margin_ha_ppp, color=gender, fill=gender), grp.c=aes(group=crop), grp.s=aes(group=gender)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Zambia&quot;, subtitle=&quot;Stratified by crop and gender (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(crop, margin_ha_sh, color=gender, fill=gender), grp.c=aes(group=crop), grp.s=aes(group=gender)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Zambia&quot;, subtitle=&quot;Stratified by crop and gender (% of total costs)&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(crop, margin_ha_ppp, color=years, fill=years), grp.c=aes(group=crop), grp.s=aes(group=years)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Zambia&quot;, subtitle=&quot;Stratified by crop and years in seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(crop, margin_ha_sh, color=years, fill=years), grp.c=aes(group=crop), grp.s=aes(group=years)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, fill=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Zambia&quot;, subtitle=&quot;Stratified by crop and years in seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(crop, margin_ha_ppp, color=group, fill=group), grp.c=aes(group=crop), grp.s=aes(group=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, color=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms - Zambia&quot;, subtitle=&quot;Stratified by crop and seed club (PPP$ / ha)&quot;) + theme_def(legend.position=&quot;top&quot;) ggBoxTest(hh[!hhid %in% outlier], aes(crop, margin_ha_sh, color=group, fill=group), grp.c=aes(group=crop), grp.s=aes(group=group)) + scale_x_discrete(labels=label_wrap(5)) + scale_y_continuous(labels=percent) + labs(x=&quot;&quot;, y=&quot;&quot;, color=&quot;&quot;, fill=&quot;&quot;, title=&quot;Gross Profit Margin in Relative Terms - Zambia&quot;, subtitle=&quot;Stratified by crop and seed club (% of total costs)&quot;) + theme_def(legend.position=&quot;top&quot;) ggplot(hh[!hhid %in% outlier], aes(member_years, margin_ha_ppp)) + geom_smooth(size=.8) + geom_point(alpha=.7, shape=20) + scale_y_continuous(labels=comma) + labs(x=&quot;&quot;, y=&quot;&quot;, color=&quot;&quot;, title=&quot;Gross Profit Margin in Absolute Terms vs. Years in Seed Club - Zambia&quot;, subtitle=&quot;Each point is a respondent (years vs. PPP$)&quot;) + theme_def(legend.position=&quot;top&quot;) Correlation Significant pairwise associations. ggpairs( hh[, .(`seed club`=group, `years in club`=member_years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:4], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:4], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:4], alpha=.8)), title=&quot;Correlogram stratified by seed club - Zambia&quot; ) + theme_def( strip.text=element_text(hjust=.5), axis.text.x=element_text(angle=-45), panel.grid.major=element_blank() ) ggpairs( hh[, .(gender, `years in club`=member_years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by gender - Zambia&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) ggpairs( hh[, .(`years in club`=years, `costs PPP$`=costs_ha_ppp, `seed yield kg/ha`=yield_ha_kg, `margin PPP$`=margin_ha_ppp, `margin %`=margin_ha_sh)], upper = list( continuous=&quot;cor&quot;, combo=wrap(&quot;summarise_by&quot;, color=pal[1:2], size=2)), lower = list( continuous=wrap(&quot;smooth&quot;, shape=NA, color=hh[, pal[gender]]), combo=wrap(&quot;box_no_facet&quot;, fill=pal[1:2], alpha=.8)), diag = list( continuous=wrap(&quot;densityDiag&quot;, fill=NA), discrete=wrap(&quot;barDiag&quot;, fill=pal[1:2], alpha=.8)), title=&quot;Correlogram stratified by years in seed club - Zambia&quot; ) + theme_def( strip.text=element_text(hjust=.5), panel.grid.major=element_blank() ) saveRDS(hh, &quot;../tmp/data_zmb.rds&quot;) # Combine all country datasets gtm &lt;- readRDS(&quot;../tmp/data_gtm.rds&quot;) nre &lt;- readRDS(&quot;../tmp/data_nre.rds&quot;) vnm &lt;- readRDS(&quot;../tmp/data_vnm.rds&quot;) zmb &lt;- readRDS(&quot;../tmp/data_zmb.rds&quot;) vars &lt;- lbl$code hh &lt;- rbindlist(list( gtm[, .SD, .SDcols=names(gtm) %in% vars], nre[, .SD, .SDcols=names(nre) %in% vars], vnm[, .SD, .SDcols=names(vnm) %in% vars], zmb[, .SD, .SDcols=names(zmb) %in% vars] ), fill=T) setcolorder(hh, lbl[code %in% names(hh), unique(code)]) fwrite(hh, &quot;../data/hh.csv&quot;) "]]
